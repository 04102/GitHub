###############################################################################
#                                                                             #
# IAR ANSI C/C++ Compiler V6.10.2.52244/W32 for ARM     19/Nov/2015  13:16:37 #
# Copyright 1999-2010 IAR Systems AB.                                         #
#                                                                             #
#    Cpu mode     =  arm                                                      #
#    Endian       =  little                                                   #
#    Source file  =  C:\DUII\TargetHW\GUI\TREEVIEW.c                          #
#    Command line =  C:\DUII\TargetHW\GUI\TREEVIEW.c -D DEBUG=1 -D            #
#                    SDRAM_TARGET=1 -D USB_IS_HIGH_SPEED -D NOPROFILER -D     #
#                    OS_TRACE=0 -D OS_VIEW_ENABLE=0 -lCN                      #
#                    C:\DUII\TargetHW\Release\List\ -o                        #
#                    C:\DUII\TargetHW\Release\Obj\ --endian=little            #
#                    --cpu=ARM926EJ-S -e --fpu=None --dlib_config             #
#                    "C:\Program Files (x86)\IAR Systems\Embedded Workbench   #
#                    6.0\arm\INC\c\DLib_Config_Normal.h" -I                   #
#                    C:\DUII\TargetHW\Application\SEGGERDEMO\ -I              #
#                    C:\DUII\TargetHW\Application\SEGGERDEMO\Src\ -I          #
#                    C:\DUII\TargetHW\Config\ -I C:\DUII\TargetHW\FS\ -I      #
#                    C:\DUII\TargetHW\GUI\ -I C:\DUII\TargetHW\Inc\ -I        #
#                    C:\DUII\TargetHW\OS\ -I C:\DUII\TargetHW\Setup\ -I       #
#                    \DUII\DUII\ -I \DUII\DUII\Graphics\ --cpu_mode arm -Ohs  #
#                    --use_c++_inline --require_prototypes                    #
#    List file    =  C:\DUII\TargetHW\Release\List\TREEVIEW.lst               #
#    Object file  =  C:\DUII\TargetHW\Release\Obj\TREEVIEW.o                  #
#                                                                             #
#                                                                             #
###############################################################################

C:\DUII\TargetHW\GUI\TREEVIEW.c
      1          /*********************************************************************
      2          *                SEGGER Microcontroller GmbH & Co. KG                *
      3          *        Solutions for real time microcontroller applications        *
      4          **********************************************************************
      5          *                                                                    *
      6          *        (c) 1996 - 2010  SEGGER Microcontroller GmbH & Co. KG       *
      7          *                                                                    *
      8          *        Internet: www.segger.com    Support:  support@segger.com    *
      9          *                                                                    *
     10          **********************************************************************
     11          
     12          ** emWin V5.06 - Graphical user interface for embedded applications **
     13          emWin is protected by international copyright laws.   Knowledge of the
     14          source code may not be used to write a similar product.  This file may
     15          only be used in accordance with a license and should not be re-
     16          distributed in any way. We appreciate your understanding and fairness.
     17          ----------------------------------------------------------------------
     18          File        : TREEVIEW.c
     19          Purpose     : Implementation of treeview widget
     20          ---------------------------END-OF-HEADER------------------------------
     21          */
     22          
     23          #include <stdlib.h>
     24          #include <string.h>
     25          #include "TREEVIEW_Private.h"
     26          
     27          #if GUI_WINSUPPORT
     28          
     29          /*********************************************************************
     30          *
     31          *       Private config defaults
     32          *
     33          **********************************************************************
     34          */
     35          /* Define default fonts */
     36          #ifndef   TREEVIEW_FONT_DEFAULT
     37            #if   WIDGET_USE_SCHEME_SMALL
     38              #define TREEVIEW_FONT_DEFAULT &GUI_Font13_1
     39            #elif WIDGET_USE_SCHEME_MEDIUM
     40              #define TREEVIEW_FONT_DEFAULT &GUI_Font16_1
     41            #elif WIDGET_USE_SCHEME_LARGE
     42              #define TREEVIEW_FONT_DEFAULT &GUI_Font24_1
     43            #endif
     44          #endif
     45          
     46          /* Define colors */
     47          #ifndef   TREEVIEW_BKCOLOR0_DEFAULT
     48            #define TREEVIEW_BKCOLOR0_DEFAULT GUI_WHITE               /* Not selected */
     49          #endif
     50          
     51          #ifndef   TREEVIEW_BKCOLOR1_DEFAULT
     52            #define TREEVIEW_BKCOLOR1_DEFAULT GUI_BLUE                /* Selected */
     53          #endif
     54          
     55          #ifndef   TREEVIEW_BKCOLOR2_DEFAULT
     56            #define TREEVIEW_BKCOLOR2_DEFAULT 0xC0C0C0                /* Disabled */
     57          #endif
     58          
     59          #ifndef   TREEVIEW_TEXTCOLOR0_DEFAULT
     60            #define TREEVIEW_TEXTCOLOR0_DEFAULT GUI_BLACK             /* Not selected */
     61          #endif
     62          
     63          #ifndef   TREEVIEW_TEXTCOLOR1_DEFAULT
     64            #define TREEVIEW_TEXTCOLOR1_DEFAULT GUI_WHITE             /* Selected */
     65          #endif
     66          
     67          #ifndef   TREEVIEW_TEXTCOLOR2_DEFAULT
     68            #define TREEVIEW_TEXTCOLOR2_DEFAULT GUI_GRAY              /* Disabled */
     69          #endif
     70          
     71          #ifndef   TREEVIEW_LINECOLOR0_DEFAULT
     72            #define TREEVIEW_LINECOLOR0_DEFAULT GUI_BLACK             /* Not selected */
     73          #endif
     74          
     75          #ifndef   TREEVIEW_LINECOLOR1_DEFAULT
     76            #define TREEVIEW_LINECOLOR1_DEFAULT GUI_WHITE             /* Selected */
     77          #endif
     78          
     79          #ifndef   TREEVIEW_LINECOLOR2_DEFAULT
     80            #define TREEVIEW_LINECOLOR2_DEFAULT GUI_GRAY              /* Disabled */
     81          #endif
     82          
     83          #ifndef   TREEVIEW_FOCUSCOLOR_DEFAULT
     84            #define TREEVIEW_FOCUSCOLOR_DEFAULT GUI_WHITE             /* Focus rectangle */
     85          #endif
     86          
     87          /* Define default images */
     88          #ifndef   TREEVIEW_IMAGE_PLUS_DEFAULT
     89            #define TREEVIEW_IMAGE_PLUS_DEFAULT &TREEVIEW__bmPlus     /* Plus sign */
     90          #endif
     91          
     92          #ifndef   TREEVIEW_IMAGE_MINUS_DEFAULT
     93            #define TREEVIEW_IMAGE_MINUS_DEFAULT &TREEVIEW__bmMinus   /* Minus sign */
     94          #endif
     95          
     96          #ifndef   TREEVIEW_IMAGE_CLOSED_DEFAULT
     97            #define TREEVIEW_IMAGE_CLOSED_DEFAULT &TREEVIEW__bmClosed /* Closed image */
     98          #endif
     99          
    100          #ifndef   TREEVIEW_IMAGE_OPEN_DEFAULT
    101            #define TREEVIEW_IMAGE_OPEN_DEFAULT &TREEVIEW__bmOpen     /* Open image */
    102          #endif
    103          
    104          #ifndef   TREEVIEW_IMAGE_LEAF_DEFAULT
    105            #define TREEVIEW_IMAGE_LEAF_DEFAULT &TREEVIEW__bmLeaf     /* Leaf image */
    106          #endif
    107          
    108          #ifndef   TREEVIEW_INDENT_DEFAULT
    109            #define TREEVIEW_INDENT_DEFAULT 16                        /* Item indent value */
    110          #endif
    111          
    112          #ifndef   TREEVIEW_TEXT_INDENT_DEFAULT
    113            #define TREEVIEW_TEXT_INDENT_DEFAULT 20                   /* Text indent value */
    114          #endif
    115          
    116          #ifndef   TREEVIEW_MIN_ITEM_HEIGHT_DEFAULT
    117            #define TREEVIEW_MIN_ITEM_HEIGHT_DEFAULT 16               /* Minimum item height */
    118          #endif
    119          
    120          /*********************************************************************
    121          *
    122          *       Static data
    123          *
    124          **********************************************************************
    125          */

   \                                 In section .data, align 4
    126          TREEVIEW_PROPS TREEVIEW__DefaultProps = {
   \                     TREEVIEW__DefaultProps:
   \   00000000   ........FFFF       DC32 GUI_Font13_1, 16777215, 16711680, 12632256, 0, 16777215, 8421504
   \              FF000000FF00
   \              C0C0C0000000
   \              0000FFFFFF00
   \              80808000    
   \   0000001C   00000000FFFF       DC32 0, 16777215, 8421504, 16777215, TREEVIEW__bmClosed
   \              FF0080808000
   \              FFFFFF00....
   \              ....        
   \   00000030   ............       DC32 TREEVIEW__bmOpen, TREEVIEW__bmLeaf, TREEVIEW__bmPlus
   \              ............
   \   0000003C   ........1000       DC32 TREEVIEW__bmMinus, 16, 20, 16
   \              000014000000
   \              10000000    
    127            TREEVIEW_FONT_DEFAULT,
    128            {
    129              TREEVIEW_BKCOLOR0_DEFAULT,
    130              TREEVIEW_BKCOLOR1_DEFAULT,
    131              TREEVIEW_BKCOLOR2_DEFAULT,
    132            },
    133            {
    134              TREEVIEW_TEXTCOLOR0_DEFAULT,
    135              TREEVIEW_TEXTCOLOR1_DEFAULT,
    136              TREEVIEW_TEXTCOLOR2_DEFAULT,
    137            },
    138            {
    139              TREEVIEW_LINECOLOR0_DEFAULT,
    140              TREEVIEW_LINECOLOR1_DEFAULT,
    141              TREEVIEW_LINECOLOR2_DEFAULT,
    142            },
    143            TREEVIEW_FOCUSCOLOR_DEFAULT,
    144            {
    145              TREEVIEW_IMAGE_CLOSED_DEFAULT,
    146              TREEVIEW_IMAGE_OPEN_DEFAULT,
    147              TREEVIEW_IMAGE_LEAF_DEFAULT,
    148              TREEVIEW_IMAGE_PLUS_DEFAULT,
    149              TREEVIEW_IMAGE_MINUS_DEFAULT,
    150            },
    151            TREEVIEW_INDENT_DEFAULT,
    152            TREEVIEW_TEXT_INDENT_DEFAULT,
    153            TREEVIEW_MIN_ITEM_HEIGHT_DEFAULT,
    154          };
    155          
    156          /*********************************************************************
    157          *
    158          *       Static routines
    159          *
    160          **********************************************************************
    161          */
    162          /*********************************************************************
    163          *
    164          *       Private routines
    165          *
    166          **********************************************************************
    167          */
    168          /*********************************************************************
    169          *
    170          *       TREEVIEW_LockH
    171          */
    172          #if GUI_DEBUG_LEVEL >= GUI_DEBUG_LEVEL_CHECK_ALL
    173          TREEVIEW_OBJ * TREEVIEW_LockH(TREEVIEW_Handle h) {
    174            TREEVIEW_OBJ * p = (TREEVIEW_OBJ *)GUI_LOCK_H(h);
    175            if (p) {
    176              if (p->DebugId != TREEVIEW_ID) {
    177                GUI_DEBUG_ERROROUT("TREEVIEW.c: Wrong handle type or Object not init'ed");
    178                return 0;
    179              }
    180            }
    181            return p;
    182          }
    183          #endif
    184          
    185          /*********************************************************************
    186          *
    187          *       _GetBitmapPointer
    188          */
    189          static const GUI_BITMAP GUI_UNI_PTR ** _GetBitmapPointer(const TREEVIEW_OBJ * pObj, TREEVIEW_ITEM_OBJ * pItem) {
    190            const GUI_BITMAP GUI_UNI_PTR ** apBm;
    191            if (pItem->hData) {
    192              TREEVIEW_ITEM_DATA * pItemData;
    193              pItemData = (TREEVIEW_ITEM_DATA *)GUI_LOCK_H(pItem->hData);
    194              apBm       = pItemData->apBm;
    195              GUI_UNLOCK_H(pItemData);
    196            } else {
    197              apBm       = (const GUI_BITMAP GUI_UNI_PTR **)&pObj->Props.apBm;
    198            }
    199            return apBm;
    200          }
    201          
    202          /*********************************************************************
    203          *
    204          *       _GetBitmap
    205          */
    206          static const GUI_BITMAP GUI_UNI_PTR * _GetBitmap(const TREEVIEW_OBJ * pObj, const GUI_BITMAP GUI_UNI_PTR ** ppBm, int Index) {
    207            const GUI_BITMAP GUI_UNI_PTR * pBm;
    208            if ((Index == TREEVIEW_BI_PLUS) || (Index == TREEVIEW_BI_MINUS)  || (*(ppBm + Index) == NULL)) {
    209              pBm = (const GUI_BITMAP GUI_UNI_PTR *)pObj->Props.apBm[Index];
    210            } else {
    211              pBm = *(ppBm + Index);
    212            }
    213            return pBm;
    214          }
    215          
    216          /*********************************************************************
    217          *
    218          *       _GetItemBitmapSizeY
    219          */
    220          static int _GetItemBitmapSizeY(const TREEVIEW_OBJ * pObj, TREEVIEW_ITEM_OBJ * pItem) {
    221            int BitmapSizeItem;
    222            int BitmapSizeButton;
    223            const GUI_BITMAP GUI_UNI_PTR ** apBm;
    224            const GUI_BITMAP GUI_UNI_PTR  *  pBm;
    225            apBm = _GetBitmapPointer(pObj, pItem);
    226            if (pItem->Flags & TREEVIEW_ITEM_TYPE_NODE) {
    227              int IndexItem;
    228              BitmapSizeItem = 0;
    229              if (pItem->Flags & TREEVIEW_ITEM_STATE_EXPANDED) {
    230                IndexItem   = TREEVIEW_BI_OPEN;
    231              } else {
    232                IndexItem   = TREEVIEW_BI_CLOSED;
    233              }
    234              pBm = _GetBitmap(pObj, apBm, IndexItem);
    235              BitmapSizeButton = pBm->YSize;
    236            } else {
    237              BitmapSizeButton = 0;
    238              pBm = _GetBitmap(pObj, apBm, TREEVIEW_BI_LEAF);
    239              BitmapSizeItem = pBm->YSize;
    240            }
    241            return (BitmapSizeButton > BitmapSizeItem) ? BitmapSizeButton : BitmapSizeItem;
    242          }
    243          
    244          /*********************************************************************
    245          *
    246          *       _CallOwnerDraw
    247          */
    248          static int _CallOwnerDraw(TREEVIEW_Handle hObj, WIDGET_DRAW_ITEM_FUNC * pfDrawItem, TREEVIEW_ITEM_Handle hItem, int Cmd) {
    249            WIDGET_ITEM_DRAW_INFO ItemInfo;
    250            int r = 0;
    251            if (pfDrawItem) {
    252              ItemInfo.Cmd       = Cmd;
    253              ItemInfo.hWin      = hObj;
    254              ItemInfo.p         = (void *)&hItem;
    255              r = pfDrawItem(&ItemInfo);
    256            }
    257            return r;
    258          }
    259          /*
    260          static int _CallOwnerDraw(TREEVIEW_Handle hObj, const TREEVIEW_OBJ * pObj, TREEVIEW_ITEM_Handle hItem, int Cmd) {
    261            WIDGET_ITEM_DRAW_INFO ItemInfo;
    262            int r;
    263            ItemInfo.Cmd       = Cmd;
    264            ItemInfo.hWin      = hObj;
    265            ItemInfo.p         = (void *)&hItem;
    266            if (pObj->pfDrawItem) {
    267              r = pObj->pfDrawItem(&ItemInfo);
    268            }
    269            return r;
    270          }
    271          */
    272          
    273          /*********************************************************************
    274          *
    275          *       _SkipClosedItems
    276          *
    277          * Purpose:
    278          *   Returns the next visible item
    279          */
    280          static TREEVIEW_ITEM_Handle _SkipClosedItems(TREEVIEW_ITEM_Handle hItem) {
    281            TREEVIEW_ITEM_OBJ * pItem;
    282          
    283            pItem = (TREEVIEW_ITEM_OBJ *)GUI_LOCK_H(hItem);
    284            if (pItem->Flags & TREEVIEW_ITEM_TYPE_NODE) {
    285              if ((pItem->Flags & TREEVIEW_ITEM_STATE_EXPANDED) == 0) {
    286                int Level;
    287                Level = pItem->Level;
    288                do {
    289                  hItem = pItem->hNext;
    290                  if (hItem) {
    291                    GUI_UNLOCK_H(pItem);
    292                    pItem = (TREEVIEW_ITEM_OBJ *)GUI_LOCK_H(hItem);
    293                    if (pItem->Level <= Level) {
    294                      break;
    295                    }
    296                  }
    297                } while (hItem);
    298              } else {
    299                hItem = pItem->hNext;
    300              }
    301            } else {
    302              hItem = pItem->hNext;
    303            }
    304            GUI_UNLOCK_H(pItem);
    305            return hItem;
    306          }
    307          
    308          /*********************************************************************
    309          *
    310          *       _ConnectLines
    311          *
    312          * Purpose:
    313          *   Makes a 'connection' between the given item and the previous
    314          *   item of the same level.
    315          */
    316          static void _ConnectLines(TREEVIEW_ITEM_Handle hItem, TREEVIEW_ITEM_Handle ahIndent[], int OldLevel, int Level) {
    317            TREEVIEW_ITEM_OBJ * pItem;
    318            TREEVIEW_ITEM_OBJ * pIndent;
    319            U16 Mask;
    320            pItem = (TREEVIEW_ITEM_OBJ *)GUI_LOCK_H(hItem);
    321            do {
    322              pIndent = (TREEVIEW_ITEM_OBJ *)GUI_LOCK_H(ahIndent[OldLevel]);
    323              if (pIndent) {
    324                pIndent->Flags |= TREEVIEW_ITEM_STATE_ISLAST;
    325              }
    326              GUI_UNLOCK_H(pIndent);
    327            } while (--OldLevel > Level);
    328            Level = pItem->Level;
    329            Mask  = 1 << (Level - 1);
    330            while ((hItem = pItem->hPrev) != 0) {
    331              GUI_UNLOCK_H(pItem);
    332              pItem = (TREEVIEW_ITEM_OBJ *)GUI_LOCK_H(hItem);
    333              if (pItem->Level > Level) {
    334                pItem->Connectors |= Mask;
    335              } else {
    336                break;
    337              }
    338            }
    339            GUI_UNLOCK_H(pItem);
    340          }
    341          
    342          /*********************************************************************
    343          *
    344          *       _CalcParams
    345          *
    346          * Purpose:
    347          *   Calculates the following things:
    348          *   1. Number of visible items
    349          *   2. Maximum size of visible items in x
    350          *   3. Required size in y for all visible items
    351          *   4. Connectors between items
    352          */

   \                                 In section .text, align 4, keep-with-next
    353          static void _CalcParams(TREEVIEW_Handle hObj) {
   \                     _CalcParams:
   \   00000000   F04F2DE9           PUSH     {R4-R11,LR}
   \   00000004   6CD04DE2           SUB      SP,SP,#+108
   \   00000008   0040A0E1           MOV      R4,R0
    354            TREEVIEW_OBJ * pObj;
    355            TREEVIEW_ITEM_Handle hItem;
    356            TREEVIEW_ITEM_Handle hItemOld;
    357            TREEVIEW_ITEM_OBJ  * pItem;
    358            TREEVIEW_ITEM_Handle ahIndent[16] = {0};
   \   0000000C   28008DE2           ADD      R0,SP,#+40
   \   00000010   0010A0E3           MOV      R1,#+0
   \   00000014   0020A0E3           MOV      R2,#+0
   \   00000018   0030A0E3           MOV      R3,#+0
   \   0000001C   00C0A0E3           MOV      R12,#+0
   \   00000020   0E10A0E8           STM      R0!,{R1-R3,R12}
   \   00000024   0E10A0E8           STM      R0!,{R1-R3,R12}
   \   00000028   0E10A0E8           STM      R0!,{R1-R3,R12}
   \   0000002C   0E10A0E8           STM      R0!,{R1-R3,R12}
    359            int Level, OldLevel, ySizeItem;
    360            WIDGET_DRAW_ITEM_FUNC * pfDrawItem;
    361          
    362            pObj = TREEVIEW_LOCK_H(hObj);
   \   00000030   0400A0E1           MOV      R0,R4
   \   00000034   ........           BL       GUI_ALLOC_LockH
   \   00000038   00A0A0E1           MOV      R10,R0
    363            pfDrawItem = pObj->pfDrawItem;
   \   0000003C   34509AE5           LDR      R5,[R10, #+52]
    364            pObj->xSizeItems  = 0;
   \   00000040   0060A0E3           MOV      R6,#+0
   \   00000044   B8608AE5           STR      R6,[R10, #+184]
    365            pObj->ySizeItems  = 0;
   \   00000048   BC608AE5           STR      R6,[R10, #+188]
    366            pObj->NumVisItems = 0;
   \   0000004C   B4608AE5           STR      R6,[R10, #+180]
    367            OldLevel = Level = -1;
    368            hItemOld = 0;
    369            hItem = pObj->hFirst;
   \   00000050   A0709AE5           LDR      R7,[R10, #+160]
   \   00000054   0690E0E1           MVN      R9,R6
    370            while (hItem) {
   \   00000058   000057E3           CMP      R7,#+0
   \   0000005C   8600000A           BEQ      ??_CalcParams_0
    371              hItemOld = hItem;
   \                     ??_CalcParams_1:
   \   00000060   00708DE5           STR      R7,[SP, #+0]
    372              pItem = (TREEVIEW_ITEM_OBJ *)GUI_LOCK_H(hItem);
   \   00000064   0700A0E1           MOV      R0,R7
   \   00000068   ........           BL       GUI_ALLOC_LockH
    373              pItem->Connectors = 0;
   \   0000006C   BA61C0E1           STRH     R6,[R0, #+26]
    374              Level = pItem->Level;
   \   00000070   1C80D0E5           LDRB     R8,[R0, #+28]
    375              ahIndent[Level] = hItem;
   \   00000074   28108DE2           ADD      R1,SP,#+40
   \   00000078   087181E7           STR      R7,[R1, +R8, LSL #+2]
    376              pItem->Flags &= ~TREEVIEW_ITEM_STATE_ISLAST;
   \   0000007C   B811D0E1           LDRH     R1,[R0, #+24]
   \   00000080   0410C1E3           BIC      R1,R1,#0x4
   \   00000084   B811C0E1           STRH     R1,[R0, #+24]
   \   00000088   B401D0E1           LDRH     R0,[R0, #+20]
   \   0000008C   B8109AE5           LDR      R1,[R10, #+184]
   \   00000090   000051E1           CMP      R1,R0
    377              if (pObj->xSizeItems < pItem->xSize) {
    378                pObj->xSizeItems = pItem->xSize;
   \   00000094   B8008AB5           STRLT    R0,[R10, #+184]
    379              }
    380              GUI_UNLOCK_H(pItem);
   \   00000098   ........           BL       GUI_ALLOC_UnlockH
    381              if (Level < OldLevel) {
   \   0000009C   090058E1           CMP      R8,R9
   \   000000A0   230000AA           BGE      ??_CalcParams_2
    382                _ConnectLines(hItem, ahIndent, OldLevel, Level);
   \   000000A4   0700A0E1           MOV      R0,R7
   \   000000A8   ........           BL       GUI_ALLOC_LockH
   \   000000AC   00A0A0E1           MOV      R10,R0
   \   000000B0   28008DE2           ADD      R0,SP,#+40
   \   000000B4   09B180E0           ADD      R11,R0,R9, LSL #+2
   \                     ??_CalcParams_3:
   \   000000B8   00009BE5           LDR      R0,[R11, #+0]
   \   000000BC   ........           BL       GUI_ALLOC_LockH
   \   000000C0   000050E3           CMP      R0,#+0
   \   000000C4   B811D011           LDRHNE   R1,[R0, #+24]
   \   000000C8   04108113           ORRNE    R1,R1,#0x4
   \   000000CC   B811C011           STRHNE   R1,[R0, #+24]
   \   000000D0   ........           BL       GUI_ALLOC_UnlockH
   \   000000D4   019049E2           SUB      R9,R9,#+1
   \   000000D8   04B04BE2           SUB      R11,R11,#+4
   \   000000DC   090058E1           CMP      R8,R9
   \   000000E0   F4FFFFBA           BLT      ??_CalcParams_3
   \   000000E4   1C90DAE5           LDRB     R9,[R10, #+28]
   \   000000E8   0100A0E3           MOV      R0,#+1
   \   000000EC   011049E2           SUB      R1,R9,#+1
   \   000000F0   10B1A0E1           LSL      R11,R0,R1
   \   000000F4   0BB8A0E1           LSL      R11,R11,#+16
   \   000000F8   020000EA           B        ??_CalcParams_4
   \                     ??_CalcParams_5:
   \   000000FC   BA01DAE1           LDRH     R0,[R10, #+26]
   \   00000100   2B0880E1           ORR      R0,R0,R11, LSR #+16
   \   00000104   BA01CAE1           STRH     R0,[R10, #+26]
   \                     ??_CalcParams_4:
   \   00000108   08A09AE5           LDR      R10,[R10, #+8]
   \   0000010C   00005AE3           CMP      R10,#+0
   \   00000110   0600000A           BEQ      ??_CalcParams_6
   \   00000114   ........           BL       GUI_ALLOC_UnlockH
   \   00000118   0A00A0E1           MOV      R0,R10
   \   0000011C   ........           BL       GUI_ALLOC_LockH
   \   00000120   00A0A0E1           MOV      R10,R0
   \   00000124   1C00DAE5           LDRB     R0,[R10, #+28]
   \   00000128   000059E1           CMP      R9,R0
   \   0000012C   F2FFFFBA           BLT      ??_CalcParams_5
   \                     ??_CalcParams_6:
   \   00000130   ........           BL       GUI_ALLOC_UnlockH
    383              }
    384              GUI_UNLOCK_H(pObj);
   \                     ??_CalcParams_2:
   \   00000134   ........           BL       GUI_ALLOC_UnlockH
    385              ySizeItem = _CallOwnerDraw(hObj, pfDrawItem, hItem, WIDGET_ITEM_GET_YSIZE);
   \   00000138   04708DE5           STR      R7,[SP, #+4]
   \   0000013C   0090A0E3           MOV      R9,#+0
   \   00000140   000055E3           CMP      R5,#+0
   \   00000144   0700000A           BEQ      ??_CalcParams_7
   \   00000148   1910A0E3           MOV      R1,#+25
   \   0000014C   0C108DE5           STR      R1,[SP, #+12]
   \   00000150   04108DE2           ADD      R1,SP,#+4
   \   00000154   08408DE5           STR      R4,[SP, #+8]
   \   00000158   24108DE5           STR      R1,[SP, #+36]
   \   0000015C   08008DE2           ADD      R0,SP,#+8
   \   00000160   35FF2FE1           BLX      R5
   \   00000164   0090A0E1           MOV      R9,R0
    386              pObj = TREEVIEW_LOCK_H(hObj);
   \                     ??_CalcParams_7:
   \   00000168   0400A0E1           MOV      R0,R4
   \   0000016C   ........           BL       GUI_ALLOC_LockH
   \   00000170   00A0A0E1           MOV      R10,R0
    387              pObj->ySizeItems += ySizeItem;
   \   00000174   BC009AE5           LDR      R0,[R10, #+188]
   \   00000178   000089E0           ADD      R0,R9,R0
   \   0000017C   BC008AE5           STR      R0,[R10, #+188]
    388              pObj->NumVisItems++;
   \   00000180   B4009AE5           LDR      R0,[R10, #+180]
    389              OldLevel = Level;
   \   00000184   0890A0E1           MOV      R9,R8
   \   00000188   010080E2           ADD      R0,R0,#+1
   \   0000018C   B4008AE5           STR      R0,[R10, #+180]
    390              hItem    = _SkipClosedItems(hItem);
   \   00000190   0700A0E1           MOV      R0,R7
   \   00000194   ........           BL       GUI_ALLOC_LockH
   \   00000198   1810D0E5           LDRB     R1,[R0, #+24]
   \   0000019C   031001E2           AND      R1,R1,#0x3
   \   000001A0   010051E3           CMP      R1,#+1
   \   000001A4   0A00001A           BNE      ??_CalcParams_8
   \   000001A8   1C80D0E5           LDRB     R8,[R0, #+28]
   \                     ??_CalcParams_9:
   \   000001AC   047090E5           LDR      R7,[R0, #+4]
   \   000001B0   000057E3           CMP      R7,#+0
   \   000001B4   0700000A           BEQ      ??_CalcParams_10
   \   000001B8   ........           BL       GUI_ALLOC_UnlockH
   \   000001BC   0700A0E1           MOV      R0,R7
   \   000001C0   ........           BL       GUI_ALLOC_LockH
   \   000001C4   1C10D0E5           LDRB     R1,[R0, #+28]
   \   000001C8   010058E1           CMP      R8,R1
   \   000001CC   F6FFFFBA           BLT      ??_CalcParams_9
   \   000001D0   000000EA           B        ??_CalcParams_10
   \                     ??_CalcParams_8:
   \   000001D4   047090E5           LDR      R7,[R0, #+4]
   \                     ??_CalcParams_10:
   \   000001D8   ........           BL       GUI_ALLOC_UnlockH
    391            }
   \   000001DC   000057E3           CMP      R7,#+0
   \   000001E0   9EFFFF1A           BNE      ??_CalcParams_1
    392            if (hItemOld) {
   \   000001E4   00009DE5           LDR      R0,[SP, #+0]
   \   000001E8   000050E3           CMP      R0,#+0
   \   000001EC   2200000A           BEQ      ??_CalcParams_0
    393              _ConnectLines(hItemOld, ahIndent, OldLevel, 0);
   \   000001F0   ........           BL       GUI_ALLOC_LockH
   \   000001F4   0040A0E1           MOV      R4,R0
   \   000001F8   28008DE2           ADD      R0,SP,#+40
   \   000001FC   095180E0           ADD      R5,R0,R9, LSL #+2
   \                     ??_CalcParams_11:
   \   00000200   000095E5           LDR      R0,[R5, #+0]
   \   00000204   ........           BL       GUI_ALLOC_LockH
   \   00000208   000050E3           CMP      R0,#+0
   \   0000020C   B811D011           LDRHNE   R1,[R0, #+24]
   \   00000210   04108113           ORRNE    R1,R1,#0x4
   \   00000214   B811C011           STRHNE   R1,[R0, #+24]
   \   00000218   ........           BL       GUI_ALLOC_UnlockH
   \   0000021C   019049E2           SUB      R9,R9,#+1
   \   00000220   045045E2           SUB      R5,R5,#+4
   \   00000224   010059E3           CMP      R9,#+1
   \   00000228   F4FFFFAA           BGE      ??_CalcParams_11
   \   0000022C   1C50D4E5           LDRB     R5,[R4, #+28]
   \   00000230   0100A0E3           MOV      R0,#+1
   \   00000234   011045E2           SUB      R1,R5,#+1
   \   00000238   1061A0E1           LSL      R6,R0,R1
   \   0000023C   0668A0E1           LSL      R6,R6,#+16
   \   00000240   020000EA           B        ??_CalcParams_12
   \                     ??_CalcParams_13:
   \   00000244   BA01D4E1           LDRH     R0,[R4, #+26]
   \   00000248   260880E1           ORR      R0,R0,R6, LSR #+16
   \   0000024C   BA01C4E1           STRH     R0,[R4, #+26]
   \                     ??_CalcParams_12:
   \   00000250   084094E5           LDR      R4,[R4, #+8]
   \   00000254   000054E3           CMP      R4,#+0
   \   00000258   0600000A           BEQ      ??_CalcParams_14
   \   0000025C   ........           BL       GUI_ALLOC_UnlockH
   \   00000260   0400A0E1           MOV      R0,R4
   \   00000264   ........           BL       GUI_ALLOC_LockH
   \   00000268   0040A0E1           MOV      R4,R0
   \   0000026C   1C00D4E5           LDRB     R0,[R4, #+28]
   \   00000270   000055E1           CMP      R5,R0
   \   00000274   F2FFFFBA           BLT      ??_CalcParams_13
   \                     ??_CalcParams_14:
   \   00000278   ........           BL       GUI_ALLOC_UnlockH
    394            }
    395            GUI_UNLOCK_H(pObj);
   \                     ??_CalcParams_0:
   \   0000027C   ........           BL       GUI_ALLOC_UnlockH
    396          }
   \   00000280   6CD08DE2           ADD      SP,SP,#+108      ;; stack cleaning
   \   00000284   F08FBDE8           POP      {R4-R11,PC}      ;; return
    397          
    398          /*********************************************************************
    399          *
    400          *       _GetNumVisItems
    401          *
    402          * Purpose:
    403          *   Returns the number of fully or partially visible items
    404          */

   \                                 In section .text, align 4, keep-with-next
    405          static unsigned _GetNumVisItems(TREEVIEW_Handle hObj) {
   \                     _GetNumVisItems:
   \   00000000   F0472DE9           PUSH     {R4-R10,LR}
   \   00000004   30D04DE2           SUB      SP,SP,#+48
   \   00000008   0040A0E1           MOV      R4,R0
    406            const TREEVIEW_OBJ * pObj;
    407            int NumItems, ySize, DistY = 0;
   \   0000000C   0070A0E3           MOV      R7,#+0
    408            TREEVIEW_ITEM_Handle hItem;
    409            GUI_RECT Rect;
    410            int r = 0;
   \   00000010   0060A0E3           MOV      R6,#+0
    411            WIDGET_DRAW_ITEM_FUNC * pfDrawItem;
    412          
    413            pObj = TREEVIEW_LOCK_H(hObj);
   \   00000014   ........           BL       GUI_ALLOC_LockH
    414            NumItems = pObj->NumVisItems;
   \   00000018   B48090E5           LDR      R8,[R0, #+180]
    415            pfDrawItem = pObj->pfDrawItem;
   \   0000001C   345090E5           LDR      R5,[R0, #+52]
    416            hItem = pObj->hFirst;
   \   00000020   A09090E5           LDR      R9,[R0, #+160]
    417            GUI_UNLOCK_H(pObj);
   \   00000024   ........           BL       GUI_ALLOC_UnlockH
    418            if (NumItems > 1) {
   \   00000028   020058E3           CMP      R8,#+2
   \   0000002C   290000BA           BLT      ??_GetNumVisItems_0
    419              WM_GetInsideRectExScrollbar(hObj, &Rect);
   \   00000030   04108DE2           ADD      R1,SP,#+4
   \   00000034   0400A0E1           MOV      R0,R4
   \   00000038   ........           BL       WM_GetInsideRectExScrollbar
    420              ySize = Rect.y1 - Rect.y0 + 1;
   \   0000003C   FA00DDE1           LDRSH    R0,[SP, #+10]
   \   00000040   F610DDE1           LDRSH    R1,[SP, #+6]
   \   00000044   010040E0           SUB      R0,R0,R1
   \   00000048   018080E2           ADD      R8,R0,#+1
    421              while (hItem) {
   \                     ??_GetNumVisItems_1:
   \   0000004C   000059E3           CMP      R9,#+0
   \   00000050   2000000A           BEQ      ??_GetNumVisItems_0
    422                r++;
   \   00000054   016086E2           ADD      R6,R6,#+1
    423                DistY += _CallOwnerDraw(hObj, pfDrawItem, hItem, WIDGET_ITEM_GET_YSIZE);
   \   00000058   00908DE5           STR      R9,[SP, #+0]
   \   0000005C   0000A0E3           MOV      R0,#+0
   \   00000060   000055E3           CMP      R5,#+0
   \   00000064   0500000A           BEQ      ??_GetNumVisItems_2
   \   00000068   1910A0E3           MOV      R1,#+25
   \   0000006C   10108DE5           STR      R1,[SP, #+16]
   \   00000070   0C408DE5           STR      R4,[SP, #+12]
   \   00000074   28D08DE5           STR      SP,[SP, #+40]
   \   00000078   0C008DE2           ADD      R0,SP,#+12
   \   0000007C   35FF2FE1           BLX      R5
   \                     ??_GetNumVisItems_2:
   \   00000080   077080E0           ADD      R7,R0,R7
    424                /* Skip closed items */
    425                hItem = _SkipClosedItems(hItem);
   \   00000084   0900A0E1           MOV      R0,R9
   \   00000088   ........           BL       GUI_ALLOC_LockH
   \   0000008C   1810D0E5           LDRB     R1,[R0, #+24]
   \   00000090   031001E2           AND      R1,R1,#0x3
   \   00000094   010051E3           CMP      R1,#+1
   \   00000098   0A00001A           BNE      ??_GetNumVisItems_3
   \   0000009C   1CA0D0E5           LDRB     R10,[R0, #+28]
   \                     ??_GetNumVisItems_4:
   \   000000A0   049090E5           LDR      R9,[R0, #+4]
   \   000000A4   000059E3           CMP      R9,#+0
   \   000000A8   0700000A           BEQ      ??_GetNumVisItems_5
   \   000000AC   ........           BL       GUI_ALLOC_UnlockH
   \   000000B0   0900A0E1           MOV      R0,R9
   \   000000B4   ........           BL       GUI_ALLOC_LockH
   \   000000B8   1C10D0E5           LDRB     R1,[R0, #+28]
   \   000000BC   01005AE1           CMP      R10,R1
   \   000000C0   F6FFFFBA           BLT      ??_GetNumVisItems_4
   \   000000C4   000000EA           B        ??_GetNumVisItems_5
   \                     ??_GetNumVisItems_3:
   \   000000C8   049090E5           LDR      R9,[R0, #+4]
   \                     ??_GetNumVisItems_5:
   \   000000CC   ........           BL       GUI_ALLOC_UnlockH
    426                if (DistY >= ySize) {
   \   000000D0   080057E1           CMP      R7,R8
   \   000000D4   DCFFFFBA           BLT      ??_GetNumVisItems_1
    427                  break;
    428                }
    429              }
    430            }
    431            return r;
   \                     ??_GetNumVisItems_0:
   \   000000D8   0600A0E1           MOV      R0,R6
   \   000000DC   30D08DE2           ADD      SP,SP,#+48
   \   000000E0   F087BDE8           POP      {R4-R10,PC}      ;; return
    432          }
    433          
    434          /*********************************************************************
    435          *
    436          *       _ManageAutoScroll
    437          */

   \                                 In section .text, align 4, keep-with-next
    438          static void _ManageAutoScroll(TREEVIEW_Handle hObj) {
   \                     _ManageAutoScroll:
   \   00000000   F0432DE9           PUSH     {R4-R9,LR}
    439            TREEVIEW_OBJ * pObj;
    440            GUI_RECT Rect;
    441            int IsRequiredV;
    442            int IsRequiredH;
    443            static int IsActive;
    444            if (IsActive == 0) {
   \   00000004   ........           LDR      R5,??DataTable1
   \   00000008   0040A0E1           MOV      R4,R0
   \   0000000C   000095E5           LDR      R0,[R5, #+0]
   \   00000010   24D04DE2           SUB      SP,SP,#+36
   \   00000014   000050E3           CMP      R0,#+0
   \   00000018   5B00001A           BNE      ??_ManageAutoScroll_0
    445              IsActive = 1;
   \   0000001C   0180A0E3           MOV      R8,#+1
   \   00000020   008085E5           STR      R8,[R5, #+0]
    446              pObj = TREEVIEW_LOCK_H(hObj);
   \   00000024   0400A0E1           MOV      R0,R4
   \   00000028   ........           BL       GUI_ALLOC_LockH
   \   0000002C   0060A0E1           MOV      R6,R0
    447              WM_GetInsideRectExScrollbar(hObj, &Rect);
   \   00000030   0D10A0E1           MOV      R1,SP
   \   00000034   0400A0E1           MOV      R0,R4
   \   00000038   ........           BL       WM_GetInsideRectExScrollbar
    448              /*
    449              * Manage vertical scroll bar
    450              */
    451              IsRequiredV = (pObj->ySizeItems > (Rect.y1 - Rect.y0 + 1)) ? 1 : 0;
   \   0000003C   F600DDE1           LDRSH    R0,[SP, #+6]
   \   00000040   F210DDE1           LDRSH    R1,[SP, #+2]
   \   00000044   010040E0           SUB      R0,R0,R1
   \   00000048   BC1096E5           LDR      R1,[R6, #+188]
   \   0000004C   010080E2           ADD      R0,R0,#+1
   \   00000050   010050E1           CMP      R0,R1
   \   00000054   070000AA           BGE      ??_ManageAutoScroll_1
    452              if (IsRequiredV) {
    453                pObj->ScrollStateV.NumItems = pObj->NumVisItems + 1;
   \   00000058   B40096E5           LDR      R0,[R6, #+180]
   \   0000005C   0170A0E3           MOV      R7,#+1
   \   00000060   010080E2           ADD      R0,R0,#+1
   \   00000064   380086E5           STR      R0,[R6, #+56]
    454                pObj->ScrollStateV.PageSize = _GetNumVisItems(hObj);
   \   00000068   0400A0E1           MOV      R0,R4
   \   0000006C   ........           BL       _GetNumVisItems
   \   00000070   400086E5           STR      R0,[R6, #+64]
   \   00000074   010000EA           B        ??_ManageAutoScroll_2
    455              } else {
   \                     ??_ManageAutoScroll_1:
   \   00000078   0070A0E3           MOV      R7,#+0
    456                pObj->ScrollStateV.v = 0;
   \   0000007C   3C7086E5           STR      R7,[R6, #+60]
    457              }
    458              if (pObj->Flags & TREEVIEW_SF_AUTOSCROLLBAR_V) {
   \                     ??_ManageAutoScroll_2:
   \   00000080   9C00D6E5           LDRB     R0,[R6, #+156]
   \   00000084   080010E3           TST      R0,#0x8
   \   00000088   0700000A           BEQ      ??_ManageAutoScroll_3
    459                GUI_UNLOCK_H(pObj);
   \   0000008C   ........           BL       GUI_ALLOC_UnlockH
    460                WM_SetScrollbarV(hObj, IsRequiredV);
   \   00000090   0710A0E1           MOV      R1,R7
   \   00000094   0400A0E1           MOV      R0,R4
   \   00000098   ........           BL       WM_SetScrollbarV
    461                pObj = TREEVIEW_LOCK_H(hObj);
   \   0000009C   0400A0E1           MOV      R0,R4
   \   000000A0   ........           BL       GUI_ALLOC_LockH
   \   000000A4   0060A0E1           MOV      R6,R0
   \   000000A8   070000EA           B        ??_ManageAutoScroll_4
    462              } else {
    463                WM_HWIN hWin;
    464                hWin = WM_GetScrollbarV(hObj);
    465                if (hWin) {
   \                     ??_ManageAutoScroll_3:
   \   000000AC   0400A0E1           MOV      R0,R4
   \   000000B0   ........           BL       WM_GetScrollbarV
   \   000000B4   000050E3           CMP      R0,#+0
   \   000000B8   0300000A           BEQ      ??_ManageAutoScroll_4
    466                  if (IsRequiredV == 0) {
   \   000000BC   000057E3           CMP      R7,#+0
    467                    pObj->ScrollStateV.NumItems = 1;
   \   000000C0   38808605           STREQ    R8,[R6, #+56]
    468                    pObj->ScrollStateV.PageSize = 1;
   \   000000C4   40808605           STREQ    R8,[R6, #+64]
    469                    IsRequiredV                 = 1;
   \   000000C8   0170A003           MOVEQ    R7,#+1
   \                     ??_ManageAutoScroll_4:
   \   000000CC   F400DDE1           LDRSH    R0,[SP, #+4]
   \   000000D0   F010DDE1           LDRSH    R1,[SP, #+0]
   \   000000D4   010040E0           SUB      R0,R0,R1
   \   000000D8   B81096E5           LDR      R1,[R6, #+184]
   \   000000DC   010080E2           ADD      R0,R0,#+1
   \   000000E0   010050E1           CMP      R0,R1
   \   000000E4   030000AA           BGE      ??_ManageAutoScroll_5
    470                  }
    471                }
    472              }
    473              /*
    474              * Manage horizontal scroll bar
    475              */
    476              IsRequiredH = (pObj->xSizeItems > (Rect.x1 - Rect.x0 + 1)) ? 1 : 0;
    477              if (IsRequiredH) {
    478                pObj->ScrollStateH.NumItems = pObj->xSizeItems;
   \   000000E8   441086E5           STR      R1,[R6, #+68]
   \   000000EC   0190A0E3           MOV      R9,#+1
    479                pObj->ScrollStateH.PageSize = Rect.x1 - Rect.x0 + 1;
   \   000000F0   4C0086E5           STR      R0,[R6, #+76]
   \   000000F4   010000EA           B        ??_ManageAutoScroll_6
    480              } else {
   \                     ??_ManageAutoScroll_5:
   \   000000F8   0090A0E3           MOV      R9,#+0
    481                pObj->ScrollStateH.v = 0;
   \   000000FC   489086E5           STR      R9,[R6, #+72]
    482              }
    483              if (pObj->Flags & TREEVIEW_SF_AUTOSCROLLBAR_H) {
   \                     ??_ManageAutoScroll_6:
   \   00000100   9C00D6E5           LDRB     R0,[R6, #+156]
   \   00000104   040010E3           TST      R0,#0x4
   \   00000108   0700000A           BEQ      ??_ManageAutoScroll_7
    484                GUI_UNLOCK_H(pObj);
   \   0000010C   ........           BL       GUI_ALLOC_UnlockH
    485                WM_SetScrollbarH(hObj, IsRequiredH);
   \   00000110   0910A0E1           MOV      R1,R9
   \   00000114   0400A0E1           MOV      R0,R4
   \   00000118   ........           BL       WM_SetScrollbarH
    486                pObj = TREEVIEW_LOCK_H(hObj);
   \   0000011C   0400A0E1           MOV      R0,R4
   \   00000120   ........           BL       GUI_ALLOC_LockH
   \   00000124   0060A0E1           MOV      R6,R0
   \   00000128   070000EA           B        ??_ManageAutoScroll_8
    487              } else {
    488                WM_HWIN hWin;
    489                hWin = WM_GetScrollbarH(hObj);
    490                if (hWin) {
   \                     ??_ManageAutoScroll_7:
   \   0000012C   0400A0E1           MOV      R0,R4
   \   00000130   ........           BL       WM_GetScrollbarH
   \   00000134   000050E3           CMP      R0,#+0
   \   00000138   0300000A           BEQ      ??_ManageAutoScroll_8
    491                  if (IsRequiredH == 0) {
   \   0000013C   000059E3           CMP      R9,#+0
    492                    pObj->ScrollStateH.NumItems = 1;
   \   00000140   44808605           STREQ    R8,[R6, #+68]
    493                    pObj->ScrollStateH.PageSize = 1;
   \   00000144   4C808605           STREQ    R8,[R6, #+76]
    494                    IsRequiredH                 = 1;
   \   00000148   0190A003           MOVEQ    R9,#+1
    495                  }
    496                }
    497              }
    498              /*
    499              * Set scroll state
    500              */
    501              if (IsRequiredV || IsRequiredH) {
   \                     ??_ManageAutoScroll_8:
   \   0000014C   070099E1           ORRS     R0,R9,R7
   \   00000150   0C00000A           BEQ      ??_ManageAutoScroll_9
    502                WM_SCROLL_STATE ScrollStateV, ScrollStateH;
    503                ScrollStateV = pObj->ScrollStateV;
   \   00000154   381086E2           ADD      R1,R6,#+56
   \   00000158   0C10B1E8           LDM      R1!,{R2,R3,R12}
   \   0000015C   14008DE2           ADD      R0,SP,#+20
   \   00000160   0C10A0E8           STM      R0!,{R2,R3,R12}
    504                ScrollStateH = pObj->ScrollStateH;
   \   00000164   0C10B1E8           LDM      R1!,{R2,R3,R12}
   \   00000168   08008DE2           ADD      R0,SP,#+8
   \   0000016C   0C10A0E8           STM      R0!,{R2,R3,R12}
    505                GUI_UNLOCK_H(pObj);
   \   00000170   ........           BL       GUI_ALLOC_UnlockH
    506                WIDGET__SetScrollState(hObj, &ScrollStateV, &ScrollStateH);
   \   00000174   08208DE2           ADD      R2,SP,#+8
   \   00000178   14108DE2           ADD      R1,SP,#+20
   \   0000017C   0400A0E1           MOV      R0,R4
   \   00000180   ........           BL       WIDGET__SetScrollState
   \   00000184   000000EA           B        ??_ManageAutoScroll_0
    507              } else {
    508                GUI_UNLOCK_H(pObj);
   \                     ??_ManageAutoScroll_9:
   \   00000188   ........           BL       GUI_ALLOC_UnlockH
    509              }
    510            }
    511            IsActive = 0;
   \                     ??_ManageAutoScroll_0:
   \   0000018C   0000A0E3           MOV      R0,#+0
   \   00000190   000085E5           STR      R0,[R5, #+0]
    512          }
   \   00000194   24D08DE2           ADD      SP,SP,#+36
   \   00000198   F083BDE8           POP      {R4-R9,PC}       ;; return

   \                                 In section .bss, align 4
   \                     ??IsActive:
   \   00000000                      DS8 4
    513          
    514          /*********************************************************************
    515          *
    516          *       _OnPaint
    517          */

   \                                 In section .text, align 4, keep-with-next
    518          static void _OnPaint(TREEVIEW_Handle hObj, WM_MESSAGE * pMsg) {
   \                     _OnPaint:
   \   00000000   F0432DE9           PUSH     {R4-R9,LR}
   \   00000004   64D04DE2           SUB      SP,SP,#+100
   \   00000008   0040A0E1           MOV      R4,R0
   \   0000000C   0170A0E1           MOV      R7,R1
    519            TREEVIEW_OBJ * pObj;
    520            TREEVIEW_ITEM_Handle hItem;
    521            WIDGET_ITEM_DRAW_INFO ItemInfo;
    522            GUI_RECT RectInside, RectItem, ClipRect;
    523            int i, xSize, ItemDistY;
    524            WIDGET_DRAW_ITEM_FUNC * pfDrawItem;
    525          
    526            pObj = TREEVIEW_LOCK_H(hObj);
   \   00000010   ........           BL       GUI_ALLOC_LockH
   \   00000014   0050A0E1           MOV      R5,R0
    527            pfDrawItem = pObj->pfDrawItem;
   \   00000018   346095E5           LDR      R6,[R5, #+52]
    528            GUI_SetFont(pObj->Props.pFont);
   \   0000001C   500095E5           LDR      R0,[R5, #+80]
   \   00000020   ........           BL       GUI_SetFont
    529            /* Calculate clipping rectangle */
    530            ClipRect = *(const GUI_RECT*)pMsg->Data.p;
   \   00000024   0C008DE2           ADD      R0,SP,#+12
   \   00000028   0C1097E5           LDR      R1,[R7, #+12]
   \   0000002C   0820A0E3           MOV      R2,#+8
   \   00000030   ........           BL       __aeabi_memcpy
    531            GUI_MoveRect(&ClipRect, -pObj->Widget.Win.Rect.x0, -pObj->Widget.Win.Rect.y0);
   \   00000034   F200D5E1           LDRSH    R0,[R5, #+2]
   \   00000038   002060E2           RSB      R2,R0,#+0
   \   0000003C   F000D5E1           LDRSH    R0,[R5, #+0]
   \   00000040   001060E2           RSB      R1,R0,#+0
   \   00000044   0C008DE2           ADD      R0,SP,#+12
   \   00000048   ........           BL       GUI_MoveRect
    532            WM_GetInsideRectExScrollbar(hObj, &RectInside);
   \   0000004C   14108DE2           ADD      R1,SP,#+20
   \   00000050   0400A0E1           MOV      R0,R4
   \   00000054   ........           BL       WM_GetInsideRectExScrollbar
    533            GUI__IntersectRect(&ClipRect, &RectInside);
   \   00000058   14108DE2           ADD      R1,SP,#+20
   \   0000005C   0C008DE2           ADD      R0,SP,#+12
   \   00000060   ........           BL       GUI__IntersectRect
    534            xSize = RectInside.x1 - RectInside.x0 + 1;
   \   00000064   F801DDE1           LDRSH    R0,[SP, #+24]
   \   00000068   F411DDE1           LDRSH    R1,[SP, #+20]
    535            if (xSize < pObj->xSizeItems) {
    536              xSize = pObj->xSizeItems;
    537            }
    538            RectItem.x0 = ClipRect.x0;
   \   0000006C   FC20DDE1           LDRSH    R2,[SP, #+12]
    539            RectItem.x1 = ClipRect.x1;
    540            /* Fill item info structure */
    541            ItemInfo.Cmd  = WIDGET_ITEM_DRAW;
    542            ItemInfo.hWin = hObj;
    543            ItemInfo.x0   = RectInside.x0 - pObj->ScrollStateH.v;
    544            ItemInfo.y0   = RectInside.y0;
   \   00000070   F631DDE1           LDRSH    R3,[SP, #+22]
   \   00000074   010040E0           SUB      R0,R0,R1
   \   00000078   B81095E5           LDR      R1,[R5, #+184]
   \   0000007C   B420CDE1           STRH     R2,[SP, #+4]
   \   00000080   F021DDE1           LDRSH    R2,[SP, #+16]
   \   00000084   010080E2           ADD      R0,R0,#+1
   \   00000088   010050E1           CMP      R0,R1
   \   0000008C   B820CDE1           STRH     R2,[SP, #+8]
   \   00000090   0100A0B1           MOVLT    R0,R1
   \   00000094   0120A0E3           MOV      R2,#+1
   \   00000098   24208DE5           STR      R2,[SP, #+36]
   \   0000009C   20408DE5           STR      R4,[SP, #+32]
   \   000000A0   F411DDE1           LDRSH    R1,[SP, #+20]
   \   000000A4   482095E5           LDR      R2,[R5, #+72]
   \   000000A8   30308DE5           STR      R3,[SP, #+48]
   \   000000AC   021041E0           SUB      R1,R1,R2
    545            ItemInfo.x1   = ItemInfo.x0 + xSize;
   \   000000B0   010080E0           ADD      R0,R0,R1
   \   000000B4   2C108DE5           STR      R1,[SP, #+44]
   \   000000B8   34008DE5           STR      R0,[SP, #+52]
    546            hItem = pObj->hFirst;
   \   000000BC   A00095E5           LDR      R0,[R5, #+160]
   \   000000C0   00008DE5           STR      R0,[SP, #+0]
    547            /* Goto scroll position */
    548            i = pObj->ScrollStateV.v;
   \   000000C4   3C7095E5           LDR      R7,[R5, #+60]
   \   000000C8   000057E3           CMP      R7,#+0
   \   000000CC   1800000A           BEQ      ??_OnPaint_0
    549            while (i--) {
    550              if (!hItem) {
   \                     ??_OnPaint_1:
   \   000000D0   00009DE5           LDR      R0,[SP, #+0]
   \   000000D4   017047E2           SUB      R7,R7,#+1
   \   000000D8   000050E3           CMP      R0,#+0
   \   000000DC   5B00000A           BEQ      ??_OnPaint_2
    551                break;
    552              }
    553              /* Skip closed items */
    554              hItem = _SkipClosedItems(hItem);
   \   000000E0   ........           BL       GUI_ALLOC_LockH
   \   000000E4   1810D0E5           LDRB     R1,[R0, #+24]
   \   000000E8   031001E2           AND      R1,R1,#0x3
   \   000000EC   010051E3           CMP      R1,#+1
   \   000000F0   0A00001A           BNE      ??_OnPaint_3
   \   000000F4   1C90D0E5           LDRB     R9,[R0, #+28]
   \                     ??_OnPaint_4:
   \   000000F8   048090E5           LDR      R8,[R0, #+4]
   \   000000FC   000058E3           CMP      R8,#+0
   \   00000100   0700000A           BEQ      ??_OnPaint_5
   \   00000104   ........           BL       GUI_ALLOC_UnlockH
   \   00000108   0800A0E1           MOV      R0,R8
   \   0000010C   ........           BL       GUI_ALLOC_LockH
   \   00000110   1C10D0E5           LDRB     R1,[R0, #+28]
   \   00000114   010059E1           CMP      R9,R1
   \   00000118   F6FFFFBA           BLT      ??_OnPaint_4
   \   0000011C   000000EA           B        ??_OnPaint_5
   \                     ??_OnPaint_3:
   \   00000120   048090E5           LDR      R8,[R0, #+4]
   \                     ??_OnPaint_5:
   \   00000124   ........           BL       GUI_ALLOC_UnlockH
    555            }
   \   00000128   00808DE5           STR      R8,[SP, #+0]
   \   0000012C   000057E3           CMP      R7,#+0
   \   00000130   E6FFFF1A           BNE      ??_OnPaint_1
    556            /* Do the drawing */
    557            while (hItem) {
   \                     ??_OnPaint_0:
   \   00000134   00009DE5           LDR      R0,[SP, #+0]
   \   00000138   000050E3           CMP      R0,#+0
   \   0000013C   4300000A           BEQ      ??_OnPaint_2
    558              RectItem.y0 = ItemInfo.y0;
   \   00000140   30109DE5           LDR      R1,[SP, #+48]
    559              /* Break when all other rows are outside the drawing area */
    560              if (RectItem.y0 > ClipRect.y1) {
   \   00000144   F201DDE1           LDRSH    R0,[SP, #+18]
   \   00000148   B610CDE1           STRH     R1,[SP, #+6]
   \   0000014C   F610DDE1           LDRSH    R1,[SP, #+6]
   \   00000150   010050E1           CMP      R0,R1
   \   00000154   3C0000BA           BLT      ??_OnPaint_6
    561                break;
    562              }
    563              GUI_UNLOCK_H(pObj);
   \   00000158   ........           BL       GUI_ALLOC_UnlockH
    564              ItemDistY = _CallOwnerDraw(hObj, pfDrawItem, hItem, WIDGET_ITEM_GET_YSIZE);
   \   0000015C   00109DE5           LDR      R1,[SP, #+0]
   \   00000160   0070A0E3           MOV      R7,#+0
   \   00000164   1C108DE5           STR      R1,[SP, #+28]
   \   00000168   000056E3           CMP      R6,#+0
   \   0000016C   0700000A           BEQ      ??_OnPaint_7
   \   00000170   1910A0E3           MOV      R1,#+25
   \   00000174   44108DE5           STR      R1,[SP, #+68]
   \   00000178   1C108DE2           ADD      R1,SP,#+28
   \   0000017C   40408DE5           STR      R4,[SP, #+64]
   \   00000180   5C108DE5           STR      R1,[SP, #+92]
   \   00000184   40008DE2           ADD      R0,SP,#+64
   \   00000188   36FF2FE1           BLX      R6
   \   0000018C   0070A0E1           MOV      R7,R0
    565              pObj = TREEVIEW_LOCK_H(hObj);
   \                     ??_OnPaint_7:
   \   00000190   0400A0E1           MOV      R0,R4
   \   00000194   ........           BL       GUI_ALLOC_LockH
    566              RectItem.y1 = RectItem.y0 + ItemDistY - 1;
   \   00000198   F610DDE1           LDRSH    R1,[SP, #+6]
   \   0000019C   0050A0E1           MOV      R5,R0
   \   000001A0   070081E0           ADD      R0,R1,R7
   \   000001A4   010040E2           SUB      R0,R0,#+1
    567              /* Make sure that we draw only when row is in drawing area */
    568              if (RectItem.y1 >= ClipRect.y0) {
   \   000001A8   FE10DDE1           LDRSH    R1,[SP, #+14]
   \   000001AC   BA00CDE1           STRH     R0,[SP, #+10]
   \   000001B0   0008A0E1           MOV      R0,R0, LSL #+16
   \   000001B4   400851E1           CMP      R1,R0, ASR #+16
   \   000001B8   0B0000CA           BGT      ??_OnPaint_8
    569                /* Set user clip rect */
    570                WM_SetUserClipArea(&RectItem);
   \   000001BC   04008DE2           ADD      R0,SP,#+4
   \   000001C0   ........           BL       WM_SetUserClipRect
    571                /* Fill item info structure */
    572                ItemInfo.p = (TREEVIEW_ITEM_Handle *)&hItem;
    573                ItemInfo.y1  = ItemInfo.y0 + ItemDistY - 1;
   \   000001C4   30009DE5           LDR      R0,[SP, #+48]
   \   000001C8   3CD08DE5           STR      SP,[SP, #+60]
   \   000001CC   070080E0           ADD      R0,R0,R7
   \   000001D0   010040E2           SUB      R0,R0,#+1
   \   000001D4   38008DE5           STR      R0,[SP, #+56]
    574                /* Draw item */
    575                if (pObj->pfDrawItem) {
   \   000001D8   341095E5           LDR      R1,[R5, #+52]
   \   000001DC   000051E3           CMP      R1,#+0
   \   000001E0   0100000A           BEQ      ??_OnPaint_8
    576                  pObj->pfDrawItem(&ItemInfo);
   \   000001E4   20008DE2           ADD      R0,SP,#+32
   \   000001E8   31FF2FE1           BLX      R1
    577                }
    578              }
    579              ItemInfo.y0 += ItemDistY;
   \                     ??_OnPaint_8:
   \   000001EC   30009DE5           LDR      R0,[SP, #+48]
   \   000001F0   000087E0           ADD      R0,R7,R0
   \   000001F4   30008DE5           STR      R0,[SP, #+48]
    580              /* Skip closed items */
    581              hItem = _SkipClosedItems(hItem);
   \   000001F8   00009DE5           LDR      R0,[SP, #+0]
   \   000001FC   ........           BL       GUI_ALLOC_LockH
   \   00000200   1810D0E5           LDRB     R1,[R0, #+24]
   \   00000204   031001E2           AND      R1,R1,#0x3
   \   00000208   010051E3           CMP      R1,#+1
   \   0000020C   0A00001A           BNE      ??_OnPaint_9
   \   00000210   1C70D0E5           LDRB     R7,[R0, #+28]
   \                     ??_OnPaint_10:
   \   00000214   048090E5           LDR      R8,[R0, #+4]
   \   00000218   000058E3           CMP      R8,#+0
   \   0000021C   0700000A           BEQ      ??_OnPaint_11
   \   00000220   ........           BL       GUI_ALLOC_UnlockH
   \   00000224   0800A0E1           MOV      R0,R8
   \   00000228   ........           BL       GUI_ALLOC_LockH
   \   0000022C   1C10D0E5           LDRB     R1,[R0, #+28]
   \   00000230   010057E1           CMP      R7,R1
   \   00000234   F6FFFFBA           BLT      ??_OnPaint_10
   \   00000238   000000EA           B        ??_OnPaint_11
   \                     ??_OnPaint_9:
   \   0000023C   048090E5           LDR      R8,[R0, #+4]
   \                     ??_OnPaint_11:
   \   00000240   ........           BL       GUI_ALLOC_UnlockH
    582            }
   \   00000244   00808DE5           STR      R8,[SP, #+0]
   \   00000248   B9FFFFEA           B        ??_OnPaint_0
    583            WM_SetUserClipArea(NULL);
   \                     ??_OnPaint_6:
   \   0000024C   0000A0E3           MOV      R0,#+0
   \                     ??_OnPaint_2:
   \   00000250   ........           BL       WM_SetUserClipRect
    584            /* Calculate & clear 'data free' area */
    585            if (pObj->Props.aBkColor[TREEVIEW_CI_UNSEL] != GUI_INVALID_COLOR) {
   \   00000254   540095E5           LDR      R0,[R5, #+84]
   \   00000258   F014E0E3           MVN      R1,#-268435456
   \   0000025C   010050E1           CMP      R0,R1
   \   00000260   0700000A           BEQ      ??_OnPaint_12
    586              RectItem.y0 = ItemInfo.y0;
   \   00000264   30109DE5           LDR      R1,[SP, #+48]
   \   00000268   B610CDE1           STRH     R1,[SP, #+6]
    587              RectItem.y1 = RectInside.y1;
   \   0000026C   FA11DDE1           LDRSH    R1,[SP, #+26]
   \   00000270   BA10CDE1           STRH     R1,[SP, #+10]
    588              LCD_SetBkColor(pObj->Props.aBkColor[TREEVIEW_CI_UNSEL]);
   \   00000274   540095E5           LDR      R0,[R5, #+84]
   \   00000278   ........           BL       LCD_SetBkColor
    589              GUI_ClearRectEx(&RectItem);
   \   0000027C   04008DE2           ADD      R0,SP,#+4
   \   00000280   ........           BL       GUI_ClearRectEx
    590            }
    591            WIDGET__EFFECT_DrawDown(&pObj->Widget);
   \                     ??_OnPaint_12:
   \   00000284   0500A0E1           MOV      R0,R5
   \   00000288   ........           BL       WIDGET__EFFECT_DrawDown
    592            GUI_UNLOCK_H(pObj);
   \   0000028C   ........           BL       GUI_ALLOC_UnlockH
    593          }
   \   00000290   64D08DE2           ADD      SP,SP,#+100      ;; stack cleaning
   \   00000294   F083BDE8           POP      {R4-R9,PC}       ;; return
    594          
    595          /*********************************************************************
    596          *
    597          *       _GetItemFromPos
    598          */

   \                                 In section .text, align 4, keep-with-next
    599          static TREEVIEW_ITEM_Handle _GetItemFromPos(TREEVIEW_Handle hObj, int y) {
   \                     _GetItemFromPos:
   \   00000000   F0472DE9           PUSH     {R4-R10,LR}
   \   00000004   28D04DE2           SUB      SP,SP,#+40
   \   00000008   0050A0E1           MOV      R5,R0
   \   0000000C   0160A0E1           MOV      R6,R1
    600            TREEVIEW_OBJ * pObj;
    601            TREEVIEW_ITEM_Handle hItem;
    602            int i, yPos;
    603            WIDGET_DRAW_ITEM_FUNC * pfDrawItem;
    604          
    605            pObj = TREEVIEW_LOCK_H(hObj);
   \   00000010   ........           BL       GUI_ALLOC_LockH
    606            pfDrawItem = pObj->pfDrawItem;
   \   00000014   347090E5           LDR      R7,[R0, #+52]
    607            hItem = pObj->hFirst;
   \   00000018   A04090E5           LDR      R4,[R0, #+160]
    608            i = pObj->ScrollStateV.v;
   \   0000001C   3C8090E5           LDR      R8,[R0, #+60]
    609            GUI_UNLOCK_H(pObj);
   \   00000020   ........           BL       GUI_ALLOC_UnlockH
   \   00000024   000058E3           CMP      R8,#+0
   \   00000028   1700000A           BEQ      ??_GetItemFromPos_0
   \                     ??_GetItemFromPos_1:
   \   0000002C   018048E2           SUB      R8,R8,#+1
    610            /* 
    611            * Goto scroll position
    612            */
    613            while (i--) {
    614              if (!hItem) {
   \   00000030   000054E3           CMP      R4,#+0
   \   00000034   1400000A           BEQ      ??_GetItemFromPos_0
    615                break;
    616              }
    617              /*
    618              * Skip closed items
    619              */
    620              hItem = _SkipClosedItems(hItem);
   \   00000038   0400A0E1           MOV      R0,R4
   \   0000003C   ........           BL       GUI_ALLOC_LockH
   \   00000040   1810D0E5           LDRB     R1,[R0, #+24]
   \   00000044   031001E2           AND      R1,R1,#0x3
   \   00000048   010051E3           CMP      R1,#+1
   \   0000004C   0A00001A           BNE      ??_GetItemFromPos_2
   \   00000050   1C90D0E5           LDRB     R9,[R0, #+28]
   \                     ??_GetItemFromPos_3:
   \   00000054   044090E5           LDR      R4,[R0, #+4]
   \   00000058   000054E3           CMP      R4,#+0
   \   0000005C   0700000A           BEQ      ??_GetItemFromPos_4
   \   00000060   ........           BL       GUI_ALLOC_UnlockH
   \   00000064   0400A0E1           MOV      R0,R4
   \   00000068   ........           BL       GUI_ALLOC_LockH
   \   0000006C   1C10D0E5           LDRB     R1,[R0, #+28]
   \   00000070   010059E1           CMP      R9,R1
   \   00000074   F6FFFFBA           BLT      ??_GetItemFromPos_3
   \   00000078   000000EA           B        ??_GetItemFromPos_4
   \                     ??_GetItemFromPos_2:
   \   0000007C   044090E5           LDR      R4,[R0, #+4]
   \                     ??_GetItemFromPos_4:
   \   00000080   ........           BL       GUI_ALLOC_UnlockH
    621            }
   \   00000084   000058E3           CMP      R8,#+0
   \   00000088   E7FFFF1A           BNE      ??_GetItemFromPos_1
    622            yPos = 0;
   \                     ??_GetItemFromPos_0:
   \   0000008C   0090A0E3           MOV      R9,#+0
   \   00000090   1980A0E3           MOV      R8,#+25
   \   00000094   010000EA           B        ??_GetItemFromPos_5
    623            while (hItem) {
   \                     ??_GetItemFromPos_6:
   \   00000098   044090E5           LDR      R4,[R0, #+4]
   \                     ??_GetItemFromPos_7:
   \   0000009C   ........           BL       GUI_ALLOC_UnlockH
    624              int ItemDistY;
    625              ItemDistY = _CallOwnerDraw(hObj, pfDrawItem, hItem, WIDGET_ITEM_GET_YSIZE);
    626              if ((yPos <= y) && ((yPos + ItemDistY) >= y)) {
    627                return hItem;
    628              }
    629              yPos += ItemDistY;
    630              /*
    631              * Skip closed items
    632              */
    633              hItem = _SkipClosedItems(hItem);
   \                     ??_GetItemFromPos_5:
   \   000000A0   000054E3           CMP      R4,#+0
   \   000000A4   1F00000A           BEQ      ??_GetItemFromPos_8
   \   000000A8   00408DE5           STR      R4,[SP, #+0]
   \   000000AC   0000A0E3           MOV      R0,#+0
   \   000000B0   000057E3           CMP      R7,#+0
   \   000000B4   0400000A           BEQ      ??_GetItemFromPos_9
   \   000000B8   08808DE5           STR      R8,[SP, #+8]
   \   000000BC   04508DE5           STR      R5,[SP, #+4]
   \   000000C0   20D08DE5           STR      SP,[SP, #+32]
   \   000000C4   04008DE2           ADD      R0,SP,#+4
   \   000000C8   37FF2FE1           BLX      R7
   \                     ??_GetItemFromPos_9:
   \   000000CC   090080E0           ADD      R0,R0,R9
   \   000000D0   090056E1           CMP      R6,R9
   \   000000D4   060050A1           CMPGE    R0,R6
   \   000000D8   0400A0A1           MOVGE    R0,R4
   \   000000DC   120000AA           BGE      ??_GetItemFromPos_10
   \   000000E0   0090A0E1           MOV      R9,R0
   \   000000E4   0400A0E1           MOV      R0,R4
   \   000000E8   ........           BL       GUI_ALLOC_LockH
   \   000000EC   1810D0E5           LDRB     R1,[R0, #+24]
   \   000000F0   031001E2           AND      R1,R1,#0x3
   \   000000F4   010051E3           CMP      R1,#+1
   \   000000F8   E6FFFF1A           BNE      ??_GetItemFromPos_6
   \   000000FC   1CA0D0E5           LDRB     R10,[R0, #+28]
   \                     ??_GetItemFromPos_11:
   \   00000100   044090E5           LDR      R4,[R0, #+4]
   \   00000104   000054E3           CMP      R4,#+0
   \   00000108   E3FFFF0A           BEQ      ??_GetItemFromPos_7
   \   0000010C   ........           BL       GUI_ALLOC_UnlockH
   \   00000110   0400A0E1           MOV      R0,R4
   \   00000114   ........           BL       GUI_ALLOC_LockH
   \   00000118   1C10D0E5           LDRB     R1,[R0, #+28]
   \   0000011C   01005AE1           CMP      R10,R1
   \   00000120   F6FFFFBA           BLT      ??_GetItemFromPos_11
   \   00000124   DCFFFFEA           B        ??_GetItemFromPos_7
    634            }
    635            return 0;
   \                     ??_GetItemFromPos_8:
   \   00000128   0000A0E3           MOV      R0,#+0
   \                     ??_GetItemFromPos_10:
   \   0000012C   28D08DE2           ADD      SP,SP,#+40       ;; stack cleaning
   \   00000130   F087BDE8           POP      {R4-R10,PC}      ;; return
    636          }
    637          
    638          /*********************************************************************
    639          *
    640          *       _ExpandItem
    641          */
    642          static void _ExpandItem(TREEVIEW_ITEM_Handle hItem) {
    643            TREEVIEW_ITEM_OBJ * pItem;
    644            WM_HMEM              hParent;
    645            pItem = (TREEVIEW_ITEM_OBJ *)GUI_LOCK_H(hItem);
    646            hParent = pItem->hParent;
    647            if ((pItem->Flags & TREEVIEW_ITEM_TYPE_NODE) && ((pItem->Flags & TREEVIEW_ITEM_STATE_EXPANDED) == 0)) {
    648              pItem->Flags |= TREEVIEW_ITEM_STATE_EXPANDED;
    649              GUI_UNLOCK_H(pItem);
    650              if (hParent) {
    651                _CalcParams(hParent);
    652                _ManageAutoScroll(hParent);
    653                WM_InvalidateWindow(hParent);
    654              }
    655            } else {
    656              GUI_UNLOCK_H(pItem);
    657            }
    658          }
    659          
    660          /*********************************************************************
    661          *
    662          *       _CollapseItem
    663          */
    664          static void _CollapseItem(TREEVIEW_ITEM_Handle hItem) {
    665            TREEVIEW_ITEM_OBJ * pItem;
    666            WM_HMEM              hParent;
    667            pItem = (TREEVIEW_ITEM_OBJ *)GUI_LOCK_H(hItem);
    668            hParent = pItem->hParent;
    669            if ((pItem->Flags & TREEVIEW_ITEM_TYPE_NODE) && (pItem->Flags & TREEVIEW_ITEM_STATE_EXPANDED)) {
    670              pItem->Flags &= ~TREEVIEW_ITEM_STATE_EXPANDED;
    671              GUI_UNLOCK_H(pItem);
    672              if (hParent) {
    673                _CalcParams(hParent);
    674                _ManageAutoScroll(hParent);
    675                WM_InvalidateWindow(hParent);
    676              }
    677            } else {
    678              GUI_UNLOCK_H(pItem);
    679            }
    680          }
    681          
    682          /*********************************************************************
    683          *
    684          *       _OnTouch
    685          */

   \                                 In section .text, align 4, keep-with-next
    686          static void _OnTouch(TREEVIEW_Handle hObj, WM_MESSAGE * pMsg) {
   \                     _OnTouch:
   \   00000000   F0432DE9           PUSH     {R4-R9,LR}
    687            const GUI_PID_STATE * pState = (const GUI_PID_STATE *)pMsg->Data.p;
   \   00000004   0C6091E5           LDR      R6,[R1, #+12]
   \   00000008   0CD04DE2           SUB      SP,SP,#+12
   \   0000000C   0050A0E1           MOV      R5,R0
    688            if (pState) {  /* Something happened in our area (pressed or released) */
   \   00000010   000056E3           CMP      R6,#+0
   \   00000014   7600000A           BEQ      ??_OnTouch_0
    689              TREEVIEW_OBJ * pObj;
    690              TREEVIEW_ITEM_Handle hItem;
    691              TREEVIEW_ITEM_OBJ  * pItem;
    692              GUI_TIMER_HANDLE hTimer;
    693              U16 Flags;
    694              if (pState->Pressed) {
   \   00000018   0800D6E5           LDRB     R0,[R6, #+8]
   \   0000001C   000050E3           CMP      R0,#+0
   \   00000020   7100000A           BEQ      ??_OnTouch_1
    695                if (!WM_HasCaptured(hObj)) {
   \   00000024   0500A0E1           MOV      R0,R5
   \   00000028   ........           BL       WM_HasCaptured
   \   0000002C   000050E3           CMP      R0,#+0
   \   00000030   6A00001A           BNE      ??_OnTouch_2
    696                  WM_SetCapture(hObj, 1);
   \   00000034   0110A0E3           MOV      R1,#+1
   \   00000038   0500A0E1           MOV      R0,R5
   \   0000003C   ........           BL       WM_SetCapture
    697                  hItem = _GetItemFromPos(hObj, pState->y);
   \   00000040   041096E5           LDR      R1,[R6, #+4]
   \   00000044   0500A0E1           MOV      R0,R5
   \   00000048   ........           BL       _GetItemFromPos
   \   0000004C   0070A0E1           MOV      R7,R0
    698                  pObj = TREEVIEW_LOCK_H(hObj);
   \   00000050   0500A0E1           MOV      R0,R5
   \   00000054   ........           BL       GUI_ALLOC_LockH
   \   00000058   0080A0E1           MOV      R8,R0
    699                  if (hItem) {
   \   0000005C   000057E3           CMP      R7,#+0
   \   00000060   5D00000A           BEQ      ??_OnTouch_3
    700                    int x0_Button, x1_Button;
    701                    pItem = (TREEVIEW_ITEM_OBJ *)GUI_LOCK_H(hItem);
   \   00000064   0700A0E1           MOV      R0,R7
   \   00000068   ........           BL       GUI_ALLOC_LockH
   \   0000006C   0090A0E1           MOV      R9,R0
   \   00000070   1C10D9E5           LDRB     R1,[R9, #+28]
   \   00000074   900098E5           LDR      R0,[R8, #+144]
    702                    x0_Button = (pItem->Level + 0) * pObj->Props.Indent;
    703                    x1_Button = x0_Button + pObj->Props.Indent - 1;
    704                    /*
    705                    * Check if +/- button has been pressed
    706                    */
    707                    if ((pState->x >= x0_Button) && (pState->x <= x1_Button) && (pItem->Flags & TREEVIEW_ITEM_TYPE_NODE)) {
   \   00000078   003096E5           LDR      R3,[R6, #+0]
   \   0000007C   900102E0           MUL      R2,R0,R1
   \   00000080   020053E1           CMP      R3,R2
   \   00000084   260000BA           BLT      ??_OnTouch_4
   \   00000088   022080E0           ADD      R2,R0,R2
   \   0000008C   012042E2           SUB      R2,R2,#+1
   \   00000090   030052E1           CMP      R2,R3
   \   00000094   220000BA           BLT      ??_OnTouch_4
   \   00000098   B841D9E1           LDRH     R4,[R9, #+24]
   \   0000009C   010014E3           TST      R4,#0x1
   \   000000A0   1F00000A           BEQ      ??_OnTouch_4
    708                      /*
    709                      * Open/close node when clicking on '+' or '-'
    710                      */
    711                      Flags = pItem->Flags;
    712                      GUI_UNLOCK_H(pItem);
   \   000000A4   ........           BL       GUI_ALLOC_UnlockH
    713                      GUI_UNLOCK_H(pObj);
   \   000000A8   ........           BL       GUI_ALLOC_UnlockH
    714                      if (Flags & TREEVIEW_ITEM_STATE_EXPANDED) {
   \   000000AC   020014E3           TST      R4,#0x2
   \   000000B0   0700A0E1           MOV      R0,R7
   \   000000B4   1200000A           BEQ      ??_OnTouch_5
    715                        _CollapseItem(hItem);
   \                     ??_OnTouch_6:
   \   000000B8   ........           BL       GUI_ALLOC_LockH
   \   000000BC   1810D0E5           LDRB     R1,[R0, #+24]
   \   000000C0   004090E5           LDR      R4,[R0, #+0]
   \   000000C4   031001E2           AND      R1,R1,#0x3
   \   000000C8   030051E3           CMP      R1,#+3
   \   000000CC   4200001A           BNE      ??_OnTouch_3
   \   000000D0   B811D0E1           LDRH     R1,[R0, #+24]
   \   000000D4   0210C1E3           BIC      R1,R1,#0x2
   \                     ??_OnTouch_7:
   \   000000D8   B811C0E1           STRH     R1,[R0, #+24]
   \   000000DC   ........           BL       GUI_ALLOC_UnlockH
   \   000000E0   000054E3           CMP      R4,#+0
   \   000000E4   3D00000A           BEQ      ??_OnTouch_2
   \   000000E8   0400A0E1           MOV      R0,R4
   \   000000EC   ........           BL       _CalcParams
   \   000000F0   0400A0E1           MOV      R0,R4
   \   000000F4   ........           BL       _ManageAutoScroll
   \   000000F8   0400A0E1           MOV      R0,R4
   \   000000FC   ........           BL       WM_InvalidateWindow
   \   00000100   360000EA           B        ??_OnTouch_2
    716                      } else {
    717                        _ExpandItem(hItem);
   \                     ??_OnTouch_5:
   \   00000104   ........           BL       GUI_ALLOC_LockH
   \   00000108   B811D0E1           LDRH     R1,[R0, #+24]
   \   0000010C   004090E5           LDR      R4,[R0, #+0]
   \   00000110   032001E2           AND      R2,R1,#0x3
   \   00000114   010052E3           CMP      R2,#+1
   \   00000118   2F00001A           BNE      ??_OnTouch_3
   \   0000011C   021081E3           ORR      R1,R1,#0x2
   \   00000120   ECFFFFEA           B        ??_OnTouch_7
    718                      }
    719                    } else {
    720                      int x0_Row, x1_Row;
    721                      if (pObj->Flags & TREEVIEW_CF_ROWSELECT) {
   \                     ??_OnTouch_4:
   \   00000124   9C20D8E5           LDRB     R2,[R8, #+156]
   \   00000128   020012E3           TST      R2,#0x2
   \   0000012C   0500000A           BEQ      ??_OnTouch_8
    722                        GUI_RECT Rect;
    723                        WM_GetInsideRectExScrollbar(hObj, &Rect);
   \   00000130   0D10A0E1           MOV      R1,SP
   \   00000134   0500A0E1           MOV      R0,R5
   \   00000138   ........           BL       WM_GetInsideRectExScrollbar
    724                        x0_Row = Rect.x0;
   \   0000013C   F040DDE1           LDRSH    R4,[SP, #+0]
    725                        x1_Row = Rect.x1;
   \   00000140   F400DDE1           LDRSH    R0,[SP, #+4]
   \   00000144   060000EA           B        ??_OnTouch_9
    726                      } else {
    727                        x0_Row = (pItem->Level + 1) * pObj->Props.Indent;
   \                     ??_OnTouch_8:
   \   00000148   011081E2           ADD      R1,R1,#+1
   \   0000014C   900104E0           MUL      R4,R0,R1
    728                        x1_Row = x0_Row + pObj->Props.TextIndent + GUI_GetStringDistX(pItem->acText);
   \   00000150   1D0089E2           ADD      R0,R9,#+29
   \   00000154   ........           BL       GUI_GetStringDistX
   \   00000158   941098E5           LDR      R1,[R8, #+148]
   \   0000015C   041081E0           ADD      R1,R1,R4
   \   00000160   010080E0           ADD      R0,R0,R1
    729                      }
    730                      if ((pState->x >= x0_Row) && (pState->x <= x1_Row)) {
   \                     ??_OnTouch_9:
   \   00000164   001096E5           LDR      R1,[R6, #+0]
   \   00000168   040051E1           CMP      R1,R4
   \   0000016C   010050A1           CMPGE    R0,R1
   \   00000170   180000BA           BLT      ??_OnTouch_10
    731                        if (pObj->hTimer) {
   \   00000174   AC0098E5           LDR      R0,[R8, #+172]
   \   00000178   000050E3           CMP      R0,#+0
   \   0000017C   0600000A           BEQ      ??_OnTouch_11
    732                          /*
    733                          * Double click
    734                          */
    735                          Flags = pItem->Flags;
   \   00000180   B841D9E1           LDRH     R4,[R9, #+24]
    736                          GUI_UNLOCK_H(pItem);
   \   00000184   ........           BL       GUI_ALLOC_UnlockH
    737                          GUI_UNLOCK_H(pObj);
   \   00000188   ........           BL       GUI_ALLOC_UnlockH
    738                          if (Flags & TREEVIEW_ITEM_STATE_EXPANDED) {
   \   0000018C   020014E3           TST      R4,#0x2
   \   00000190   0700A0E1           MOV      R0,R7
   \   00000194   DAFFFF0A           BEQ      ??_OnTouch_5
    739                            _CollapseItem(hItem);
   \   00000198   C6FFFFEA           B        ??_OnTouch_6
    740                          } else {
    741                            _ExpandItem(hItem);
    742                          }
    743                        } else {
    744                          /*
    745                          * Change selection when clicking on text or bitmap
    746                          */
    747                          pObj->hSel = hItem;
   \                     ??_OnTouch_11:
   \   0000019C   A87088E5           STR      R7,[R8, #+168]
    748                          WM_InvalidateWindow(hObj);
   \   000001A0   0500A0E1           MOV      R0,R5
   \   000001A4   ........           BL       WM_InvalidateWindow
    749                          /*
    750                          * Start timer to be able to manage doubleclick
    751                          */
    752                          GUI_UNLOCK_H(pItem);
   \   000001A8   ........           BL       GUI_ALLOC_UnlockH
    753                          GUI_UNLOCK_H(pObj);
   \   000001AC   ........           BL       GUI_ALLOC_UnlockH
    754                          hTimer = WM_CreateTimer(hObj, 0, 300, 0);
   \   000001B0   0030A0E3           MOV      R3,#+0
   \   000001B4   4B2FA0E3           MOV      R2,#+300
   \   000001B8   0010A0E3           MOV      R1,#+0
   \   000001BC   0500A0E1           MOV      R0,R5
   \   000001C0   ........           BL       WM_CreateTimer
   \   000001C4   0040A0E1           MOV      R4,R0
    755                          pObj = TREEVIEW_LOCK_H(hObj);
    756                          pObj->hTimer = hTimer;
   \   000001C8   0500A0E1           MOV      R0,R5
   \   000001CC   ........           BL       GUI_ALLOC_LockH
   \   000001D0   AC4080E5           STR      R4,[R0, #+172]
    757                          GUI_UNLOCK_H(pObj);
   \   000001D4   000000EA           B        ??_OnTouch_3
    758                        }
    759                      } else {
    760                        GUI_UNLOCK_H(pItem);
   \                     ??_OnTouch_10:
   \   000001D8   ........           BL       GUI_ALLOC_UnlockH
    761                        GUI_UNLOCK_H(pObj);
    762                      }
    763                    }
    764                  } else {
    765                    GUI_UNLOCK_H(pObj);
   \                     ??_OnTouch_3:
   \   000001DC   ........           BL       GUI_ALLOC_UnlockH
    766                  }
    767                }
    768                WM_NotifyParent(hObj, WM_NOTIFICATION_CLICKED);
   \                     ??_OnTouch_2:
   \   000001E0   0110A0E3           MOV      R1,#+1
   \                     ??_OnTouch_12:
   \   000001E4   0500A0E1           MOV      R0,R5
   \   000001E8   020000EA           B        ??_OnTouch_13
    769              } else {
    770                WM_NotifyParent(hObj, WM_NOTIFICATION_RELEASED);
   \                     ??_OnTouch_1:
   \   000001EC   0210A0E3           MOV      R1,#+2
   \   000001F0   FBFFFFEA           B        ??_OnTouch_12
    771              }
    772            } else {     /* Mouse moved out */
    773              WM_NotifyParent(hObj, WM_NOTIFICATION_MOVED_OUT);
   \                     ??_OnTouch_0:
   \   000001F4   0310A0E3           MOV      R1,#+3
   \                     ??_OnTouch_13:
   \   000001F8   ........           BL       WM_NotifyParent
    774            }
    775          }
   \   000001FC   0CD08DE2           ADD      SP,SP,#+12       ;; stack cleaning
   \   00000200   F083BDE8           POP      {R4-R9,PC}       ;; return
    776          
    777          /*********************************************************************
    778          *
    779          *       _OnOwnerdraw_GetXSize
    780          *
    781          * Purpose:
    782          *   Returns the xSize of the requested item
    783          */
    784          static int _OnOwnerdraw_GetXSize(const WIDGET_ITEM_DRAW_INFO * pDrawItemInfo) {
    785            TREEVIEW_ITEM_OBJ  * pItem;
    786            int xSize;
    787            pItem = (TREEVIEW_ITEM_OBJ *)GUI_LOCK_H(*(TREEVIEW_ITEM_Handle *)pDrawItemInfo->p);
    788            xSize = pItem->xSize;
    789            GUI_UNLOCK_H(pItem);
    790            return xSize;
    791          }
    792          
    793          /*********************************************************************
    794          *
    795          *       _OnOwnerdraw_GetYSize
    796          *
    797          * Purpose:
    798          *   Returns the ySize of the requested item
    799          */

   \                                 In section .text, align 4, keep-with-next
    800          static int _OnOwnerdraw_GetYSize(const WIDGET_ITEM_DRAW_INFO * pDrawItemInfo) {
   \                     _OnOwnerdraw_GetYSize:
   \   00000000   F0402DE9           PUSH     {R4-R7,LR}
   \   00000004   0050A0E1           MOV      R5,R0
   \   00000008   04D04DE2           SUB      SP,SP,#+4
    801            TREEVIEW_Handle      hObj;
    802            const TREEVIEW_OBJ * pObj;
    803            TREEVIEW_ITEM_OBJ  * pItem;
    804            int                  FontSizeY;
    805            int                  BitmapSizeY;
    806            int                  r;
    807            hObj = pDrawItemInfo->hWin;
    808            pObj = TREEVIEW_LOCK_H(hObj);
   \   0000000C   000095E5           LDR      R0,[R5, #+0]
   \   00000010   ........           BL       GUI_ALLOC_LockH
   \   00000014   0040A0E1           MOV      R4,R0
    809            pItem = (TREEVIEW_ITEM_OBJ *)GUI_LOCK_H(*(TREEVIEW_ITEM_Handle *)pDrawItemInfo->p);
   \   00000018   1C0095E5           LDR      R0,[R5, #+28]
   \   0000001C   000090E5           LDR      R0,[R0, #+0]
   \   00000020   ........           BL       GUI_ALLOC_LockH
   \   00000024   0070A0E1           MOV      R7,R0
    810            if (pItem->ySize) {
   \   00000028   B651D7E1           LDRH     R5,[R7, #+22]
   \   0000002C   000055E3           CMP      R5,#+0
   \   00000030   2500001A           BNE      ??_OnOwnerdraw_GetYSize_0
    811              r = pItem->ySize;
    812            } else {
    813          #if 1
    814              /*
    815              * This code does not work with IAR R32C V130a and speed high optimization.
    816              */
    817              int SizeY;
    818              FontSizeY   = pObj->Props.pFont->YSize;
   \   00000034   500094E5           LDR      R0,[R4, #+80]
   \   00000038   1850D0E5           LDRB     R5,[R0, #+24]
    819              BitmapSizeY = _GetItemBitmapSizeY(pObj, pItem);
   \   0000003C   100097E5           LDR      R0,[R7, #+16]
   \   00000040   000050E3           CMP      R0,#+0
   \   00000044   0300000A           BEQ      ??_OnOwnerdraw_GetYSize_1
   \   00000048   ........           BL       GUI_ALLOC_LockH
   \   0000004C   0060A0E1           MOV      R6,R0
   \   00000050   ........           BL       GUI_ALLOC_UnlockH
   \   00000054   000000EA           B        ??_OnOwnerdraw_GetYSize_2
   \                     ??_OnOwnerdraw_GetYSize_1:
   \   00000058   7C6084E2           ADD      R6,R4,#+124
   \                     ??_OnOwnerdraw_GetYSize_2:
   \   0000005C   B801D7E1           LDRH     R0,[R7, #+24]
   \   00000060   010010E3           TST      R0,#0x1
   \   00000064   0C00000A           BEQ      ??_OnOwnerdraw_GetYSize_3
   \   00000068   FF0000E2           AND      R0,R0,#0xFF
   \   0000006C   0120A0E3           MOV      R2,#+1
   \   00000070   A00002E0           AND      R0,R2,R0, LSR #+1
   \   00000074   030050E3           CMP      R0,#+3
   \   00000078   04005013           CMPNE    R0,#+4
   \   0000007C   00219617           LDRNE    R2,[R6, +R0, LSL #+2]
   \   00000080   0010A0E3           MOV      R1,#+0
   \   00000084   00005213           CMPNE    R2,#+0
   \   00000088   00018400           ADDEQ    R0,R4,R0, LSL #+2
   \   0000008C   7C009005           LDREQ    R0,[R0, #+124]
   \   00000090   0200A011           MOVNE    R0,R2
   \   00000094   B200D0E1           LDRH     R0,[R0, #+2]
   \   00000098   040000EA           B        ??_OnOwnerdraw_GetYSize_4
   \                     ??_OnOwnerdraw_GetYSize_3:
   \   0000009C   081096E5           LDR      R1,[R6, #+8]
   \   000000A0   0000A0E3           MOV      R0,#+0
   \   000000A4   000051E3           CMP      R1,#+0
   \   000000A8   84109405           LDREQ    R1,[R4, #+132]
   \   000000AC   B210D1E1           LDRH     R1,[R1, #+2]
   \                     ??_OnOwnerdraw_GetYSize_4:
   \   000000B0   000051E1           CMP      R1,R0
   \   000000B4   0010A0B1           MOVLT    R1,R0
    820              /*
    821              * The following two lines are completely ignored by the compiler (JE)
    822              */
    823              SizeY       = (BitmapSizeY > FontSizeY) ? BitmapSizeY : FontSizeY;
   \   000000B8   010055E1           CMP      R5,R1
    824              r           = (pObj->Props.MinItemHeight > SizeY) ? pObj->Props.MinItemHeight : SizeY;
   \   000000BC   980094E5           LDR      R0,[R4, #+152]
   \   000000C0   0150A0B1           MOVLT    R5,R1
   \   000000C4   000055E1           CMP      R5,R0
   \   000000C8   0050A0B1           MOVLT    R5,R0
    825          #else
    826              /*
    827              * This is less efficient but works
    828              */
    829              FontSizeY   = pObj->Props.pFont->YSize;
    830              BitmapSizeY = _GetItemBitmapSizeY(pObj, pItem);
    831              if        ((pObj->Props.MinItemHeight > BitmapSizeY) && (pObj->Props.MinItemHeight > FontSizeY)) {
    832                r = pObj->Props.MinItemHeight;
    833              } else if ((BitmapSizeY > pObj->Props.MinItemHeight) && (BitmapSizeY > FontSizeY)) {
    834                r = BitmapSizeY;
    835              } else if ((FontSizeY > pObj->Props.MinItemHeight) && (FontSizeY > BitmapSizeY)) {
    836                r = FontSizeY;
    837              }
    838          #endif
    839            }
    840            GUI_UNLOCK_H(pItem);
   \                     ??_OnOwnerdraw_GetYSize_0:
   \   000000CC   ........           BL       GUI_ALLOC_UnlockH
    841            GUI_UNLOCK_H(pObj);
   \   000000D0   ........           BL       GUI_ALLOC_UnlockH
    842            return r;
   \   000000D4   0500A0E1           MOV      R0,R5
   \   000000D8   04D08DE2           ADD      SP,SP,#+4
   \   000000DC   F080BDE8           POP      {R4-R7,PC}       ;; return
    843          }
    844          
    845          /*********************************************************************
    846          *
    847          *       _OnOwnerdraw_Paint
    848          *
    849          * Purpose:
    850          *   Draws the requested item
    851          */

   \                                 In section .text, align 4, keep-with-next
    852          static int _OnOwnerdraw_Paint(const WIDGET_ITEM_DRAW_INFO * pDrawItemInfo) {
   \                     _OnOwnerdraw_Paint:
   \   00000000   F0472DE9           PUSH     {R4-R10,LR}
   \   00000004   0040A0E1           MOV      R4,R0
    853            TREEVIEW_Handle      hObj;
    854            const TREEVIEW_OBJ * pObj;
    855            TREEVIEW_ITEM_Handle hItem;
    856            TREEVIEW_ITEM_OBJ  * pItem;
    857            const GUI_BITMAP GUI_UNI_PTR  ** apBm;
    858            const GUI_BITMAP GUI_UNI_PTR   * pBm;
    859            GUI_RECT rText, rFill;
    860            int xPos, xMid, yMid, xEnd;
    861            int xSizeBm, ySizeBm;
    862            int Index, Index0, Index1;
    863            int FontHeight;
    864            int HasChild;
    865            U16 Connectors;
    866            hObj       = pDrawItemInfo->hWin;
   \   00000008   008094E5           LDR      R8,[R4, #+0]
   \   0000000C   10D04DE2           SUB      SP,SP,#+16
    867            pObj       = TREEVIEW_LOCK_H(hObj);
   \   00000010   0800A0E1           MOV      R0,R8
   \   00000014   ........           BL       GUI_ALLOC_LockH
   \   00000018   0050A0E1           MOV      R5,R0
    868            hItem      = *(TREEVIEW_ITEM_Handle *)pDrawItemInfo->p;
   \   0000001C   1C0094E5           LDR      R0,[R4, #+28]
   \   00000020   009090E5           LDR      R9,[R0, #+0]
    869            pItem      = (TREEVIEW_ITEM_OBJ *)GUI_LOCK_H(hItem);
   \   00000024   0900A0E1           MOV      R0,R9
   \   00000028   ........           BL       GUI_ALLOC_LockH
   \   0000002C   0060A0E1           MOV      R6,R0
    870            /*
    871            * Draw background on left side
    872            */
    873            if (pObj->Flags & TREEVIEW_CF_ROWSELECT) {
   \   00000030   9C00D5E5           LDRB     R0,[R5, #+156]
   \   00000034   020010E3           TST      R0,#0x2
   \   00000038   2100000A           BEQ      ??_OnOwnerdraw_Paint_0
    874              if (WM__IsEnabled(hObj)) {
   \   0000003C   0800A0E1           MOV      R0,R8
   \   00000040   ........           BL       WM__IsEnabled
   \   00000044   000050E3           CMP      R0,#+0
   \   00000048   0800000A           BEQ      ??_OnOwnerdraw_Paint_1
    875                if (pObj->Flags & TREEVIEW_CF_ROWSELECT) {
   \   0000004C   9C00D5E5           LDRB     R0,[R5, #+156]
   \   00000050   020010E3           TST      R0,#0x2
   \   00000054   0300000A           BEQ      ??_OnOwnerdraw_Paint_2
    876                  if (pObj->hSel == hItem) {
   \   00000058   A80095E5           LDR      R0,[R5, #+168]
   \   0000005C   090050E1           CMP      R0,R9
    877                    Index = TREEVIEW_CI_SEL;
   \   00000060   0100A003           MOVEQ    R0,#+1
   \   00000064   0200000A           BEQ      ??_OnOwnerdraw_Paint_3
    878                  } else {
    879                    Index = TREEVIEW_CI_UNSEL;
   \                     ??_OnOwnerdraw_Paint_2:
   \   00000068   0000A0E3           MOV      R0,#+0
   \   0000006C   000000EA           B        ??_OnOwnerdraw_Paint_3
    880                  }
    881                } else {
    882                  Index = TREEVIEW_CI_UNSEL;
    883                }
    884              } else {
    885                Index = TREEVIEW_CI_DISABLED;
   \                     ??_OnOwnerdraw_Paint_1:
   \   00000070   0200A0E3           MOV      R0,#+2
    886              }
    887              rFill.x0   = pDrawItemInfo->x0;
   \                     ??_OnOwnerdraw_Paint_3:
   \   00000074   0C1094E5           LDR      R1,[R4, #+12]
    888              rFill.y0   = pDrawItemInfo->y0;
    889              rFill.x1   = pDrawItemInfo->x0 + (pItem->Level + 1) * pObj->Props.Indent + pObj->Props.TextIndent - 1;
    890              rFill.y1   = pDrawItemInfo->y1;
    891              GUI_SetColor(pObj->Props.aBkColor[Index]);
   \   00000078   000185E0           ADD      R0,R5,R0, LSL #+2
   \   0000007C   B010CDE1           STRH     R1,[SP, #+0]
   \   00000080   101094E5           LDR      R1,[R4, #+16]
   \   00000084   B210CDE1           STRH     R1,[SP, #+2]
   \   00000088   1C20D6E5           LDRB     R2,[R6, #+28]
   \   0000008C   0C1094E5           LDR      R1,[R4, #+12]
   \   00000090   903095E5           LDR      R3,[R5, #+144]
   \   00000094   012082E2           ADD      R2,R2,#+1
   \   00000098   821301E1           SMLABB   R1,R2,R3,R1
   \   0000009C   942095E5           LDR      R2,[R5, #+148]
   \   000000A0   011082E0           ADD      R1,R2,R1
   \   000000A4   011041E2           SUB      R1,R1,#+1
   \   000000A8   B410CDE1           STRH     R1,[SP, #+4]
   \   000000AC   181094E5           LDR      R1,[R4, #+24]
   \   000000B0   B610CDE1           STRH     R1,[SP, #+6]
   \   000000B4   540090E5           LDR      R0,[R0, #+84]
   \   000000B8   ........           BL       GUI_SetColor
    892              GUI_FillRectEx(&rFill);
   \   000000BC   0D00A0E1           MOV      R0,SP
   \   000000C0   ........           BL       GUI_FillRectEx
    893            }
    894            /*
    895            * Draw item text
    896            */
    897            if (WM__IsEnabled(hObj)) {
   \                     ??_OnOwnerdraw_Paint_0:
   \   000000C4   0800A0E1           MOV      R0,R8
   \   000000C8   ........           BL       WM__IsEnabled
   \   000000CC   000050E3           CMP      R0,#+0
   \   000000D0   0400000A           BEQ      ??_OnOwnerdraw_Paint_4
    898              if (pObj->hSel == hItem) {
   \   000000D4   A80095E5           LDR      R0,[R5, #+168]
   \   000000D8   090050E1           CMP      R0,R9
    899                Index = TREEVIEW_CI_SEL;
   \   000000DC   0170A003           MOVEQ    R7,#+1
   \   000000E0   0070A013           MOVNE    R7,#+0
   \   000000E4   000000EA           B        ??_OnOwnerdraw_Paint_5
    900              } else {
    901                Index = TREEVIEW_CI_UNSEL;
    902              }
    903            } else {
    904              Index = TREEVIEW_CI_DISABLED;
   \                     ??_OnOwnerdraw_Paint_4:
   \   000000E8   0270A0E3           MOV      R7,#+2
    905            }
    906            GUI_SetFont(pObj->Props.pFont);
   \                     ??_OnOwnerdraw_Paint_5:
   \   000000EC   500095E5           LDR      R0,[R5, #+80]
   \   000000F0   ........           BL       GUI_SetFont
    907            FontHeight = GUI_GetFontSizeY();
   \   000000F4   ........           BL       GUI_GetFontSizeY
    908            if (pObj->Flags & TREEVIEW_CF_ROWSELECT) {
   \   000000F8   9C10D5E5           LDRB     R1,[R5, #+156]
   \   000000FC   00A0A0E1           MOV      R10,R0
   \   00000100   0C0094E5           LDR      R0,[R4, #+12]
   \   00000104   020011E3           TST      R1,#0x2
   \   00000108   0500000A           BEQ      ??_OnOwnerdraw_Paint_6
    909              rFill.x0   = pDrawItemInfo->x0 + (pItem->Level + 1) * pObj->Props.Indent + pObj->Props.TextIndent;
   \   0000010C   1C10D6E5           LDRB     R1,[R6, #+28]
   \   00000110   902095E5           LDR      R2,[R5, #+144]
   \   00000114   011081E2           ADD      R1,R1,#+1
   \   00000118   810200E1           SMLABB   R0,R1,R2,R0
   \   0000011C   941095E5           LDR      R1,[R5, #+148]
   \   00000120   000081E0           ADD      R0,R1,R0
    910            } else {
    911              rFill.x0   = pDrawItemInfo->x0;
   \                     ??_OnOwnerdraw_Paint_6:
   \   00000124   B000CDE1           STRH     R0,[SP, #+0]
    912            }
    913            rFill.y0   = pDrawItemInfo->y0;
   \   00000128   100094E5           LDR      R0,[R4, #+16]
   \   0000012C   B200CDE1           STRH     R0,[SP, #+2]
    914            rFill.x1   = pDrawItemInfo->x1;
   \   00000130   140094E5           LDR      R0,[R4, #+20]
   \   00000134   B400CDE1           STRH     R0,[SP, #+4]
    915            rFill.y1   = pDrawItemInfo->y1;
   \   00000138   180094E5           LDR      R0,[R4, #+24]
   \   0000013C   B600CDE1           STRH     R0,[SP, #+6]
    916            rText.x0   = pDrawItemInfo->x0 + (pItem->Level + 1) * pObj->Props.Indent + pObj->Props.TextIndent;
   \   00000140   1C10D6E5           LDRB     R1,[R6, #+28]
   \   00000144   0C0094E5           LDR      R0,[R4, #+12]
   \   00000148   902095E5           LDR      R2,[R5, #+144]
   \   0000014C   011081E2           ADD      R1,R1,#+1
   \   00000150   810200E1           SMLABB   R0,R1,R2,R0
   \   00000154   941095E5           LDR      R1,[R5, #+148]
   \   00000158   000081E0           ADD      R0,R1,R0
   \   0000015C   B800CDE1           STRH     R0,[SP, #+8]
    917            rText.x1   = rText.x0 + GUI_GetStringDistX(pItem->acText) - 1;
   \   00000160   1D0086E2           ADD      R0,R6,#+29
   \   00000164   ........           BL       GUI_GetStringDistX
   \   00000168   F810DDE1           LDRSH    R1,[SP, #+8]
    918            rText.y0   = pDrawItemInfo->y0 + (pDrawItemInfo->y1 - pDrawItemInfo->y0 + 1 - FontHeight) / 2;
    919            rText.y1   = rText.y0 + FontHeight - 1;
    920            GUI_SetColor(pObj->Props.aTextColor[Index]);
   \   0000016C   077185E0           ADD      R7,R5,R7, LSL #+2
   \   00000170   010080E0           ADD      R0,R0,R1
   \   00000174   010040E2           SUB      R0,R0,#+1
   \   00000178   BC00CDE1           STRH     R0,[SP, #+12]
   \   0000017C   100094E5           LDR      R0,[R4, #+16]
   \   00000180   181094E5           LDR      R1,[R4, #+24]
   \   00000184   001041E0           SUB      R1,R1,R0
   \   00000188   011081E2           ADD      R1,R1,#+1
   \   0000018C   0A1041E0           SUB      R1,R1,R10
   \   00000190   A11F81E0           ADD      R1,R1,R1, LSR #+31
   \   00000194   C10080E0           ADD      R0,R0,R1, ASR #+1
   \   00000198   BA00CDE1           STRH     R0,[SP, #+10]
   \   0000019C   00008AE0           ADD      R0,R10,R0
   \   000001A0   010040E2           SUB      R0,R0,#+1
   \   000001A4   BE00CDE1           STRH     R0,[SP, #+14]
   \   000001A8   600097E5           LDR      R0,[R7, #+96]
   \   000001AC   ........           BL       GUI_SetColor
    921            GUI_SetBkColor(pObj->Props.aBkColor[Index]);
   \   000001B0   540097E5           LDR      R0,[R7, #+84]
   \   000001B4   ........           BL       GUI_SetBkColor
    922            GUI_DispStringInRect(pItem->acText, &rText, 0);
   \   000001B8   0020A0E3           MOV      R2,#+0
   \   000001BC   08108DE2           ADD      R1,SP,#+8
   \   000001C0   1D0086E2           ADD      R0,R6,#+29
   \   000001C4   ........           BL       GUI_DispStringInRect
    923            /*
    924            * Draw background
    925            */
    926            if (WM__IsEnabled(hObj)) {
   \   000001C8   0800A0E1           MOV      R0,R8
   \   000001CC   ........           BL       WM__IsEnabled
   \   000001D0   000050E3           CMP      R0,#+0
   \   000001D4   0800000A           BEQ      ??_OnOwnerdraw_Paint_7
    927              if (pObj->Flags & TREEVIEW_CF_ROWSELECT) {
   \   000001D8   9C00D5E5           LDRB     R0,[R5, #+156]
   \   000001DC   020010E3           TST      R0,#0x2
   \   000001E0   0300000A           BEQ      ??_OnOwnerdraw_Paint_8
    928                if (pObj->hSel == hItem) {
   \   000001E4   A80095E5           LDR      R0,[R5, #+168]
   \   000001E8   090050E1           CMP      R0,R9
    929                  Index = TREEVIEW_CI_SEL;
   \   000001EC   0100A003           MOVEQ    R0,#+1
   \   000001F0   0200000A           BEQ      ??_OnOwnerdraw_Paint_9
    930                } else {
    931                  Index = TREEVIEW_CI_UNSEL;
   \                     ??_OnOwnerdraw_Paint_8:
   \   000001F4   0000A0E3           MOV      R0,#+0
   \   000001F8   000000EA           B        ??_OnOwnerdraw_Paint_9
    932                }
    933              } else {
    934                Index = TREEVIEW_CI_UNSEL;
    935              }
    936            } else {
    937              Index = TREEVIEW_CI_DISABLED;
   \                     ??_OnOwnerdraw_Paint_7:
   \   000001FC   0200A0E3           MOV      R0,#+2
    938            }
    939            GUI_SetBkColor(pObj->Props.aBkColor[Index]);
   \                     ??_OnOwnerdraw_Paint_9:
   \   00000200   000185E0           ADD      R0,R5,R0, LSL #+2
   \   00000204   540090E5           LDR      R0,[R0, #+84]
   \   00000208   ........           BL       GUI_SetBkColor
    940            GUI_ClearRect(rFill.x0,      rFill.y0,      rFill.x1,      rText.y0 - 1); /* Top */
   \   0000020C   FA00DDE1           LDRSH    R0,[SP, #+10]
   \   00000210   F420DDE1           LDRSH    R2,[SP, #+4]
   \   00000214   F210DDE1           LDRSH    R1,[SP, #+2]
   \   00000218   013040E2           SUB      R3,R0,#+1
   \   0000021C   F000DDE1           LDRSH    R0,[SP, #+0]
   \   00000220   ........           BL       GUI_ClearRect
    941            GUI_ClearRect(rFill.x0,      rText.y0,      rText.x0 - 1 , rText.y1);     /* Left */
   \   00000224   F800DDE1           LDRSH    R0,[SP, #+8]
   \   00000228   FE30DDE1           LDRSH    R3,[SP, #+14]
   \   0000022C   FA10DDE1           LDRSH    R1,[SP, #+10]
   \   00000230   012040E2           SUB      R2,R0,#+1
   \   00000234   F000DDE1           LDRSH    R0,[SP, #+0]
   \   00000238   ........           BL       GUI_ClearRect
    942            GUI_ClearRect(rText.x1 + 1,  rText.y0,      rFill.x1,      rText.y1);     /* Right */
   \   0000023C   FC00DDE1           LDRSH    R0,[SP, #+12]
   \   00000240   FE30DDE1           LDRSH    R3,[SP, #+14]
   \   00000244   F420DDE1           LDRSH    R2,[SP, #+4]
   \   00000248   FA10DDE1           LDRSH    R1,[SP, #+10]
   \   0000024C   010080E2           ADD      R0,R0,#+1
   \   00000250   ........           BL       GUI_ClearRect
    943            GUI_ClearRect(rFill.x0,      rText.y1 + 1,  rFill.x1,      rFill.y1);     /* Bottom */
   \   00000254   FE00DDE1           LDRSH    R0,[SP, #+14]
   \   00000258   F630DDE1           LDRSH    R3,[SP, #+6]
   \   0000025C   F420DDE1           LDRSH    R2,[SP, #+4]
   \   00000260   011080E2           ADD      R1,R0,#+1
   \   00000264   F000DDE1           LDRSH    R0,[SP, #+0]
   \   00000268   ........           BL       GUI_ClearRect
    944            /*
    945            * Check if item has childs
    946            */
    947            HasChild = 0;
    948            if (pItem->Flags & TREEVIEW_ITEM_TYPE_NODE) {
   \   0000026C   1800D6E5           LDRB     R0,[R6, #+24]
   \   00000270   0070A0E3           MOV      R7,#+0
   \   00000274   010010E3           TST      R0,#0x1
    949              if (pItem->hNext) {
   \   00000278   04009615           LDRNE    R0,[R6, #+4]
   \   0000027C   00005013           CMPNE    R0,#+0
   \   00000280   0500000A           BEQ      ??_OnOwnerdraw_Paint_10
    950                TREEVIEW_ITEM_OBJ  * pNext;
    951                pNext = (TREEVIEW_ITEM_OBJ *)GUI_LOCK_H(pItem->hNext);
   \   00000284   ........           BL       GUI_ALLOC_LockH
    952                if (pNext->Level > pItem->Level) {
   \   00000288   1C10D6E5           LDRB     R1,[R6, #+28]
   \   0000028C   1C00D0E5           LDRB     R0,[R0, #+28]
   \   00000290   000051E1           CMP      R1,R0
    953                  HasChild = 1;
   \   00000294   0170A033           MOVCC    R7,#+1
    954                }
    955                GUI_UNLOCK_H(pNext);
   \   00000298   ........           BL       GUI_ALLOC_UnlockH
    956              }
    957            }
    958            /*
    959            * Draw lines
    960            */
    961            if ((pObj->Flags & TREEVIEW_CF_HIDELINES) == 0) {
   \                     ??_OnOwnerdraw_Paint_10:
   \   0000029C   9C00D5E5           LDRB     R0,[R5, #+156]
   \   000002A0   010010E3           TST      R0,#0x1
   \   000002A4   5C00001A           BNE      ??_OnOwnerdraw_Paint_11
    962              if (WM__IsEnabled(hObj)) {
   \   000002A8   0800A0E1           MOV      R0,R8
   \   000002AC   ........           BL       WM__IsEnabled
   \   000002B0   000050E3           CMP      R0,#+0
   \   000002B4   0800000A           BEQ      ??_OnOwnerdraw_Paint_12
    963                if (pObj->Flags & TREEVIEW_CF_ROWSELECT) {
   \   000002B8   9C00D5E5           LDRB     R0,[R5, #+156]
   \   000002BC   020010E3           TST      R0,#0x2
   \   000002C0   0300000A           BEQ      ??_OnOwnerdraw_Paint_13
    964                  if (pObj->hSel == hItem) {
   \   000002C4   A80095E5           LDR      R0,[R5, #+168]
   \   000002C8   090050E1           CMP      R0,R9
    965                    Index = TREEVIEW_CI_SEL;
   \   000002CC   0100A003           MOVEQ    R0,#+1
   \   000002D0   0200000A           BEQ      ??_OnOwnerdraw_Paint_14
    966                  } else {
    967                    Index = TREEVIEW_CI_UNSEL;
   \                     ??_OnOwnerdraw_Paint_13:
   \   000002D4   0000A0E3           MOV      R0,#+0
   \   000002D8   000000EA           B        ??_OnOwnerdraw_Paint_14
    968                  }
    969                } else {
    970                  Index = TREEVIEW_CI_UNSEL;
    971                }
    972              } else {
    973                Index = TREEVIEW_CI_DISABLED;
   \                     ??_OnOwnerdraw_Paint_12:
   \   000002DC   0200A0E3           MOV      R0,#+2
    974              }
    975              GUI_SetColor(pObj->Props.aLineColor[Index]);
   \                     ??_OnOwnerdraw_Paint_14:
   \   000002E0   000185E0           ADD      R0,R5,R0, LSL #+2
   \   000002E4   6C0090E5           LDR      R0,[R0, #+108]
   \   000002E8   ........           BL       GUI_SetColor
    976              xEnd = pDrawItemInfo->x0 + pItem->Level * pObj->Props.Indent - 1;
   \   000002EC   1C00D6E5           LDRB     R0,[R6, #+28]
   \   000002F0   903095E5           LDR      R3,[R5, #+144]
   \   000002F4   0C1094E5           LDR      R1,[R4, #+12]
   \   000002F8   931021E0           MLA      R1,R3,R0,R1
    977              xMid = xEnd - pObj->Props.Indent / 2;
    978              yMid = (pDrawItemInfo->y1 + pDrawItemInfo->y0) / 2;
   \   000002FC   182094E5           LDR      R2,[R4, #+24]
   \   00000300   018041E2           SUB      R8,R1,#+1
   \   00000304   A31F83E0           ADD      R1,R3,R3, LSR #+31
   \   00000308   C19048E0           SUB      R9,R8,R1, ASR #+1
   \   0000030C   101094E5           LDR      R1,[R4, #+16]
    979              if (pItem->Level >= 1) {
   \   00000310   000050E3           CMP      R0,#+0
   \   00000314   023081E0           ADD      R3,R1,R2
   \   00000318   A33F83E0           ADD      R3,R3,R3, LSR #+31
   \   0000031C   C3A0A0E1           ASR      R10,R3,#+1
   \   00000320   B831D6E1           LDRH     R3,[R6, #+24]
   \   00000324   3200000A           BEQ      ??_OnOwnerdraw_Paint_15
    980                /* Draw vertical line */
    981                if (pItem->Flags & TREEVIEW_ITEM_STATE_ISLAST) {
   \   00000328   040013E3           TST      R3,#0x4
    982                  GUI_DrawVLine(xMid, pDrawItemInfo->y0, yMid);
   \   0000032C   0A20A011           MOVNE    R2,R10
    983                } else {
    984                  GUI_DrawVLine(xMid, pDrawItemInfo->y0, pDrawItemInfo->y1);
   \   00000330   0900A0E1           MOV      R0,R9
   \   00000334   ........           BL       GUI_DrawVLine
    985                }
    986                if (pItem->Flags & TREEVIEW_ITEM_TYPE_NODE) {
   \   00000338   B801D6E1           LDRH     R0,[R6, #+24]
   \   0000033C   010010E3           TST      R0,#0x1
   \   00000340   0E00000A           BEQ      ??_OnOwnerdraw_Paint_16
    987                  xEnd += pObj->Props.Indent / 2;
   \   00000344   901095E5           LDR      R1,[R5, #+144]
    988                  if (HasChild) {
   \   00000348   000057E3           CMP      R7,#+0
   \   0000034C   A11F81E0           ADD      R1,R1,R1, LSR #+31
   \   00000350   C18088E0           ADD      R8,R8,R1, ASR #+1
   \   00000354   0600000A           BEQ      ??_OnOwnerdraw_Paint_17
    989                    if ((pItem->Flags & TREEVIEW_ITEM_STATE_EXPANDED) && HasChild) {
   \   00000358   020010E3           TST      R0,#0x2
   \   0000035C   0C00000A           BEQ      ??_OnOwnerdraw_Paint_18
    990                      GUI_DrawVLine(xEnd, yMid, pDrawItemInfo->y1);
   \   00000360   182094E5           LDR      R2,[R4, #+24]
   \   00000364   0A10A0E1           MOV      R1,R10
   \   00000368   0800A0E1           MOV      R0,R8
   \   0000036C   ........           BL       GUI_DrawVLine
   \   00000370   070000EA           B        ??_OnOwnerdraw_Paint_18
    991                    }
    992                  } else {
    993                    xEnd += pObj->Props.Indent / 2;
   \                     ??_OnOwnerdraw_Paint_17:
   \   00000374   900095E5           LDR      R0,[R5, #+144]
   \   00000378   A00F80E0           ADD      R0,R0,R0, LSR #+31
   \   0000037C   030000EA           B        ??_OnOwnerdraw_Paint_19
    994                  }
    995                } else {
    996                  xEnd += (pObj->Props.Indent + pObj->Props.Indent + pObj->Props.Indent) >> 1; /* Avoid multiplication */
   \                     ??_OnOwnerdraw_Paint_16:
   \   00000380   900095E5           LDR      R0,[R5, #+144]
   \   00000384   0010A0E1           MOV      R1,R0
   \   00000388   000081E0           ADD      R0,R1,R0
   \   0000038C   000081E0           ADD      R0,R1,R0
   \                     ??_OnOwnerdraw_Paint_19:
   \   00000390   C08088E0           ADD      R8,R8,R0, ASR #+1
    997                }
    998                /* Draw vertical line */
    999                GUI_DrawHLine(yMid, xMid, xEnd);
   \                     ??_OnOwnerdraw_Paint_18:
   \   00000394   0820A0E1           MOV      R2,R8
   \   00000398   0910A0E1           MOV      R1,R9
   \   0000039C   0A00A0E1           MOV      R0,R10
   \   000003A0   ........           BL       GUI_DrawHLine
   1000                /* Vertical connectors */
   1001                Connectors = pItem->Connectors;
   1002                xMid = pDrawItemInfo->x0 + pObj->Props.Indent / 2 - 1;
   \   000003A4   900095E5           LDR      R0,[R5, #+144]
   \   000003A8   BA81D6E1           LDRH     R8,[R6, #+26]
   \   000003AC   0C1094E5           LDR      R1,[R4, #+12]
   \   000003B0   A00F80E0           ADD      R0,R0,R0, LSR #+31
   \   000003B4   C00081E0           ADD      R0,R1,R0, ASR #+1
   \   000003B8   019040E2           SUB      R9,R0,#+1
   1003                while (Connectors) {
   \   000003BC   000058E3           CMP      R8,#+0
   \   000003C0   1500000A           BEQ      ??_OnOwnerdraw_Paint_11
   1004                  if (Connectors & 1) {
   \                     ??_OnOwnerdraw_Paint_20:
   \   000003C4   010018E3           TST      R8,#0x1
   \   000003C8   0300000A           BEQ      ??_OnOwnerdraw_Paint_21
   1005                    GUI_DrawVLine(xMid, pDrawItemInfo->y0, pDrawItemInfo->y1);
   \   000003CC   182094E5           LDR      R2,[R4, #+24]
   \   000003D0   101094E5           LDR      R1,[R4, #+16]
   \   000003D4   0900A0E1           MOV      R0,R9
   \   000003D8   ........           BL       GUI_DrawVLine
   1006                  }
   1007                  Connectors >>= 1;
   1008                  xMid += pObj->Props.Indent;
   \                     ??_OnOwnerdraw_Paint_21:
   \   000003DC   900095E5           LDR      R0,[R5, #+144]
   \   000003E0   A880A0E1           LSR      R8,R8,#+1
   \   000003E4   099080E0           ADD      R9,R0,R9
   \   000003E8   000058E3           CMP      R8,#+0
   \   000003EC   F4FFFF1A           BNE      ??_OnOwnerdraw_Paint_20
   \   000003F0   090000EA           B        ??_OnOwnerdraw_Paint_11
   1009                }
   1010              } else {
   1011                if (pItem->Flags & TREEVIEW_ITEM_TYPE_NODE) {
   \                     ??_OnOwnerdraw_Paint_15:
   \   000003F4   010013E3           TST      R3,#0x1
   \   000003F8   0700000A           BEQ      ??_OnOwnerdraw_Paint_11
   1012                  xEnd += pObj->Props.Indent / 2;
   \   000003FC   900095E5           LDR      R0,[R5, #+144]
   1013                  if ((pItem->Flags & TREEVIEW_ITEM_STATE_EXPANDED) && HasChild) {
   \   00000400   020013E3           TST      R3,#0x2
   \   00000404   A00F80E0           ADD      R0,R0,R0, LSR #+31
   \   00000408   C00088E0           ADD      R0,R8,R0, ASR #+1
   \   0000040C   00005713           CMPNE    R7,#+0
   \   00000410   0100000A           BEQ      ??_OnOwnerdraw_Paint_11
   1014                    GUI_DrawVLine(xEnd, yMid, pDrawItemInfo->y1);
   \   00000414   0A10A0E1           MOV      R1,R10
   \   00000418   ........           BL       GUI_DrawVLine
   1015                  }
   1016                }
   1017              }
   1018            }
   1019            /*
   1020            * Draw bitmaps
   1021            */
   1022            xPos = pDrawItemInfo->x0 + pItem->Level * pObj->Props.Indent - 1;
   \                     ??_OnOwnerdraw_Paint_11:
   \   0000041C   1C10D6E5           LDRB     R1,[R6, #+28]
   \   00000420   902095E5           LDR      R2,[R5, #+144]
   \   00000424   0C0094E5           LDR      R0,[R4, #+12]
   \   00000428   920120E0           MLA      R0,R2,R1,R0
   \   0000042C   018040E2           SUB      R8,R0,#+1
   1023            apBm  = _GetBitmapPointer(pObj, pItem);
   \   00000430   100096E5           LDR      R0,[R6, #+16]
   \   00000434   000050E3           CMP      R0,#+0
   \   00000438   0300000A           BEQ      ??_OnOwnerdraw_Paint_22
   \   0000043C   ........           BL       GUI_ALLOC_LockH
   \   00000440   0090A0E1           MOV      R9,R0
   \   00000444   ........           BL       GUI_ALLOC_UnlockH
   \   00000448   000000EA           B        ??_OnOwnerdraw_Paint_23
   \                     ??_OnOwnerdraw_Paint_22:
   \   0000044C   7C9085E2           ADD      R9,R5,#+124
   1024            if (pItem->Flags & TREEVIEW_ITEM_TYPE_NODE) {
   \                     ??_OnOwnerdraw_Paint_23:
   \   00000450   B801D6E1           LDRH     R0,[R6, #+24]
   \   00000454   010010E3           TST      R0,#0x1
   \   00000458   1D00000A           BEQ      ??_OnOwnerdraw_Paint_24
   1025              if ((pItem->Flags & TREEVIEW_ITEM_STATE_EXPANDED) && HasChild) {
   \   0000045C   020010E3           TST      R0,#0x2
   \   00000460   00005713           CMPNE    R7,#+0
   1026                Index0 = TREEVIEW_BI_MINUS;
   \   00000464   0400A013           MOVNE    R0,#+4
   1027                Index1 = TREEVIEW_BI_OPEN;
   \   00000468   0160A013           MOVNE    R6,#+1
   \   0000046C   0300001A           BNE      ??_OnOwnerdraw_Paint_25
   1028              } else {
   1029                Index0 = TREEVIEW_BI_PLUS;
   \   00000470   0300A0E3           MOV      R0,#+3
   1030                Index1 = TREEVIEW_BI_CLOSED;
   \   00000474   0060A0E3           MOV      R6,#+0
   1031              }
   1032              /*
   1033              * Plus/minus bitmap
   1034              */
   1035              if (HasChild) {
   \   00000478   000057E3           CMP      R7,#+0
   \   0000047C   0E00000A           BEQ      ??_OnOwnerdraw_Paint_26
   \                     ??_OnOwnerdraw_Paint_25:
   \   00000480   000185E0           ADD      R0,R5,R0, LSL #+2
   \   00000484   7C0090E5           LDR      R0,[R0, #+124]
   1036                pBm = _GetBitmap(pObj, apBm, Index0);
   1037                xSizeBm = pBm->XSize;
   1038                ySizeBm = pBm->YSize;
   1039                GUI_DrawBitmap(pBm,
   1040                               xPos + (pObj->Props.Indent - xSizeBm) / 2,
   1041                               pDrawItemInfo->y0 + ((pDrawItemInfo->y1 - pDrawItemInfo->y0) - ySizeBm) / 2);
   \   00000488   101094E5           LDR      R1,[R4, #+16]
   \   0000048C   182094E5           LDR      R2,[R4, #+24]
   \   00000490   B230D0E1           LDRH     R3,[R0, #+2]
   \   00000494   012042E0           SUB      R2,R2,R1
   \   00000498   B0C0D0E1           LDRH     R12,[R0, #+0]
   \   0000049C   032042E0           SUB      R2,R2,R3
   \   000004A0   903095E5           LDR      R3,[R5, #+144]
   \   000004A4   A22F82E0           ADD      R2,R2,R2, LSR #+31
   \   000004A8   0C3043E0           SUB      R3,R3,R12
   \   000004AC   C22081E0           ADD      R2,R1,R2, ASR #+1
   \   000004B0   A31F83E0           ADD      R1,R3,R3, LSR #+31
   \   000004B4   C11088E0           ADD      R1,R8,R1, ASR #+1
   \   000004B8   ........           BL       GUI_DrawBitmap
   \                     ??_OnOwnerdraw_Paint_26:
   \   000004BC   060199E7           LDR      R0,[R9, +R6, LSL #+2]
   \   000004C0   000050E3           CMP      R0,#+0
   \   000004C4   0500001A           BNE      ??_OnOwnerdraw_Paint_27
   \   000004C8   060185E0           ADD      R0,R5,R6, LSL #+2
   \   000004CC   7C0090E5           LDR      R0,[R0, #+124]
   1042              }
   1043              /*
   1044              * Node bitmap
   1045              */
   1046              pBm = _GetBitmap(pObj, apBm, Index1);
   1047              xSizeBm = pBm->XSize;
   1048              ySizeBm = pBm->YSize;
   1049              GUI_DrawBitmap(pBm,
   1050                             xPos + pObj->Props.Indent + (pObj->Props.Indent - xSizeBm) / 2,
   1051                             pDrawItemInfo->y0 + ((pDrawItemInfo->y1 - pDrawItemInfo->y0) - ySizeBm) / 2);
   \   000004D0   020000EA           B        ??_OnOwnerdraw_Paint_27
   1052            } else {
   1053              /*
   1054              * Leaf bitmap
   1055              */
   1056              pBm = _GetBitmap(pObj, apBm, TREEVIEW_BI_LEAF);
   \                     ??_OnOwnerdraw_Paint_24:
   \   000004D4   080099E5           LDR      R0,[R9, #+8]
   \   000004D8   000050E3           CMP      R0,#+0
   \   000004DC   84009505           LDREQ    R0,[R5, #+132]
   1057              xSizeBm = pBm->XSize;
   1058              ySizeBm = pBm->YSize;
   1059              GUI_DrawBitmap(pBm,
   1060                             xPos + pObj->Props.Indent + (pObj->Props.Indent - xSizeBm) / 2,
   1061                             pDrawItemInfo->y0 + ((pDrawItemInfo->y1 - pDrawItemInfo->y0) - ySizeBm) / 2);
   \                     ??_OnOwnerdraw_Paint_27:
   \   000004E0   101094E5           LDR      R1,[R4, #+16]
   \   000004E4   182094E5           LDR      R2,[R4, #+24]
   \   000004E8   B230D0E1           LDRH     R3,[R0, #+2]
   \   000004EC   012042E0           SUB      R2,R2,R1
   \   000004F0   B0C0D0E1           LDRH     R12,[R0, #+0]
   \   000004F4   032042E0           SUB      R2,R2,R3
   \   000004F8   A22F82E0           ADD      R2,R2,R2, LSR #+31
   \   000004FC   903095E5           LDR      R3,[R5, #+144]
   \   00000500   C22081E0           ADD      R2,R1,R2, ASR #+1
   \   00000504   901095E5           LDR      R1,[R5, #+144]
   \   00000508   0C3043E0           SUB      R3,R3,R12
   \   0000050C   081081E0           ADD      R1,R1,R8
   \   00000510   A33F83E0           ADD      R3,R3,R3, LSR #+31
   \   00000514   C31081E0           ADD      R1,R1,R3, ASR #+1
   \   00000518   ........           BL       GUI_DrawBitmap
   1062            }
   1063            GUI_UNLOCK_H(pObj);
   \   0000051C   ........           BL       GUI_ALLOC_UnlockH
   1064            GUI_UNLOCK_H(pItem);
   \   00000520   ........           BL       GUI_ALLOC_UnlockH
   1065            return 0;
   \   00000524   0000A0E3           MOV      R0,#+0
   \   00000528   10D08DE2           ADD      SP,SP,#+16
   \   0000052C   F087BDE8           POP      {R4-R10,PC}      ;; return
   1066          }
   1067          
   1068          /*********************************************************************
   1069          *
   1070          *       _IncSel
   1071          * Purpose:
   1072          *   Simply moves the selection to the next item without any check
   1073          */
   1074          static void _IncSel(TREEVIEW_Handle hObj) {
   1075            TREEVIEW_OBJ * pObj;
   1076            TREEVIEW_ITEM_Handle hItem;
   1077            TREEVIEW_ITEM_OBJ  * pItem;
   1078            pObj = TREEVIEW_LOCK_H(hObj);
   1079            hItem = pObj->hSel;
   1080            pItem = (TREEVIEW_ITEM_OBJ *)GUI_LOCK_H(hItem);
   1081            if (pItem->hNext) {
   1082              pObj->hSel = pItem->hNext;
   1083              WM_InvalidateWindow(hObj);
   1084            }
   1085            GUI_UNLOCK_H(pObj);
   1086            GUI_UNLOCK_H(pItem);
   1087          }
   1088          
   1089          /*********************************************************************
   1090          *
   1091          *       _GetPrevVisibleItem
   1092          *
   1093          * Purpose:
   1094          *   Returns the previous visible item. Used by moving the cursor 'UP'.
   1095          *   If there is no previous visible item it returns the given item.
   1096          */
   1097          static TREEVIEW_ITEM_Handle _GetPrevVisibleItem(TREEVIEW_ITEM_Handle hItem) {
   1098            TREEVIEW_ITEM_OBJ  * pItem;
   1099            TREEVIEW_ITEM_Handle hItemNew;
   1100            TREEVIEW_ITEM_Handle hItemOld;
   1101            int Level;
   1102            hItemNew = 0;
   1103            hItemOld = hItem;
   1104            pItem    = (TREEVIEW_ITEM_OBJ *)GUI_LOCK_H(hItem);
   1105            Level    = pItem->Level;
   1106            do {
   1107              hItem = pItem->hPrev;
   1108              if (hItem) {
   1109                GUI_UNLOCK_H(pItem);
   1110                pItem = (TREEVIEW_ITEM_OBJ *)GUI_LOCK_H(hItem);
   1111                if (hItemNew == 0) {
   1112                  hItemNew = hItem;
   1113                  Level    = pItem->Level;
   1114                }
   1115                if (pItem->Flags & TREEVIEW_ITEM_TYPE_NODE) {
   1116                  if (pItem->Level < Level) {
   1117                    if ((pItem->Flags & TREEVIEW_ITEM_STATE_EXPANDED) == 0) {
   1118                      hItemNew = hItem;
   1119                    }
   1120                    Level = pItem->Level;
   1121                  }
   1122                }
   1123              }
   1124            } while (hItem);
   1125            GUI_UNLOCK_H(pItem);
   1126            return hItemNew ? hItemNew : hItemOld;
   1127          }
   1128          
   1129          /*********************************************************************
   1130          *
   1131          *       _GetPrevVisibleNode
   1132          *
   1133          * Purpose:
   1134          *   Returns the previous visible node. Used by moving the cursor 'LEFT'
   1135          *   if the current selection is a leaf.
   1136          *   If there is no previous node it returns the given item.
   1137          */

   \                                 In section .text, align 4, keep-with-next
   1138          static TREEVIEW_ITEM_Handle _GetPrevVisibleNode(TREEVIEW_ITEM_Handle hItem) {
   \                     _GetPrevVisibleNode:
   \   00000000   F0422DE9           PUSH     {R4-R7,R9,LR}
   \   00000004   0050A0E1           MOV      R5,R0
   1139            TREEVIEW_ITEM_OBJ  * pItem;
   1140            TREEVIEW_ITEM_Handle hItemNew;
   1141            U16                  Flags;
   1142            do {
   1143              hItemNew = hItem;
   \                     ??_GetPrevVisibleNode_0:
   \   00000008   0540A0E1           MOV      R4,R5
   1144              hItem    = _GetPrevVisibleItem(hItem);
   \   0000000C   0060A0E3           MOV      R6,#+0
   \   00000010   0500A0E1           MOV      R0,R5
   \   00000014   ........           BL       GUI_ALLOC_LockH
   \   00000018   1C70D0E5           LDRB     R7,[R0, #+28]
   \   0000001C   0E0000EA           B        ??_GetPrevVisibleNode_1
   \                     ??_GetPrevVisibleNode_2:
   \   00000020   ........           BL       GUI_ALLOC_UnlockH
   \   00000024   0900A0E1           MOV      R0,R9
   \   00000028   ........           BL       GUI_ALLOC_LockH
   \   0000002C   B811D0E1           LDRH     R1,[R0, #+24]
   \   00000030   000056E3           CMP      R6,#+0
   \   00000034   0960A001           MOVEQ    R6,R9
   \   00000038   1C70D005           LDRBEQ   R7,[R0, #+28]
   \   0000003C   010011E3           TST      R1,#0x1
   \   00000040   0500000A           BEQ      ??_GetPrevVisibleNode_1
   \   00000044   1C20D0E5           LDRB     R2,[R0, #+28]
   \   00000048   070052E1           CMP      R2,R7
   \   0000004C   020000AA           BGE      ??_GetPrevVisibleNode_1
   \   00000050   020011E3           TST      R1,#0x2
   \   00000054   0960A001           MOVEQ    R6,R9
   \   00000058   0270A0E1           MOV      R7,R2
   \                     ??_GetPrevVisibleNode_1:
   \   0000005C   089090E5           LDR      R9,[R0, #+8]
   \   00000060   000059E3           CMP      R9,#+0
   \   00000064   EDFFFF1A           BNE      ??_GetPrevVisibleNode_2
   \   00000068   ........           BL       GUI_ALLOC_UnlockH
   \   0000006C   000056E3           CMP      R6,#+0
   \   00000070   0650A011           MOVNE    R5,R6
   1145              pItem    = (TREEVIEW_ITEM_OBJ *)GUI_LOCK_H(hItem);
   1146              Flags    = pItem->Flags;
   \   00000074   0500A0E1           MOV      R0,R5
   \   00000078   ........           BL       GUI_ALLOC_LockH
   \   0000007C   B861D0E1           LDRH     R6,[R0, #+24]
   1147              GUI_UNLOCK_H(pItem);
   \   00000080   ........           BL       GUI_ALLOC_UnlockH
   1148              if (Flags & TREEVIEW_ITEM_TYPE_NODE) {
   \   00000084   010016E3           TST      R6,#0x1
   \   00000088   0100000A           BEQ      ??_GetPrevVisibleNode_3
   1149                return hItem;
   \                     ??_GetPrevVisibleNode_4:
   \   0000008C   0500A0E1           MOV      R0,R5
   \   00000090   F082BDE8           POP      {R4-R7,R9,PC}    ;; return
   1150              }
   1151            } while (hItem != hItemNew);
   \                     ??_GetPrevVisibleNode_3:
   \   00000094   040055E1           CMP      R5,R4
   \   00000098   DAFFFF1A           BNE      ??_GetPrevVisibleNode_0
   \   0000009C   FAFFFFEA           B        ??_GetPrevVisibleNode_4
   1152            return hItem;
   1153          }
   1154          
   1155          /*********************************************************************
   1156          *
   1157          *       _GetPrevVisibleParent
   1158          *
   1159          * Purpose:
   1160          *   Returns the previous visible parent node of the given item. Used by moving the cursor 'LEFT'
   1161          *   if the current selection is a node.
   1162          *   If there is no previous visible parent it returns the given item.
   1163          */
   1164          static TREEVIEW_ITEM_Handle _GetPrevVisibleParent(TREEVIEW_ITEM_Handle hItem) {
   1165            TREEVIEW_ITEM_OBJ  * pItem;
   1166            TREEVIEW_ITEM_Handle r;
   1167            int Level;
   1168            r = hItem;
   1169            pItem    = (TREEVIEW_ITEM_OBJ *)GUI_LOCK_H(hItem);
   1170            Level    = pItem->Level;
   1171            do {
   1172              hItem = _GetPrevVisibleNode(hItem);
   1173              GUI_UNLOCK_H(pItem);
   1174              pItem = (TREEVIEW_ITEM_OBJ *)GUI_LOCK_H(hItem);
   1175              if (pItem->Level < Level) {
   1176                r = hItem;
   1177                break;
   1178              }
   1179            } while (pItem->Level);
   1180            GUI_UNLOCK_H(pItem);
   1181            return r;
   1182          }
   1183          
   1184          /*********************************************************************
   1185          *
   1186          *       _IsVisible
   1187          *
   1188          * Purpose:
   1189          *   Returns if the given item is visible or not. It moves up the list
   1190          *   of items and checks, if one of the parent nodes are closed or not.
   1191          *   If there is no closed node the item is visible.
   1192          */
   1193          static int _IsVisible(TREEVIEW_ITEM_Handle hItem) {
   1194            TREEVIEW_ITEM_OBJ  * pItem;
   1195            int IsVisible, Level;
   1196            IsVisible = 1;
   1197            pItem = (TREEVIEW_ITEM_OBJ *)GUI_LOCK_H(hItem);
   1198            Level = pItem->Level;
   1199            do {
   1200              hItem = pItem->hPrev;
   1201              if (hItem) {
   1202                GUI_UNLOCK_H(pItem);
   1203                pItem = (TREEVIEW_ITEM_OBJ *)GUI_LOCK_H(hItem);
   1204                if (Level > pItem->Level) {
   1205                  Level = pItem->Level;
   1206                  if (pItem->Flags & TREEVIEW_ITEM_TYPE_NODE) {
   1207                    if ((pItem->Flags & TREEVIEW_ITEM_STATE_EXPANDED) == 0) {
   1208                      IsVisible = 0;
   1209                    }
   1210                  }
   1211                }
   1212              }
   1213            } while (hItem && IsVisible && Level);
   1214            GUI_UNLOCK_H(pItem);
   1215            return IsVisible;
   1216          }
   1217          
   1218          /*********************************************************************
   1219          *
   1220          *       _GetNextVisibleItem
   1221          *
   1222          * Purpose:
   1223          *   Returns the next visible item (node or leaf). Used by moving the cursor 'DOWN'.
   1224          *   If there is no next visible item it returns the given item.
   1225          */

   \                                 In section .text, align 4, keep-with-next
   1226          static TREEVIEW_ITEM_Handle _GetNextVisibleItem(TREEVIEW_ITEM_Handle hItem) {
   \                     _GetNextVisibleItem:
   \   00000000   F04D2DE9           PUSH     {R4-R8,R10,R11,LR}
   1227            TREEVIEW_ITEM_OBJ  * pItem;
   1228            TREEVIEW_ITEM_Handle hItemNew;
   1229            TREEVIEW_ITEM_Handle hItemOld;
   1230          
   1231            hItemNew = 0;
   \   00000004   0040A0E3           MOV      R4,#+0
   1232            hItemOld = hItem;
   \   00000008   00A0A0E1           MOV      R10,R0
   1233            pItem    = (TREEVIEW_ITEM_OBJ *)GUI_LOCK_H(hItem);
   \   0000000C   ........           BL       GUI_ALLOC_LockH
   \   00000010   0060A0E1           MOV      R6,R0
   1234            if ((pItem->Flags & TREEVIEW_ITEM_STATE_EXPANDED) == 0) {
   \   00000014   1800D6E5           LDRB     R0,[R6, #+24]
   \   00000018   020010E3           TST      R0,#0x2
   \   0000001C   2000001A           BNE      ??_GetNextVisibleItem_0
   1235              do {
   1236                hItem = pItem->hNext;
   \                     ??_GetNextVisibleItem_1:
   \   00000020   045096E5           LDR      R5,[R6, #+4]
   1237                if (hItem) {
   \   00000024   000055E3           CMP      R5,#+0
   \   00000028   1E00000A           BEQ      ??_GetNextVisibleItem_2
   1238                  GUI_UNLOCK_H(pItem);
   \   0000002C   ........           BL       GUI_ALLOC_UnlockH
   1239                  pItem = (TREEVIEW_ITEM_OBJ *)GUI_LOCK_H(hItem);
   \   00000030   0500A0E1           MOV      R0,R5
   \   00000034   ........           BL       GUI_ALLOC_LockH
   \   00000038   0060A0E1           MOV      R6,R0
   1240                  if (_IsVisible(hItem)) {
   \   0000003C   0170A0E3           MOV      R7,#+1
   \   00000040   0500A0E1           MOV      R0,R5
   \   00000044   ........           BL       GUI_ALLOC_LockH
   \   00000048   1C80D0E5           LDRB     R8,[R0, #+28]
   \                     ??_GetNextVisibleItem_3:
   \   0000004C   08B090E5           LDR      R11,[R0, #+8]
   \   00000050   00005BE3           CMP      R11,#+0
   \   00000054   0D00000A           BEQ      ??_GetNextVisibleItem_4
   \   00000058   ........           BL       GUI_ALLOC_UnlockH
   \   0000005C   0B00A0E1           MOV      R0,R11
   \   00000060   ........           BL       GUI_ALLOC_LockH
   \   00000064   1C10D0E5           LDRB     R1,[R0, #+28]
   \   00000068   080051E1           CMP      R1,R8
   \   0000006C   050000AA           BGE      ??_GetNextVisibleItem_5
   \   00000070   0180A0E1           MOV      R8,R1
   \   00000074   1810D0E5           LDRB     R1,[R0, #+24]
   \   00000078   031001E2           AND      R1,R1,#0x3
   \   0000007C   010051E3           CMP      R1,#+1
   \   00000080   0070A003           MOVEQ    R7,#+0
   \   00000084   0100000A           BEQ      ??_GetNextVisibleItem_4
   \                     ??_GetNextVisibleItem_5:
   \   00000088   000058E3           CMP      R8,#+0
   \   0000008C   EEFFFF1A           BNE      ??_GetNextVisibleItem_3
   \                     ??_GetNextVisibleItem_4:
   \   00000090   ........           BL       GUI_ALLOC_UnlockH
   \   00000094   000057E3           CMP      R7,#+0
   \   00000098   E0FFFF0A           BEQ      ??_GetNextVisibleItem_1
   1241                    hItemNew = hItem;
   \   0000009C   0540A0E1           MOV      R4,R5
   1242                    break;
   \   000000A0   000000EA           B        ??_GetNextVisibleItem_2
   1243                  }
   1244                }
   1245              } while (hItem);
   1246            } else {
   1247              hItemNew = pItem->hNext;
   \                     ??_GetNextVisibleItem_0:
   \   000000A4   044096E5           LDR      R4,[R6, #+4]
   1248            }
   1249            GUI_UNLOCK_H(pItem);
   \                     ??_GetNextVisibleItem_2:
   \   000000A8   ........           BL       GUI_ALLOC_UnlockH
   1250            return hItemNew ? hItemNew : hItemOld;
   \   000000AC   000054E3           CMP      R4,#+0
   \   000000B0   04A0A011           MOVNE    R10,R4
   \   000000B4   0A00A0E1           MOV      R0,R10
   \   000000B8   F08DBDE8           POP      {R4-R8,R10,R11,PC}  ;; return
   1251          }
   1252          
   1253          /*********************************************************************
   1254          *
   1255          *       _GetLastNodeItem
   1256          */
   1257          static TREEVIEW_ITEM_Handle _GetLastNodeItem(TREEVIEW_ITEM_Handle hItem) {
   1258            TREEVIEW_ITEM_OBJ  * pItem;
   1259            TREEVIEW_ITEM_Handle hItemI;
   1260            TREEVIEW_ITEM_OBJ  * pItemNode;
   1261            TREEVIEW_ITEM_Handle r;
   1262            int Level;
   1263          
   1264            pItemNode = (TREEVIEW_ITEM_OBJ *)GUI_LOCK_H(hItem);
   1265            Level     = pItemNode->Level;
   1266            r         = hItem;
   1267            if (pItemNode->Flags & TREEVIEW_ITEM_TYPE_NODE) {
   1268              hItemI = pItemNode->hNext;
   1269              if (hItemI) {
   1270                pItem = (TREEVIEW_ITEM_OBJ *)GUI_LOCK_H(hItemI);
   1271                while (hItemI && (pItem->Level > Level)) {
   1272                  r      = hItemI;
   1273                  hItemI = pItem->hNext;
   1274                  if (hItemI) {
   1275                    GUI_UNLOCK_H(pItem);
   1276                    pItem = (TREEVIEW_ITEM_OBJ *)GUI_LOCK_H(hItemI);
   1277                    if (pItem->Level > Level) {
   1278                      r = hItemI;
   1279                    }
   1280                  }
   1281                }
   1282                GUI_UNLOCK_H(pItem);
   1283              }
   1284            }
   1285            GUI_UNLOCK_H(pItemNode);
   1286            return r;
   1287          }
   1288          
   1289          /*********************************************************************
   1290          *
   1291          *       _GetLastVisibleItem
   1292          */
   1293          static TREEVIEW_ITEM_Handle _GetLastVisibleItem(TREEVIEW_ITEM_Handle hItem) {
   1294            TREEVIEW_ITEM_Handle hItemNew;
   1295            do {
   1296              hItemNew = hItem;
   1297              hItem    = _GetNextVisibleItem(hItem);
   1298            } while (hItem != hItemNew);
   1299            return hItem;
   1300          }
   1301          
   1302          /*********************************************************************
   1303          *
   1304          *       _GetPrevItem
   1305          */
   1306          static TREEVIEW_ITEM_Handle _GetPrevItem(TREEVIEW_ITEM_Handle hItem, int Level) {
   1307            TREEVIEW_ITEM_Handle r = 0;
   1308            TREEVIEW_ITEM_OBJ  * pItem;
   1309            int IsLeaf;
   1310            pItem = (TREEVIEW_ITEM_OBJ *)GUI_LOCK_H(hItem);
   1311            hItem = pItem->hPrev;
   1312            IsLeaf = (pItem->Flags & TREEVIEW_ITEM_TYPE_NODE) ? 0 : 1;
   1313            while (hItem) {
   1314              GUI_UNLOCK_H(pItem);
   1315              pItem = (TREEVIEW_ITEM_OBJ *)GUI_LOCK_H(hItem);
   1316              if (pItem->Level == Level) {
   1317                r = hItem;
   1318                break;
   1319              }
   1320              if ((pItem->Level < Level) && (IsLeaf)) {
   1321                break;
   1322              }
   1323              hItem = pItem->hPrev;
   1324            }
   1325            GUI_UNLOCK_H(pItem);
   1326            return r;
   1327          }
   1328          
   1329          /*********************************************************************
   1330          *
   1331          *       _GetVisibility
   1332          *
   1333          * Purpose:
   1334          *   Checks if the given item is completely visible or not and fills
   1335          *   the optional GUI_RECT structure with the item rectangle.
   1336          *
   1337          * Return value:
   1338          *  -1 if above inside area
   1339          *   0 if completely in inside area
   1340          *   1 if at the bottom and partly visible
   1341          *   2 if below inside area
   1342          */

   \                                 In section .text, align 4, keep-with-next
   1343          static int _GetVisibility(TREEVIEW_Handle hObj, TREEVIEW_ITEM_Handle hItem, GUI_RECT * pRect) {
   \                     _GetVisibility:
   \   00000000   F0472DE9           PUSH     {R4-R10,LR}
   \   00000004   04D04DE2           SUB      SP,SP,#+4
   \   00000008   04002DE9           PUSH     {R2}
   \   0000000C   30D04DE2           SUB      SP,SP,#+48
   \   00000010   0150A0E1           MOV      R5,R1
   \   00000014   0040A0E1           MOV      R4,R0
   1344            TREEVIEW_ITEM_Handle hItemI;
   1345            GUI_RECT RectInside;
   1346            int i, yPos, ItemDistY;
   1347            TREEVIEW_OBJ * pObj;
   1348            WIDGET_DRAW_ITEM_FUNC * pfDrawItem;
   1349            
   1350            WM_GetInsideRectExScrollbar(hObj, &RectInside);
   \   00000018   0D10A0E1           MOV      R1,SP
   \   0000001C   ........           BL       WM_GetInsideRectExScrollbar
   1351            yPos = RectInside.y0;
   \   00000020   F260DDE1           LDRSH    R6,[SP, #+2]
   1352            pObj = TREEVIEW_LOCK_H(hObj);
   \   00000024   0400A0E1           MOV      R0,R4
   \   00000028   ........           BL       GUI_ALLOC_LockH
   1353            hItemI = pObj->hFirst;
   \   0000002C   A0A090E5           LDR      R10,[R0, #+160]
   1354            pfDrawItem = pObj->pfDrawItem;
   \   00000030   347090E5           LDR      R7,[R0, #+52]
   1355            i = pObj->ScrollStateV.v;
   \   00000034   3C8090E5           LDR      R8,[R0, #+60]
   1356            GUI_UNLOCK_H(pObj);
   \   00000038   ........           BL       GUI_ALLOC_UnlockH
   \   0000003C   000058E3           CMP      R8,#+0
   \   00000040   1A00000A           BEQ      ??_GetVisibility_0
   \                     ??_GetVisibility_1:
   \   00000044   018048E2           SUB      R8,R8,#+1
   1357            while (i--) {
   1358              if (!hItemI) {
   \   00000048   00005AE3           CMP      R10,#+0
   \   0000004C   5300000A           BEQ      ??_GetVisibility_2
   1359                break;
   1360              }
   1361              if (hItemI == hItem) {
   \   00000050   05005AE1           CMP      R10,R5
   1362                return -1; /* Above inside area */
   \   00000054   0000E003           MVNEQ    R0,#+0
   \   00000058   5100000A           BEQ      ??_GetVisibility_3
   1363              }
   1364              /* Skip closed items */
   1365              hItemI = _SkipClosedItems(hItemI);
   \   0000005C   0A00A0E1           MOV      R0,R10
   \   00000060   ........           BL       GUI_ALLOC_LockH
   \   00000064   1810D0E5           LDRB     R1,[R0, #+24]
   \   00000068   031001E2           AND      R1,R1,#0x3
   \   0000006C   010051E3           CMP      R1,#+1
   \   00000070   0A00001A           BNE      ??_GetVisibility_4
   \   00000074   1C90D0E5           LDRB     R9,[R0, #+28]
   \                     ??_GetVisibility_5:
   \   00000078   04A090E5           LDR      R10,[R0, #+4]
   \   0000007C   00005AE3           CMP      R10,#+0
   \   00000080   0700000A           BEQ      ??_GetVisibility_6
   \   00000084   ........           BL       GUI_ALLOC_UnlockH
   \   00000088   0A00A0E1           MOV      R0,R10
   \   0000008C   ........           BL       GUI_ALLOC_LockH
   \   00000090   1C10D0E5           LDRB     R1,[R0, #+28]
   \   00000094   010059E1           CMP      R9,R1
   \   00000098   F6FFFFBA           BLT      ??_GetVisibility_5
   \   0000009C   000000EA           B        ??_GetVisibility_6
   \                     ??_GetVisibility_4:
   \   000000A0   04A090E5           LDR      R10,[R0, #+4]
   \                     ??_GetVisibility_6:
   \   000000A4   ........           BL       GUI_ALLOC_UnlockH
   1366            }
   \   000000A8   000058E3           CMP      R8,#+0
   \   000000AC   E4FFFF1A           BNE      ??_GetVisibility_1
   1367            /* Inside area */
   1368            while (hItemI) {
   \                     ??_GetVisibility_0:
   \   000000B0   00005AE3           CMP      R10,#+0
   \   000000B4   3900000A           BEQ      ??_GetVisibility_2
   1369              ItemDistY = _CallOwnerDraw(hObj, pfDrawItem, hItemI, WIDGET_ITEM_GET_YSIZE);
   \   000000B8   08A08DE5           STR      R10,[SP, #+8]
   \   000000BC   0000A0E3           MOV      R0,#+0
   \   000000C0   000057E3           CMP      R7,#+0
   \   000000C4   0600000A           BEQ      ??_GetVisibility_7
   \   000000C8   1910A0E3           MOV      R1,#+25
   \   000000CC   10108DE5           STR      R1,[SP, #+16]
   \   000000D0   08108DE2           ADD      R1,SP,#+8
   \   000000D4   0C408DE5           STR      R4,[SP, #+12]
   \   000000D8   28108DE5           STR      R1,[SP, #+40]
   \   000000DC   0C008DE2           ADD      R0,SP,#+12
   \   000000E0   37FF2FE1           BLX      R7
   1370              yPos     += ItemDistY;
   \                     ??_GetVisibility_7:
   \   000000E4   066080E0           ADD      R6,R0,R6
   1371              if (hItemI == hItem) {
   \   000000E8   05005AE1           CMP      R10,R5
   \   000000EC   1400001A           BNE      ??_GetVisibility_8
   1372                if (pRect) {
   \   000000F0   30109DE5           LDR      R1,[SP, #+48]
   \   000000F4   000051E3           CMP      R1,#+0
   \   000000F8   0B00000A           BEQ      ??_GetVisibility_9
   1373                  pRect->x0 = RectInside.x0;
   \   000000FC   F020DDE1           LDRSH    R2,[SP, #+0]
   \   00000100   B020C1E1           STRH     R2,[R1, #+0]
   1374                  pRect->x1 = RectInside.x1;
   \   00000104   F420DDE1           LDRSH    R2,[SP, #+4]
   \   00000108   30109DE5           LDR      R1,[SP, #+48]
   \   0000010C   B420C1E1           STRH     R2,[R1, #+4]
   1375                  pRect->y0 = yPos - ItemDistY;
   \   00000110   30209DE5           LDR      R2,[SP, #+48]
   \   00000114   001046E0           SUB      R1,R6,R0
   \   00000118   B210C2E1           STRH     R1,[R2, #+2]
   1376                  pRect->y1 = pRect->y0 + ItemDistY - 1;
   \   0000011C   010080E0           ADD      R0,R0,R1
   \   00000120   30109DE5           LDR      R1,[SP, #+48]
   \   00000124   010040E2           SUB      R0,R0,#+1
   \   00000128   B600C1E1           STRH     R0,[R1, #+6]
   1377                }
   1378                if (yPos > (RectInside.y1 + 1)) {
   \                     ??_GetVisibility_9:
   \   0000012C   F600DDE1           LDRSH    R0,[SP, #+6]
   \   00000130   010080E2           ADD      R0,R0,#+1
   \   00000134   060050E1           CMP      R0,R6
   1379                  return 1;
   \   00000138   0100A0B3           MOVLT    R0,#+1
   \   0000013C   0000A0A3           MOVGE    R0,#+0
   \   00000140   170000EA           B        ??_GetVisibility_3
   1380                } else {
   1381                  return 0;
   1382                }
   1383              }
   1384              if (yPos > RectInside.y1) {
   \                     ??_GetVisibility_8:
   \   00000144   F600DDE1           LDRSH    R0,[SP, #+6]
   \   00000148   060050E1           CMP      R0,R6
   \   0000014C   130000BA           BLT      ??_GetVisibility_2
   1385                break;
   1386              }
   1387              hItemI = _SkipClosedItems(hItemI);
   \   00000150   0A00A0E1           MOV      R0,R10
   \   00000154   ........           BL       GUI_ALLOC_LockH
   \   00000158   1810D0E5           LDRB     R1,[R0, #+24]
   \   0000015C   031001E2           AND      R1,R1,#0x3
   \   00000160   010051E3           CMP      R1,#+1
   \   00000164   0A00001A           BNE      ??_GetVisibility_10
   \   00000168   1C80D0E5           LDRB     R8,[R0, #+28]
   \                     ??_GetVisibility_11:
   \   0000016C   04A090E5           LDR      R10,[R0, #+4]
   \   00000170   00005AE3           CMP      R10,#+0
   \   00000174   0700000A           BEQ      ??_GetVisibility_12
   \   00000178   ........           BL       GUI_ALLOC_UnlockH
   \   0000017C   0A00A0E1           MOV      R0,R10
   \   00000180   ........           BL       GUI_ALLOC_LockH
   \   00000184   1C10D0E5           LDRB     R1,[R0, #+28]
   \   00000188   010058E1           CMP      R8,R1
   \   0000018C   F6FFFFBA           BLT      ??_GetVisibility_11
   \   00000190   000000EA           B        ??_GetVisibility_12
   \                     ??_GetVisibility_10:
   \   00000194   04A090E5           LDR      R10,[R0, #+4]
   \                     ??_GetVisibility_12:
   \   00000198   ........           BL       GUI_ALLOC_UnlockH
   1388            }
   \   0000019C   C3FFFFEA           B        ??_GetVisibility_0
   1389            /* Below inside area */
   1390            return 2;
   \                     ??_GetVisibility_2:
   \   000001A0   0200A0E3           MOV      R0,#+2
   \                     ??_GetVisibility_3:
   \   000001A4   38D08DE2           ADD      SP,SP,#+56       ;; stack cleaning
   \   000001A8   F087BDE8           POP      {R4-R10,PC}      ;; return
   1391          }
   1392          
   1393          /*********************************************************************
   1394          *
   1395          *       _IsParentPathOpen
   1396          *
   1397          * Purpose:
   1398          *   Returns if complete parent path is open or not. If it is not open
   1399          *   the item is not visible.
   1400          *
   1401          * Return value:
   1402          *   1 if it is visible
   1403          *   0 if not
   1404          */
   1405          static int _IsParentPathOpen(TREEVIEW_ITEM_Handle hItem) {
   1406            TREEVIEW_ITEM_Handle hItemI;
   1407            TREEVIEW_ITEM_OBJ  * pItemI;
   1408            int Level;
   1409            int r = 1;
   1410            pItemI = (TREEVIEW_ITEM_OBJ *)GUI_LOCK_H(hItem);
   1411            Level  = pItemI->Level;
   1412            do {
   1413              hItemI = pItemI->hPrev;
   1414              if (hItemI) {
   1415                GUI_UNLOCK_H(pItemI);
   1416                pItemI = (TREEVIEW_ITEM_OBJ *)GUI_LOCK_H(hItemI);
   1417                if (Level > pItemI->Level) {
   1418                  Level = pItemI->Level;
   1419                  if ((pItemI->Flags & TREEVIEW_ITEM_STATE_EXPANDED) == 0) {
   1420                    r = 0;
   1421                    break;
   1422                  }
   1423                }
   1424              }
   1425            } while (hItemI);
   1426            GUI_UNLOCK_H(pItemI);
   1427            return r;
   1428          }
   1429          
   1430          /*********************************************************************
   1431          *
   1432          *       _UpdateScrollPos
   1433          *
   1434          * Purpose:
   1435          *   The routine updates the position of the scrollbars if required.
   1436          *
   1437          * Return value:
   1438          *   0 if scroll position has not changed
   1439          *   1 if scroll position has changed
   1440          */

   \                                 In section .text, align 4, keep-with-next
   1441          static int _UpdateScrollPos(TREEVIEW_Handle hObj) {
   \                     _UpdateScrollPos:
   \   00000000   F04B2DE9           PUSH     {R4-R9,R11,LR}
   \   00000004   18D04DE2           SUB      SP,SP,#+24
   \   00000008   0040A0E1           MOV      R4,R0
   1442            WM_SCROLL_STATE ScrollStateV, ScrollStateH;
   1443            TREEVIEW_OBJ * pObj;
   1444            TREEVIEW_ITEM_Handle hItem;
   1445            int Visibility;
   1446            int r = 0;
   \   0000000C   0050A0E3           MOV      R5,#+0
   1447          
   1448            pObj  = TREEVIEW_LOCK_H(hObj);
   \   00000010   ........           BL       GUI_ALLOC_LockH
   \   00000014   0060A0E1           MOV      R6,R0
   1449            hItem = pObj->hSel;
   \   00000018   A87096E5           LDR      R7,[R6, #+168]
   1450            if (_IsParentPathOpen(hItem) != 0) {
   \   0000001C   0180A0E3           MOV      R8,#+1
   \   00000020   0700A0E1           MOV      R0,R7
   \   00000024   ........           BL       GUI_ALLOC_LockH
   \   00000028   1C90D0E5           LDRB     R9,[R0, #+28]
   \                     ??_UpdateScrollPos_0:
   \   0000002C   08B090E5           LDR      R11,[R0, #+8]
   \   00000030   00005BE3           CMP      R11,#+0
   \   00000034   0A00000A           BEQ      ??_UpdateScrollPos_1
   \   00000038   ........           BL       GUI_ALLOC_UnlockH
   \   0000003C   0B00A0E1           MOV      R0,R11
   \   00000040   ........           BL       GUI_ALLOC_LockH
   \   00000044   1C10D0E5           LDRB     R1,[R0, #+28]
   \   00000048   090051E1           CMP      R1,R9
   \   0000004C   F6FFFFAA           BGE      ??_UpdateScrollPos_0
   \   00000050   0190A0E1           MOV      R9,R1
   \   00000054   1810D0E5           LDRB     R1,[R0, #+24]
   \   00000058   020011E3           TST      R1,#0x2
   \   0000005C   F2FFFF1A           BNE      ??_UpdateScrollPos_0
   \   00000060   0080A0E3           MOV      R8,#+0
   \                     ??_UpdateScrollPos_1:
   \   00000064   ........           BL       GUI_ALLOC_UnlockH
   \   00000068   000058E3           CMP      R8,#+0
   \   0000006C   2400000A           BEQ      ??_UpdateScrollPos_2
   1451              do {
   1452                Visibility = _GetVisibility(hObj, hItem, NULL);
   \                     ??_UpdateScrollPos_3:
   \   00000070   0020A0E3           MOV      R2,#+0
   \   00000074   0710A0E1           MOV      R1,R7
   \   00000078   0400A0E1           MOV      R0,R4
   \   0000007C   ........           BL       _GetVisibility
   1453                switch (Visibility) {
   \   00000080   011040E2           SUB      R1,R0,#+1
   \   00000084   010051E3           CMP      R1,#+1
   \   00000088   0400009A           BLS      ??_UpdateScrollPos_4
   \   0000008C   021091E2           ADDS     R1,R1,#+2
   \   00000090   0600001A           BNE      ??_UpdateScrollPos_5
   1454                case -1:
   1455                  pObj->ScrollStateV.v--;
   \   00000094   3C1096E5           LDR      R1,[R6, #+60]
   \   00000098   011041E2           SUB      R1,R1,#+1
   \   0000009C   010000EA           B        ??_UpdateScrollPos_6
   1456                  r = 1;
   1457                  break;
   1458                case +1:
   1459                case +2:
   1460                  pObj->ScrollStateV.v++;
   \                     ??_UpdateScrollPos_4:
   \   000000A0   3C1096E5           LDR      R1,[R6, #+60]
   \   000000A4   011081E2           ADD      R1,R1,#+1
   \                     ??_UpdateScrollPos_6:
   \   000000A8   3C1086E5           STR      R1,[R6, #+60]
   1461                  r = 1;
   \   000000AC   0150A0E3           MOV      R5,#+1
   1462                  break;
   1463                }
   1464                if (pObj->ScrollStateV.v >= pObj->NumVisItems) {
   \                     ??_UpdateScrollPos_5:
   \   000000B0   B41096E5           LDR      R1,[R6, #+180]
   \   000000B4   3C2096E5           LDR      R2,[R6, #+60]
   \   000000B8   010052E1           CMP      R2,R1
   1465                  pObj->ScrollStateV.v = pObj->NumVisItems - 1;
   \   000000BC   010041A2           SUBGE    R0,R1,#+1
   \   000000C0   3C0086A5           STRGE    R0,[R6, #+60]
   1466                  break;
   \   000000C4   010000AA           BGE      ??_UpdateScrollPos_7
   1467                }
   1468              } while (Visibility);
   \   000000C8   000050E3           CMP      R0,#+0
   \   000000CC   E7FFFF1A           BNE      ??_UpdateScrollPos_3
   1469              ScrollStateV = pObj->ScrollStateV;
   \                     ??_UpdateScrollPos_7:
   \   000000D0   381086E2           ADD      R1,R6,#+56
   \   000000D4   0C10B1E8           LDM      R1!,{R2,R3,R12}
   \   000000D8   0C008DE2           ADD      R0,SP,#+12
   \   000000DC   0C10A0E8           STM      R0!,{R2,R3,R12}
   1470              ScrollStateH = pObj->ScrollStateH;
   \   000000E0   0C10B1E8           LDM      R1!,{R2,R3,R12}
   \   000000E4   0D00A0E1           MOV      R0,SP
   \   000000E8   0C10A0E8           STM      R0!,{R2,R3,R12}
   1471              GUI_UNLOCK_H(pObj);
   \   000000EC   ........           BL       GUI_ALLOC_UnlockH
   1472              WIDGET__SetScrollState(hObj, &ScrollStateV, &ScrollStateH);
   \   000000F0   0D20A0E1           MOV      R2,SP
   \   000000F4   0C108DE2           ADD      R1,SP,#+12
   \   000000F8   0400A0E1           MOV      R0,R4
   \   000000FC   ........           BL       WIDGET__SetScrollState
   \   00000100   000000EA           B        ??_UpdateScrollPos_8
   1473            } else {
   1474              GUI_UNLOCK_H(pObj);
   \                     ??_UpdateScrollPos_2:
   \   00000104   ........           BL       GUI_ALLOC_UnlockH
   1475            }
   1476            return r;
   \                     ??_UpdateScrollPos_8:
   \   00000108   0500A0E1           MOV      R0,R5
   \   0000010C   18D08DE2           ADD      SP,SP,#+24
   \   00000110   F08BBDE8           POP      {R4-R9,R11,PC}   ;; return
   1477          }
   1478          
   1479          /*********************************************************************
   1480          *
   1481          *       _SetSel
   1482          *
   1483          * Purpose:
   1484          *   Sets the new selection, invalidates the current and the previous line
   1485          *   and notifies the parent window
   1486          */
   1487          static void _SetSel(TREEVIEW_Handle hObj, TREEVIEW_ITEM_Handle hItem) {
   1488            TREEVIEW_OBJ * pObj;
   1489            TREEVIEW_ITEM_Handle hItemOld;
   1490          
   1491            pObj = TREEVIEW_LOCK_H(hObj);
   1492            hItemOld = pObj->hSel;
   1493            pObj->hSel = hItem;
   1494            GUI_UNLOCK_H(pObj);
   1495            if (_UpdateScrollPos(hObj)) {
   1496              /*
   1497              * Invalidate complete window
   1498              */
   1499              WM_InvalidateWindow(hObj);
   1500            } else {
   1501              GUI_RECT Rect;
   1502              int Visibility;
   1503              /*
   1504              * Invalidate only 2 items
   1505              */
   1506              Visibility = _GetVisibility(hObj, hItemOld, &Rect);
   1507              if ((Visibility == 0) || (Visibility == 1)) {
   1508                WM_InvalidateRect(hObj, &Rect);
   1509              }
   1510              Visibility = _GetVisibility(hObj, hItem, &Rect);
   1511              if ((Visibility == 0) || (Visibility == 1)) {
   1512                WM_InvalidateRect(hObj, &Rect);
   1513              }
   1514            }
   1515            WM_NotifyParent(hObj, WM_NOTIFICATION_SEL_CHANGED);
   1516          }
   1517          
   1518          /*********************************************************************
   1519          *
   1520          *       _OnKey
   1521          */

   \                                 In section .text, align 4, keep-with-next
   1522          static void _OnKey(TREEVIEW_Handle hObj, WM_MESSAGE * pMsg) {
   \                     _OnKey:
   \   00000000   F0412DE9           PUSH     {R4-R8,LR}
   \   00000004   0040A0E1           MOV      R4,R0
   \   00000008   0170A0E1           MOV      R7,R1
   1523            TREEVIEW_OBJ * pObj;
   1524            TREEVIEW_ITEM_Handle hItem;
   1525            TREEVIEW_ITEM_OBJ  * pItem;
   1526            TREEVIEW_ITEM_Handle hFirst;
   1527            TREEVIEW_ITEM_Handle hSel;
   1528            const WM_KEY_INFO  * pInfo;
   1529            int Key;
   1530            U16 Flags;
   1531            pInfo = (const WM_KEY_INFO *)pMsg->Data.p;
   \   0000000C   0C0097E5           LDR      R0,[R7, #+12]
   \   00000010   08D04DE2           SUB      SP,SP,#+8
   1532            if (pInfo->PressedCnt == 0) {
   \   00000014   041090E5           LDR      R1,[R0, #+4]
   \   00000018   000051E3           CMP      R1,#+0
   \   0000001C   FF00000A           BEQ      ??_OnKey_1
   1533              return;
   1534            }
   1535            Key    = pInfo->Key;
   \   00000020   008090E5           LDR      R8,[R0, #+0]
   1536            pObj   = TREEVIEW_LOCK_H(hObj);
   \   00000024   0400A0E1           MOV      R0,R4
   \   00000028   ........           BL       GUI_ALLOC_LockH
   1537            hFirst = pObj->hFirst;
   \   0000002C   A06090E5           LDR      R6,[R0, #+160]
   1538            hSel   = pObj->hSel;
   \   00000030   A85090E5           LDR      R5,[R0, #+168]
   1539            GUI_UNLOCK_H(pObj);
   \   00000034   ........           BL       GUI_ALLOC_UnlockH
   1540            switch (Key) {
   \   00000038   108048E2           SUB      R8,R8,#+16
   \   0000003C   080058E3           CMP      R8,#+8
   \   00000040   08F18F90           ADDLS    PC,PC,R8, LSL #+2
   \                     ??_OnKey_0:
   \   00000044   F300008A           BHI      ??_OnKey_2
   \   00000048   2B0000EA           B        ??_OnKey_3
   \   0000004C   900000EA           B        ??_OnKey_4
   \   00000050   050000EA           B        ??_OnKey_5
   \   00000054   7F0000EA           B        ??_OnKey_6
   \   00000058   EE0000EA           B        ??_OnKey_2
   \   0000005C   ED0000EA           B        ??_OnKey_2
   \   00000060   EC0000EA           B        ??_OnKey_2
   \   00000064   A70000EA           B        ??_OnKey_7
   \   00000068   BE0000EA           B        ??_OnKey_8
   1541            case GUI_KEY_RIGHT:
   1542              hItem = hSel;
   1543              if (hItem) {
   \                     ??_OnKey_5:
   \   0000006C   000055E3           CMP      R5,#+0
   \   00000070   EA00000A           BEQ      ??_OnKey_1
   1544                pItem = (TREEVIEW_ITEM_OBJ *)GUI_LOCK_H(hItem);
   1545                Flags = pItem->Flags;
   \   00000074   0500A0E1           MOV      R0,R5
   \   00000078   ........           BL       GUI_ALLOC_LockH
   \   0000007C   B861D0E1           LDRH     R6,[R0, #+24]
   1546                GUI_UNLOCK_H(pItem);
   \   00000080   ........           BL       GUI_ALLOC_UnlockH
   1547                if (Flags & TREEVIEW_ITEM_TYPE_NODE) {
   \   00000084   010016E3           TST      R6,#0x1
   \   00000088   E400000A           BEQ      ??_OnKey_1
   1548                  if (Flags & TREEVIEW_ITEM_STATE_EXPANDED) {
   \   0000008C   020016E3           TST      R6,#0x2
   \   00000090   0F00000A           BEQ      ??_OnKey_9
   1549                    _IncSel(hObj);
   \   00000094   0400A0E1           MOV      R0,R4
   \   00000098   ........           BL       GUI_ALLOC_LockH
   \   0000009C   0050A0E1           MOV      R5,R0
   \   000000A0   A80095E5           LDR      R0,[R5, #+168]
   \   000000A4   ........           BL       GUI_ALLOC_LockH
   \   000000A8   040090E5           LDR      R0,[R0, #+4]
   \   000000AC   000050E3           CMP      R0,#+0
   \   000000B0   0200000A           BEQ      ??_OnKey_10
   \   000000B4   A80085E5           STR      R0,[R5, #+168]
   \   000000B8   0400A0E1           MOV      R0,R4
   \   000000BC   ........           BL       WM_InvalidateWindow
   \                     ??_OnKey_10:
   \   000000C0   ........           BL       GUI_ALLOC_UnlockH
   \   000000C4   ........           BL       GUI_ALLOC_UnlockH
   1550                    _UpdateScrollPos(hObj);
   \   000000C8   0400A0E1           MOV      R0,R4
   \   000000CC   ........           BL       _UpdateScrollPos
   \   000000D0   D20000EA           B        ??_OnKey_1
   1551                  } else {
   1552                    TREEVIEW_ITEM_Expand(hItem);
   1553                  }
   1554                }
   1555              }
   \                     ??_OnKey_9:
   \   000000D4   ........           BL       GUI_Lock
   \   000000D8   0500A0E1           MOV      R0,R5
   \   000000DC   ........           BL       GUI_ALLOC_LockH
   \   000000E0   B811D0E1           LDRH     R1,[R0, #+24]
   \   000000E4   004090E5           LDR      R4,[R0, #+0]
   \   000000E8   032001E2           AND      R2,R1,#0x3
   \   000000EC   010052E3           CMP      R2,#+1
   \   000000F0   1300001A           BNE      ??_OnKey_11
   \   000000F4   021081E3           ORR      R1,R1,#0x2
   \   000000F8   150000EA           B        ??_OnKey_12
   1556              break;
   1557            case GUI_KEY_LEFT:
   1558              hItem = hSel;
   1559              if (hItem) {
   \                     ??_OnKey_3:
   \   000000FC   000055E3           CMP      R5,#+0
   \   00000100   C600000A           BEQ      ??_OnKey_1
   1560                pItem = (TREEVIEW_ITEM_OBJ *)GUI_LOCK_H(hItem);
   1561                Flags = pItem->Flags;
   \   00000104   0500A0E1           MOV      R0,R5
   \   00000108   ........           BL       GUI_ALLOC_LockH
   \   0000010C   B861D0E1           LDRH     R6,[R0, #+24]
   1562                GUI_UNLOCK_H(pItem);
   \   00000110   ........           BL       GUI_ALLOC_UnlockH
   1563                if (Flags & TREEVIEW_ITEM_TYPE_NODE) {
   \   00000114   010016E3           TST      R6,#0x1
   \   00000118   4100000A           BEQ      ??_OnKey_13
   1564                  if (Flags & TREEVIEW_ITEM_STATE_EXPANDED) {
   \   0000011C   020016E3           TST      R6,#0x2
   \   00000120   1700000A           BEQ      ??_OnKey_14
   \   00000124   ........           BL       GUI_Lock
   \   00000128   0500A0E1           MOV      R0,R5
   \   0000012C   ........           BL       GUI_ALLOC_LockH
   \   00000130   1810D0E5           LDRB     R1,[R0, #+24]
   \   00000134   004090E5           LDR      R4,[R0, #+0]
   \   00000138   031001E2           AND      R1,R1,#0x3
   \   0000013C   030051E3           CMP      R1,#+3
   \   00000140   0100000A           BEQ      ??_OnKey_15
   \                     ??_OnKey_11:
   \   00000144   ........           BL       GUI_ALLOC_UnlockH
   \   00000148   0B0000EA           B        ??_OnKey_16
   \                     ??_OnKey_15:
   \   0000014C   B811D0E1           LDRH     R1,[R0, #+24]
   \   00000150   0210C1E3           BIC      R1,R1,#0x2
   \                     ??_OnKey_12:
   \   00000154   B811C0E1           STRH     R1,[R0, #+24]
   \   00000158   ........           BL       GUI_ALLOC_UnlockH
   \   0000015C   000054E3           CMP      R4,#+0
   \   00000160   0500000A           BEQ      ??_OnKey_16
   \   00000164   0400A0E1           MOV      R0,R4
   \   00000168   ........           BL       _CalcParams
   \   0000016C   0400A0E1           MOV      R0,R4
   \   00000170   ........           BL       _ManageAutoScroll
   \   00000174   0400A0E1           MOV      R0,R4
   \   00000178   ........           BL       WM_InvalidateWindow
   \                     ??_OnKey_16:
   \   0000017C   ........           BL       GUI_Unlock
   \   00000180   A60000EA           B        ??_OnKey_1
   1565                    TREEVIEW_ITEM_Collapse(hItem);
   1566                  } else {
   1567                    _SetSel(hObj, _GetPrevVisibleParent(hSel));
   \                     ??_OnKey_14:
   \   00000184   0560A0E1           MOV      R6,R5
   \   00000188   0500A0E1           MOV      R0,R5
   \   0000018C   ........           BL       GUI_ALLOC_LockH
   \   00000190   1C70D0E5           LDRB     R7,[R0, #+28]
   \                     ??_OnKey_17:
   \   00000194   0500A0E1           MOV      R0,R5
   \   00000198   ........           BL       _GetPrevVisibleNode
   \   0000019C   0050A0E1           MOV      R5,R0
   \   000001A0   ........           BL       GUI_ALLOC_UnlockH
   \   000001A4   0500A0E1           MOV      R0,R5
   \   000001A8   ........           BL       GUI_ALLOC_LockH
   \   000001AC   1C00D0E5           LDRB     R0,[R0, #+28]
   \   000001B0   070050E1           CMP      R0,R7
   \   000001B4   020000BA           BLT      ??_OnKey_18
   \   000001B8   000050E3           CMP      R0,#+0
   \   000001BC   F4FFFF1A           BNE      ??_OnKey_17
   \   000001C0   000000EA           B        ??_OnKey_19
   \                     ??_OnKey_18:
   \   000001C4   0560A0E1           MOV      R6,R5
   \                     ??_OnKey_19:
   \   000001C8   ........           BL       GUI_ALLOC_UnlockH
   1568                  }
   1569                } else {
   \                     ??_OnKey_20:
   \   000001CC   0400A0E1           MOV      R0,R4
   \   000001D0   ........           BL       GUI_ALLOC_LockH
   \   000001D4   A85090E5           LDR      R5,[R0, #+168]
   \   000001D8   A86080E5           STR      R6,[R0, #+168]
   \   000001DC   ........           BL       GUI_ALLOC_UnlockH
   \   000001E0   0400A0E1           MOV      R0,R4
   \   000001E4   ........           BL       _UpdateScrollPos
   \   000001E8   000050E3           CMP      R0,#+0
   \   000001EC   6E00001A           BNE      ??_OnKey_21
   \   000001F0   0D20A0E1           MOV      R2,SP
   \   000001F4   0510A0E1           MOV      R1,R5
   \   000001F8   0400A0E1           MOV      R0,R4
   \   000001FC   ........           BL       _GetVisibility
   \   00000200   000050E3           CMP      R0,#+0
   \   00000204   01005013           CMPNE    R0,#+1
   \   00000208   0200001A           BNE      ??_OnKey_22
   \   0000020C   0D10A0E1           MOV      R1,SP
   \   00000210   0400A0E1           MOV      R0,R4
   \   00000214   ........           BL       WM_InvalidateRect
   \                     ??_OnKey_22:
   \   00000218   0D20A0E1           MOV      R2,SP
   \   0000021C   0610A0E1           MOV      R1,R6
   \   00000220   700000EA           B        ??_OnKey_23
   1570                  _SetSel(hObj, _GetPrevVisibleNode(hSel));
   \                     ??_OnKey_13:
   \   00000224   0500A0E1           MOV      R0,R5
   \   00000228   ........           BL       _GetPrevVisibleNode
   \   0000022C   0050A0E1           MOV      R5,R0
   \   00000230   0400A0E1           MOV      R0,R4
   \   00000234   ........           BL       GUI_ALLOC_LockH
   \   00000238   A86090E5           LDR      R6,[R0, #+168]
   \   0000023C   A85080E5           STR      R5,[R0, #+168]
   \   00000240   ........           BL       GUI_ALLOC_UnlockH
   \   00000244   0400A0E1           MOV      R0,R4
   \   00000248   ........           BL       _UpdateScrollPos
   \   0000024C   000050E3           CMP      R0,#+0
   \   00000250   5500001A           BNE      ??_OnKey_21
   \   00000254   570000EA           B        ??_OnKey_24
   1571                }
   1572              }
   1573              break;
   1574            case GUI_KEY_DOWN:
   1575              if (hSel) {
   \                     ??_OnKey_6:
   \   00000258   000055E3           CMP      R5,#+0
   \   0000025C   6F00000A           BEQ      ??_OnKey_1
   1576                _SetSel(hObj, _GetNextVisibleItem(hSel));
   \   00000260   0500A0E1           MOV      R0,R5
   \   00000264   ........           BL       _GetNextVisibleItem
   \   00000268   0050A0E1           MOV      R5,R0
   \   0000026C   0400A0E1           MOV      R0,R4
   \   00000270   ........           BL       GUI_ALLOC_LockH
   \   00000274   A86090E5           LDR      R6,[R0, #+168]
   \   00000278   A85080E5           STR      R5,[R0, #+168]
   \   0000027C   ........           BL       GUI_ALLOC_UnlockH
   \   00000280   0400A0E1           MOV      R0,R4
   \   00000284   ........           BL       _UpdateScrollPos
   \   00000288   000050E3           CMP      R0,#+0
   \   0000028C   4600001A           BNE      ??_OnKey_21
   \   00000290   480000EA           B        ??_OnKey_24
   1577              }
   1578              break;
   1579            case GUI_KEY_UP:
   1580              if (hSel) {
   \                     ??_OnKey_4:
   \   00000294   000055E3           CMP      R5,#+0
   \   00000298   6000000A           BEQ      ??_OnKey_1
   1581                _SetSel(hObj, _GetPrevVisibleItem(hSel));
   \   0000029C   0060A0E3           MOV      R6,#+0
   \   000002A0   0500A0E1           MOV      R0,R5
   \   000002A4   ........           BL       GUI_ALLOC_LockH
   \   000002A8   1C70D0E5           LDRB     R7,[R0, #+28]
   \   000002AC   0E0000EA           B        ??_OnKey_25
   \                     ??_OnKey_26:
   \   000002B0   ........           BL       GUI_ALLOC_UnlockH
   \   000002B4   0800A0E1           MOV      R0,R8
   \   000002B8   ........           BL       GUI_ALLOC_LockH
   \   000002BC   B811D0E1           LDRH     R1,[R0, #+24]
   \   000002C0   000056E3           CMP      R6,#+0
   \   000002C4   0860A001           MOVEQ    R6,R8
   \   000002C8   1C70D005           LDRBEQ   R7,[R0, #+28]
   \   000002CC   010011E3           TST      R1,#0x1
   \   000002D0   0500000A           BEQ      ??_OnKey_25
   \   000002D4   1C20D0E5           LDRB     R2,[R0, #+28]
   \   000002D8   070052E1           CMP      R2,R7
   \   000002DC   020000AA           BGE      ??_OnKey_25
   \   000002E0   020011E3           TST      R1,#0x2
   \   000002E4   0860A001           MOVEQ    R6,R8
   \   000002E8   0270A0E1           MOV      R7,R2
   \                     ??_OnKey_25:
   \   000002EC   088090E5           LDR      R8,[R0, #+8]
   \   000002F0   000058E3           CMP      R8,#+0
   \   000002F4   EDFFFF1A           BNE      ??_OnKey_26
   \   000002F8   ........           BL       GUI_ALLOC_UnlockH
   \   000002FC   000056E3           CMP      R6,#+0
   \   00000300   0560A001           MOVEQ    R6,R5
   1582              }
   \   00000304   B0FFFFEA           B        ??_OnKey_20
   1583              break;
   1584            case GUI_KEY_HOME:
   1585              if (hFirst) {
   \                     ??_OnKey_7:
   \   00000308   000056E3           CMP      R6,#+0
   \   0000030C   4300000A           BEQ      ??_OnKey_1
   1586                _SetSel(hObj, hFirst);
   \   00000310   0400A0E1           MOV      R0,R4
   \   00000314   ........           BL       GUI_ALLOC_LockH
   \   00000318   A85090E5           LDR      R5,[R0, #+168]
   \   0000031C   A86080E5           STR      R6,[R0, #+168]
   \   00000320   ........           BL       GUI_ALLOC_UnlockH
   \   00000324   0400A0E1           MOV      R0,R4
   \   00000328   ........           BL       _UpdateScrollPos
   \   0000032C   000050E3           CMP      R0,#+0
   \   00000330   1D00001A           BNE      ??_OnKey_21
   \   00000334   0D20A0E1           MOV      R2,SP
   \   00000338   0510A0E1           MOV      R1,R5
   \   0000033C   0400A0E1           MOV      R0,R4
   \   00000340   ........           BL       _GetVisibility
   \   00000344   000050E3           CMP      R0,#+0
   \   00000348   01005013           CMPNE    R0,#+1
   \   0000034C   0200001A           BNE      ??_OnKey_27
   \   00000350   0D10A0E1           MOV      R1,SP
   \   00000354   0400A0E1           MOV      R0,R4
   \   00000358   ........           BL       WM_InvalidateRect
   \                     ??_OnKey_27:
   \   0000035C   0D20A0E1           MOV      R2,SP
   \   00000360   0610A0E1           MOV      R1,R6
   \   00000364   1F0000EA           B        ??_OnKey_23
   1587              }
   1588              break;
   1589            case GUI_KEY_END:
   1590              if (hSel) {
   \                     ??_OnKey_8:
   \   00000368   000055E3           CMP      R5,#+0
   \   0000036C   2B00000A           BEQ      ??_OnKey_1
   1591                _SetSel(hObj, _GetLastVisibleItem(hSel));
   \                     ??_OnKey_28:
   \   00000370   0560A0E1           MOV      R6,R5
   \   00000374   0500A0E1           MOV      R0,R5
   \   00000378   ........           BL       _GetNextVisibleItem
   \   0000037C   0050A0E1           MOV      R5,R0
   \   00000380   060055E1           CMP      R5,R6
   \   00000384   F9FFFF1A           BNE      ??_OnKey_28
   \   00000388   0400A0E1           MOV      R0,R4
   \   0000038C   ........           BL       GUI_ALLOC_LockH
   \   00000390   A86090E5           LDR      R6,[R0, #+168]
   \   00000394   A85080E5           STR      R5,[R0, #+168]
   \   00000398   ........           BL       GUI_ALLOC_UnlockH
   \   0000039C   0400A0E1           MOV      R0,R4
   \   000003A0   ........           BL       _UpdateScrollPos
   \   000003A4   000050E3           CMP      R0,#+0
   \   000003A8   0200000A           BEQ      ??_OnKey_24
   \                     ??_OnKey_21:
   \   000003AC   0400A0E1           MOV      R0,R4
   \   000003B0   ........           BL       WM_InvalidateWindow
   \   000003B4   130000EA           B        ??_OnKey_29
   \                     ??_OnKey_24:
   \   000003B8   0D20A0E1           MOV      R2,SP
   \   000003BC   0610A0E1           MOV      R1,R6
   \   000003C0   0400A0E1           MOV      R0,R4
   \   000003C4   ........           BL       _GetVisibility
   \   000003C8   000050E3           CMP      R0,#+0
   \   000003CC   01005013           CMPNE    R0,#+1
   \   000003D0   0200001A           BNE      ??_OnKey_30
   \   000003D4   0D10A0E1           MOV      R1,SP
   \   000003D8   0400A0E1           MOV      R0,R4
   \   000003DC   ........           BL       WM_InvalidateRect
   \                     ??_OnKey_30:
   \   000003E0   0D20A0E1           MOV      R2,SP
   \   000003E4   0510A0E1           MOV      R1,R5
   \                     ??_OnKey_23:
   \   000003E8   0400A0E1           MOV      R0,R4
   \   000003EC   ........           BL       _GetVisibility
   \   000003F0   000050E3           CMP      R0,#+0
   \   000003F4   01005013           CMPNE    R0,#+1
   \   000003F8   0200001A           BNE      ??_OnKey_29
   \   000003FC   0D10A0E1           MOV      R1,SP
   \   00000400   0400A0E1           MOV      R0,R4
   \   00000404   ........           BL       WM_InvalidateRect
   \                     ??_OnKey_29:
   \   00000408   0410A0E3           MOV      R1,#+4
   \   0000040C   0400A0E1           MOV      R0,R4
   \   00000410   ........           BL       WM_NotifyParent
   1592              }
   \   00000414   010000EA           B        ??_OnKey_1
   1593              break;
   1594            default:
   1595              WM_DefaultProc(pMsg);
   \                     ??_OnKey_2:
   \   00000418   0700A0E1           MOV      R0,R7
   \   0000041C   ........           BL       WM_DefaultProc
   \                     ??_OnKey_1:
   \   00000420   08D08DE2           ADD      SP,SP,#+8        ;; stack cleaning
   \   00000424   F081BDE8           POP      {R4-R8,PC}       ;; return
   1596            }
   1597          }
   1598          
   1599          /*********************************************************************
   1600          *
   1601          *       _SetAutoScroll
   1602          */
   1603          static void _SetAutoScroll(TREEVIEW_Handle hObj, int State, int Mask) {
   1604            TREEVIEW_OBJ * pObj;
   1605            char NewFlags, OldFlags;
   1606            pObj = TREEVIEW_LOCK_H(hObj);
   1607            OldFlags = pObj->Flags;
   1608            NewFlags = OldFlags & (~Mask);
   1609            GUI_UNLOCK_H(pObj);
   1610            if (State) {
   1611              NewFlags |= Mask;
   1612            } else {
   1613              WM_SetScrollbarH(hObj, 0);
   1614            }
   1615            if (OldFlags != NewFlags) {
   1616              pObj = TREEVIEW_LOCK_H(hObj);
   1617              pObj->Flags = NewFlags;
   1618              GUI_UNLOCK_H(pObj);
   1619              _CalcParams(hObj);
   1620              _ManageAutoScroll(hObj);
   1621              WM_InvalidateWindow(hObj);
   1622            }
   1623          }
   1624          
   1625          /*********************************************************************
   1626          *
   1627          *       _OnDelete
   1628          */
   1629          static void _OnDelete(TREEVIEW_Handle hObj) {
   1630            TREEVIEW_OBJ * pObj;
   1631            TREEVIEW_ITEM_Handle hFree;
   1632            TREEVIEW_ITEM_Handle hItem;
   1633            TREEVIEW_ITEM_OBJ  * pItem;
   1634            pObj = TREEVIEW_LOCK_H(hObj);
   1635            hItem = pObj->hFirst;
   1636            GUI_UNLOCK_H(pObj);
   1637            while (hItem) {
   1638              hFree = hItem;
   1639              pItem = (TREEVIEW_ITEM_OBJ *)GUI_LOCK_H(hItem);
   1640              if (pItem->hData) {
   1641                GUI_ALLOC_Free(pItem->hData);
   1642              }
   1643              hItem = pItem->hNext;
   1644              GUI_UNLOCK_H(pItem);
   1645              GUI_ALLOC_Free(hFree);
   1646            }
   1647          }
   1648          
   1649          /*********************************************************************
   1650          *
   1651          *       _LinkItem
   1652          */

   \                                 In section .text, align 4, keep-with-next
   1653          static int _LinkItem(TREEVIEW_Handle hObj, TREEVIEW_ITEM_Handle hItemNew, TREEVIEW_ITEM_Handle hItemAt, int Position) {
   \                     _LinkItem:
   \   00000000   F04F2DE9           PUSH     {R4-R11,LR}
   \   00000004   0180A0E1           MOV      R8,R1
   \   00000008   0CD04DE2           SUB      SP,SP,#+12
   1654            TREEVIEW_OBJ * pObj;
   1655            TREEVIEW_ITEM_OBJ  * pItemNew;
   1656            TREEVIEW_ITEM_Handle hItemPrev;
   1657            TREEVIEW_ITEM_OBJ  * pItemPrev;
   1658            TREEVIEW_ITEM_Handle hItemNext;
   1659            TREEVIEW_ITEM_OBJ  * pItemNext;
   1660            int Level;
   1661            int r = 0;
   \   0000000C   0010A0E3           MOV      R1,#+0
   \   00000010   0050A0E1           MOV      R5,R0
   \   00000014   02B0A0E1           MOV      R11,R2
   \   00000018   0340A0E1           MOV      R4,R3
   \   0000001C   00108DE5           STR      R1,[SP, #+0]
   1662            pObj     = TREEVIEW_LOCK_H(hObj);
   \   00000020   ........           BL       GUI_ALLOC_LockH
   \   00000024   0070A0E1           MOV      R7,R0
   1663            pItemNew = (TREEVIEW_ITEM_OBJ *)GUI_LOCK_H(hItemNew);
   \   00000028   0800A0E1           MOV      R0,R8
   \   0000002C   ........           BL       GUI_ALLOC_LockH
   \   00000030   0060A0E1           MOV      R6,R0
   1664            if (pObj->NumItems) {
   \   00000034   B00097E5           LDR      R0,[R7, #+176]
   \   00000038   000050E3           CMP      R0,#+0
   \   0000003C   7400000A           BEQ      ??_LinkItem_0
   1665              /*
   1666              * Manage indenting
   1667              */
   1668              if (hItemAt) {
   \   00000040   00005BE3           CMP      R11,#+0
   \   00000044   6F00000A           BEQ      ??_LinkItem_1
   1669                if (Position == TREEVIEW_INSERT_FIRST_CHILD) {
   \   00000048   020054E3           CMP      R4,#+2
   \   0000004C   2000001A           BNE      ??_LinkItem_2
   1670                  hItemPrev = hItemAt;
   1671                  pItemPrev = (TREEVIEW_ITEM_OBJ *)GUI_LOCK_H(hItemPrev);
   \   00000050   0B00A0E1           MOV      R0,R11
   \   00000054   ........           BL       GUI_ALLOC_LockH
   \   00000058   0090A0E1           MOV      R9,R0
   1672                  if (pItemPrev->Flags & TREEVIEW_ITEM_TYPE_NODE) {
   \   0000005C   1800D9E5           LDRB     R0,[R9, #+24]
   \   00000060   010010E3           TST      R0,#0x1
   \   00000064   0F00000A           BEQ      ??_LinkItem_3
   1673                    hItemNext = pItemPrev->hNext;
   \   00000068   04A099E5           LDR      R10,[R9, #+4]
   1674                    if (hItemNext) {
   \   0000006C   00005AE3           CMP      R10,#+0
   \   00000070   0400000A           BEQ      ??_LinkItem_4
   1675                      pItemNext = (TREEVIEW_ITEM_OBJ *)GUI_LOCK_H(hItemNext);
   1676                      pItemNext->hPrev = hItemNew;
   \   00000074   0A00A0E1           MOV      R0,R10
   \   00000078   ........           BL       GUI_ALLOC_LockH
   \   0000007C   088080E5           STR      R8,[R0, #+8]
   1677                      GUI_UNLOCK_H(pItemNext);
   \   00000080   ........           BL       GUI_ALLOC_UnlockH
   \   00000084   000000EA           B        ??_LinkItem_5
   1678                    } else {
   1679                      pObj->hLast = hItemNew;
   \                     ??_LinkItem_4:
   \   00000088   A48087E5           STR      R8,[R7, #+164]
   1680                    }
   1681                    pItemPrev->hNext = hItemNew;
   \                     ??_LinkItem_5:
   \   0000008C   048089E5           STR      R8,[R9, #+4]
   1682                    pItemNew->hNext  = hItemNext;
   \   00000090   04A086E5           STR      R10,[R6, #+4]
   1683                    pItemNew->hPrev  = hItemPrev;
   \   00000094   08B086E5           STR      R11,[R6, #+8]
   1684                    pItemNew->Level  = pItemPrev->Level + 1;
   \   00000098   1C00D9E5           LDRB     R0,[R9, #+28]
   \   0000009C   010080E2           ADD      R0,R0,#+1
   \   000000A0   1C00C6E5           STRB     R0,[R6, #+28]
   \   000000A4   010000EA           B        ??_LinkItem_6
   1685                  } else {
   1686                    GUI_DEBUG_ERROROUT("_LinkItem: Can not be indented at a leaf!");
   1687                    r = 1;
   \                     ??_LinkItem_3:
   \   000000A8   0110A0E3           MOV      R1,#+1
   \   000000AC   00108DE5           STR      R1,[SP, #+0]
   1688                  }
   1689                  GUI_UNLOCK_H(pItemPrev);
   \                     ??_LinkItem_6:
   \   000000B0   ........           BL       GUI_ALLOC_UnlockH
   1690                } else if (Position == TREEVIEW_INSERT_ABOVE) {
   1691                  /*
   1692                  * Insert item above the given item
   1693                  */
   1694                  hItemNext = hItemAt;
   1695                  pItemNext = (TREEVIEW_ITEM_OBJ *)GUI_LOCK_H(hItemNext);
   1696                  hItemPrev = pItemNext->hPrev;
   1697                  if (hItemPrev) {
   1698                    pItemPrev = (TREEVIEW_ITEM_OBJ *)GUI_LOCK_H(hItemPrev);
   1699                    pItemPrev->hNext  = hItemNew;
   1700                    GUI_UNLOCK_H(pItemPrev);
   1701                  } else {
   1702                    pObj->hFirst = hItemNew;
   1703                  }
   1704                  pItemNext->hPrev = hItemNew;
   1705                  pItemNew->hNext  = hItemNext;
   1706                  pItemNew->hPrev  = hItemPrev;
   1707                  pItemNew->Level  = pItemNext->Level;
   1708                  GUI_UNLOCK_H(pItemNext);
   1709                } else if (Position == TREEVIEW_INSERT_BELOW) {
   1710                  /*
   1711                  * Insert item below the given item
   1712                  */
   1713                  hItemPrev = hItemAt;
   1714                  pItemPrev = (TREEVIEW_ITEM_OBJ *)GUI_LOCK_H(hItemPrev);
   1715                  Level     = pItemPrev->Level;
   1716                  GUI_UNLOCK_H(pItemPrev);
   1717                  hItemPrev = _GetLastNodeItem(hItemAt);
   1718                  if (hItemPrev) {
   1719                    pItemPrev = (TREEVIEW_ITEM_OBJ *)GUI_LOCK_H(hItemPrev);
   1720                    hItemNext = pItemPrev->hNext;
   1721                  } else {
   1722                    pItemPrev = (TREEVIEW_ITEM_OBJ *)GUI_LOCK_H(hItemAt);
   1723                    hItemNext = pItemPrev->hNext;
   1724                  }
   1725                  if (hItemNext) {
   1726                    pItemNext = (TREEVIEW_ITEM_OBJ *)GUI_LOCK_H(hItemNext);
   1727                    pItemNext->hPrev = hItemNew;
   1728                    GUI_UNLOCK_H(pItemNext);
   1729                  } else {
   1730                    pObj->hLast = hItemNew;
   1731                  }
   1732                  pItemPrev->hNext = hItemNew;
   1733                  pItemNew->hNext  = hItemNext;
   1734                  pItemNew->hPrev  = hItemPrev;
   1735                  pItemNew->Level  = Level;
   1736                  GUI_UNLOCK_H(pItemPrev);
   1737                }
   1738              } else {
   1739                GUI_DEBUG_ERROROUT("_LinkItem: Position has not been defined!");
   1740                r = 1;
   1741              }
   1742            } else {
   1743              /*
   1744              * Manage the first item
   1745              */
   1746              if (pObj->hFirst == 0) {
   1747                pObj->hFirst = pObj->hLast = pObj->hSel = hItemNew;
   1748                pItemNew->hNext = 0;
   1749                pItemNew->hPrev = 0;
   1750              } else {
   1751                GUI_DEBUG_ERROROUT("_LinkItem: First item already exists!");
   1752                r = 1;
   1753              }
   1754            }
   1755            if (r == 0) {
   \   000000B4   00009DE5           LDR      R0,[SP, #+0]
   \   000000B8   000050E3           CMP      R0,#+0
   \   000000BC   5D00000A           BEQ      ??_LinkItem_7
   1756              pObj->NumItems++;
   1757              GUI_UNLOCK_H(pObj);
   1758              pItemNew->hParent = hObj;
   1759              GUI_UNLOCK_H(pItemNew);
   1760              _CalcParams(hObj);
   1761              _ManageAutoScroll(hObj);
   1762              WM_InvalidateWindow(hObj);
   1763            } else {
   1764              GUI_UNLOCK_H(pObj);
   \                     ??_LinkItem_8:
   \   000000C0   ........           BL       GUI_ALLOC_UnlockH
   1765              GUI_UNLOCK_H(pItemNew);
   \   000000C4   ........           BL       GUI_ALLOC_UnlockH
   1766            }
   1767            return r;
   \                     ??_LinkItem_9:
   \   000000C8   00009DE5           LDR      R0,[SP, #+0]
   \   000000CC   0CD08DE2           ADD      SP,SP,#+12
   \   000000D0   F08FBDE8           POP      {R4-R11,PC}      ;; return
   \                     ??_LinkItem_2:
   \   000000D4   000054E3           CMP      R4,#+0
   \   000000D8   1200001A           BNE      ??_LinkItem_10
   \   000000DC   0B00A0E1           MOV      R0,R11
   \   000000E0   ........           BL       GUI_ALLOC_LockH
   \   000000E4   0090A0E1           MOV      R9,R0
   \   000000E8   08A099E5           LDR      R10,[R9, #+8]
   \   000000EC   00005AE3           CMP      R10,#+0
   \   000000F0   0400000A           BEQ      ??_LinkItem_11
   \   000000F4   0A00A0E1           MOV      R0,R10
   \   000000F8   ........           BL       GUI_ALLOC_LockH
   \   000000FC   048080E5           STR      R8,[R0, #+4]
   \   00000100   ........           BL       GUI_ALLOC_UnlockH
   \   00000104   000000EA           B        ??_LinkItem_12
   \                     ??_LinkItem_11:
   \   00000108   A08087E5           STR      R8,[R7, #+160]
   \                     ??_LinkItem_12:
   \   0000010C   088089E5           STR      R8,[R9, #+8]
   \   00000110   04B086E5           STR      R11,[R6, #+4]
   \   00000114   08A086E5           STR      R10,[R6, #+8]
   \   00000118   1C00D9E5           LDRB     R0,[R9, #+28]
   \                     ??_LinkItem_13:
   \   0000011C   1C00C6E5           STRB     R0,[R6, #+28]
   \   00000120   ........           BL       GUI_ALLOC_UnlockH
   \   00000124   430000EA           B        ??_LinkItem_7
   \                     ??_LinkItem_10:
   \   00000128   010054E3           CMP      R4,#+1
   \   0000012C   4100001A           BNE      ??_LinkItem_7
   \   00000130   0B00A0E1           MOV      R0,R11
   \   00000134   ........           BL       GUI_ALLOC_LockH
   \   00000138   1C00D0E5           LDRB     R0,[R0, #+28]
   \   0000013C   08008DE5           STR      R0,[SP, #+8]
   \   00000140   ........           BL       GUI_ALLOC_UnlockH
   \   00000144   0B00A0E1           MOV      R0,R11
   \   00000148   ........           BL       GUI_ALLOC_LockH
   \   0000014C   1C20D0E5           LDRB     R2,[R0, #+28]
   \   00000150   0B90A0E1           MOV      R9,R11
   \   00000154   04208DE5           STR      R2,[SP, #+4]
   \   00000158   1810D0E5           LDRB     R1,[R0, #+24]
   \   0000015C   010011E3           TST      R1,#0x1
   \   00000160   04A09015           LDRNE    R10,[R0, #+4]
   \   00000164   00005A13           CMPNE    R10,#+0
   \   00000168   1200000A           BEQ      ??_LinkItem_14
   \   0000016C   0A00A0E1           MOV      R0,R10
   \   00000170   ........           BL       GUI_ALLOC_LockH
   \   00000174   060000EA           B        ??_LinkItem_15
   \                     ??_LinkItem_16:
   \   00000178   ........           BL       GUI_ALLOC_UnlockH
   \   0000017C   0A00A0E1           MOV      R0,R10
   \   00000180   ........           BL       GUI_ALLOC_LockH
   \   00000184   1C20D0E5           LDRB     R2,[R0, #+28]
   \   00000188   04109DE5           LDR      R1,[SP, #+4]
   \   0000018C   020051E1           CMP      R1,R2
   \   00000190   0A90A0B1           MOVLT    R9,R10
   \                     ??_LinkItem_15:
   \   00000194   1C20D0E5           LDRB     R2,[R0, #+28]
   \   00000198   04109DE5           LDR      R1,[SP, #+4]
   \   0000019C   020051E1           CMP      R1,R2
   \   000001A0   030000AA           BGE      ??_LinkItem_17
   \   000001A4   0A90A0E1           MOV      R9,R10
   \   000001A8   04A090E5           LDR      R10,[R0, #+4]
   \   000001AC   00005AE3           CMP      R10,#+0
   \   000001B0   F0FFFF1A           BNE      ??_LinkItem_16
   \                     ??_LinkItem_17:
   \   000001B4   ........           BL       GUI_ALLOC_UnlockH
   \                     ??_LinkItem_14:
   \   000001B8   ........           BL       GUI_ALLOC_UnlockH
   \   000001BC   000059E3           CMP      R9,#+0
   \   000001C0   0900A011           MOVNE    R0,R9
   \   000001C4   0B00A001           MOVEQ    R0,R11
   \   000001C8   ........           BL       GUI_ALLOC_LockH
   \   000001CC   00B0A0E1           MOV      R11,R0
   \   000001D0   04A09BE5           LDR      R10,[R11, #+4]
   \   000001D4   00005AE3           CMP      R10,#+0
   \   000001D8   0400000A           BEQ      ??_LinkItem_18
   \   000001DC   0A00A0E1           MOV      R0,R10
   \   000001E0   ........           BL       GUI_ALLOC_LockH
   \   000001E4   088080E5           STR      R8,[R0, #+8]
   \   000001E8   ........           BL       GUI_ALLOC_UnlockH
   \   000001EC   000000EA           B        ??_LinkItem_19
   \                     ??_LinkItem_18:
   \   000001F0   A48087E5           STR      R8,[R7, #+164]
   \                     ??_LinkItem_19:
   \   000001F4   04808BE5           STR      R8,[R11, #+4]
   \   000001F8   04A086E5           STR      R10,[R6, #+4]
   \   000001FC   089086E5           STR      R9,[R6, #+8]
   \   00000200   08009DE5           LDR      R0,[SP, #+8]
   \   00000204   C4FFFFEA           B        ??_LinkItem_13
   \                     ??_LinkItem_1:
   \   00000208   0110A0E3           MOV      R1,#+1
   \   0000020C   00108DE5           STR      R1,[SP, #+0]
   \   00000210   AAFFFFEA           B        ??_LinkItem_8
   \                     ??_LinkItem_0:
   \   00000214   A00097E5           LDR      R0,[R7, #+160]
   \   00000218   000050E3           CMP      R0,#+0
   \   0000021C   F9FFFF1A           BNE      ??_LinkItem_1
   \   00000220   A88087E5           STR      R8,[R7, #+168]
   \   00000224   A48087E5           STR      R8,[R7, #+164]
   \   00000228   A08087E5           STR      R8,[R7, #+160]
   \   0000022C   0040A0E3           MOV      R4,#+0
   \   00000230   044086E5           STR      R4,[R6, #+4]
   \   00000234   084086E5           STR      R4,[R6, #+8]
   \                     ??_LinkItem_7:
   \   00000238   B00097E5           LDR      R0,[R7, #+176]
   \   0000023C   010080E2           ADD      R0,R0,#+1
   \   00000240   B00087E5           STR      R0,[R7, #+176]
   \   00000244   ........           BL       GUI_ALLOC_UnlockH
   \   00000248   005086E5           STR      R5,[R6, #+0]
   \   0000024C   ........           BL       GUI_ALLOC_UnlockH
   \   00000250   0500A0E1           MOV      R0,R5
   \   00000254   ........           BL       _CalcParams
   \   00000258   0500A0E1           MOV      R0,R5
   \   0000025C   ........           BL       _ManageAutoScroll
   \   00000260   0500A0E1           MOV      R0,R5
   \   00000264   ........           BL       WM_InvalidateWindow
   \   00000268   96FFFFEA           B        ??_LinkItem_9
   1768          }
   1769          
   1770          /*********************************************************************
   1771          *
   1772          *       _SetColor
   1773          */
   1774          static void _SetColor(TREEVIEW_Handle hObj, int Index, GUI_COLOR Color, int ArrayIndex) {
   1775            TREEVIEW_OBJ * pObj;
   1776            if (hObj) {
   1777              WM_LOCK();
   1778              pObj = TREEVIEW_LOCK_H(hObj);
   1779              if (Index < GUI_COUNTOF(pObj->Props.aBkColor)) {
   1780                switch (ArrayIndex) {
   1781                case TREEVIEW_COLORS_BK:
   1782                  pObj->Props.aBkColor[Index] = Color;
   1783                  break;
   1784                case TREEVIEW_COLORS_TEXT:
   1785                  pObj->Props.aTextColor[Index] = Color;
   1786                  break;
   1787                case TREEVIEW_COLORS_LINE:
   1788                  pObj->Props.aLineColor[Index] = Color;
   1789                  break;
   1790                }
   1791              }
   1792              GUI_UNLOCK_H(pObj);
   1793              WM_UNLOCK();
   1794            }
   1795          }
   1796          
   1797          /*********************************************************************
   1798          *
   1799          *       _MoveSel
   1800          */

   \                                 In section .text, align 4, keep-with-next
   1801          static void _MoveSel(TREEVIEW_Handle hObj, int Off) {
   \                     _MoveSel:
   \   00000000   F0432DE9           PUSH     {R4-R9,LR}
   \   00000004   0CD04DE2           SUB      SP,SP,#+12
   \   00000008   0050A0E1           MOV      R5,R0
   \   0000000C   0160B0E1           MOVS     R6,R1
   1802            TREEVIEW_ITEM_Handle hSel;
   1803            if (Off) {
   \   00000010   7F00000A           BEQ      ??_MoveSel_0
   1804              WM_LOCK();
   \   00000014   ........           BL       GUI_Lock
   1805              if (Off < 0) {
   \   00000018   000056E3           CMP      R6,#+0
   \   0000001C   4900005A           BPL      ??_MoveSel_1
   1806                do {
   1807                  hSel = TREEVIEW_GetSel(hObj);
   \                     ??_MoveSel_2:
   \   00000020   000055E3           CMP      R5,#+0
   \   00000024   4400000A           BEQ      ??_MoveSel_3
   \   00000028   ........           BL       GUI_Lock
   \   0000002C   0500A0E1           MOV      R0,R5
   \   00000030   ........           BL       GUI_ALLOC_LockH
   \   00000034   A87090E5           LDR      R7,[R0, #+168]
   \   00000038   ........           BL       GUI_ALLOC_UnlockH
   \   0000003C   ........           BL       GUI_Unlock
   1808                  if (hSel) {
   \   00000040   000057E3           CMP      R7,#+0
   \   00000044   3C00000A           BEQ      ??_MoveSel_3
   1809                    _SetSel(hObj, _GetPrevVisibleItem(hSel));
   \   00000048   0040A0E3           MOV      R4,#+0
   \   0000004C   0700A0E1           MOV      R0,R7
   \   00000050   ........           BL       GUI_ALLOC_LockH
   \   00000054   1C90D0E5           LDRB     R9,[R0, #+28]
   \   00000058   0E0000EA           B        ??_MoveSel_4
   \                     ??_MoveSel_5:
   \   0000005C   ........           BL       GUI_ALLOC_UnlockH
   \   00000060   0800A0E1           MOV      R0,R8
   \   00000064   ........           BL       GUI_ALLOC_LockH
   \   00000068   B811D0E1           LDRH     R1,[R0, #+24]
   \   0000006C   000054E3           CMP      R4,#+0
   \   00000070   0840A001           MOVEQ    R4,R8
   \   00000074   1C90D005           LDRBEQ   R9,[R0, #+28]
   \   00000078   010011E3           TST      R1,#0x1
   \   0000007C   0500000A           BEQ      ??_MoveSel_4
   \   00000080   1C20D0E5           LDRB     R2,[R0, #+28]
   \   00000084   090052E1           CMP      R2,R9
   \   00000088   020000AA           BGE      ??_MoveSel_4
   \   0000008C   020011E3           TST      R1,#0x2
   \   00000090   0840A001           MOVEQ    R4,R8
   \   00000094   0290A0E1           MOV      R9,R2
   \                     ??_MoveSel_4:
   \   00000098   088090E5           LDR      R8,[R0, #+8]
   \   0000009C   000058E3           CMP      R8,#+0
   \   000000A0   EDFFFF1A           BNE      ??_MoveSel_5
   \   000000A4   ........           BL       GUI_ALLOC_UnlockH
   \   000000A8   000054E3           CMP      R4,#+0
   \   000000AC   0470A011           MOVNE    R7,R4
   \   000000B0   0500A0E1           MOV      R0,R5
   \   000000B4   ........           BL       GUI_ALLOC_LockH
   \   000000B8   A84090E5           LDR      R4,[R0, #+168]
   \   000000BC   A87080E5           STR      R7,[R0, #+168]
   \   000000C0   ........           BL       GUI_ALLOC_UnlockH
   \   000000C4   0500A0E1           MOV      R0,R5
   \   000000C8   ........           BL       _UpdateScrollPos
   \   000000CC   000050E3           CMP      R0,#+0
   \   000000D0   0200000A           BEQ      ??_MoveSel_6
   \   000000D4   0500A0E1           MOV      R0,R5
   \   000000D8   ........           BL       WM_InvalidateWindow
   \   000000DC   130000EA           B        ??_MoveSel_7
   \                     ??_MoveSel_6:
   \   000000E0   0D20A0E1           MOV      R2,SP
   \   000000E4   0410A0E1           MOV      R1,R4
   \   000000E8   0500A0E1           MOV      R0,R5
   \   000000EC   ........           BL       _GetVisibility
   \   000000F0   000050E3           CMP      R0,#+0
   \   000000F4   01005013           CMPNE    R0,#+1
   \   000000F8   0200001A           BNE      ??_MoveSel_8
   \   000000FC   0D10A0E1           MOV      R1,SP
   \   00000100   0500A0E1           MOV      R0,R5
   \   00000104   ........           BL       WM_InvalidateRect
   \                     ??_MoveSel_8:
   \   00000108   0D20A0E1           MOV      R2,SP
   \   0000010C   0710A0E1           MOV      R1,R7
   \   00000110   0500A0E1           MOV      R0,R5
   \   00000114   ........           BL       _GetVisibility
   \   00000118   000050E3           CMP      R0,#+0
   \   0000011C   01005013           CMPNE    R0,#+1
   \   00000120   0200001A           BNE      ??_MoveSel_7
   \   00000124   0D10A0E1           MOV      R1,SP
   \   00000128   0500A0E1           MOV      R0,R5
   \   0000012C   ........           BL       WM_InvalidateRect
   \                     ??_MoveSel_7:
   \   00000130   0410A0E3           MOV      R1,#+4
   \   00000134   0500A0E1           MOV      R0,R5
   \   00000138   ........           BL       WM_NotifyParent
   1810                  }
   1811                } while (++Off);
   \                     ??_MoveSel_3:
   \   0000013C   016096E2           ADDS     R6,R6,#+1
   \   00000140   B6FFFF1A           BNE      ??_MoveSel_2
   \   00000144   310000EA           B        ??_MoveSel_9
   1812              } else {
   1813                do {
   1814                  hSel = TREEVIEW_GetSel(hObj);
   \                     ??_MoveSel_1:
   \   00000148   000055E3           CMP      R5,#+0
   \   0000014C   2D00000A           BEQ      ??_MoveSel_10
   \   00000150   ........           BL       GUI_Lock
   \   00000154   0500A0E1           MOV      R0,R5
   \   00000158   ........           BL       GUI_ALLOC_LockH
   \   0000015C   A84090E5           LDR      R4,[R0, #+168]
   \   00000160   ........           BL       GUI_ALLOC_UnlockH
   \   00000164   ........           BL       GUI_Unlock
   1815                  if (hSel) {
   \   00000168   000054E3           CMP      R4,#+0
   \   0000016C   2500000A           BEQ      ??_MoveSel_10
   1816                    _SetSel(hObj, _GetNextVisibleItem(hSel));
   \   00000170   0400A0E1           MOV      R0,R4
   \   00000174   ........           BL       _GetNextVisibleItem
   \   00000178   0040A0E1           MOV      R4,R0
   \   0000017C   0500A0E1           MOV      R0,R5
   \   00000180   ........           BL       GUI_ALLOC_LockH
   \   00000184   A87090E5           LDR      R7,[R0, #+168]
   \   00000188   A84080E5           STR      R4,[R0, #+168]
   \   0000018C   ........           BL       GUI_ALLOC_UnlockH
   \   00000190   0500A0E1           MOV      R0,R5
   \   00000194   ........           BL       _UpdateScrollPos
   \   00000198   000050E3           CMP      R0,#+0
   \   0000019C   0200000A           BEQ      ??_MoveSel_11
   \   000001A0   0500A0E1           MOV      R0,R5
   \   000001A4   ........           BL       WM_InvalidateWindow
   \   000001A8   130000EA           B        ??_MoveSel_12
   \                     ??_MoveSel_11:
   \   000001AC   0D20A0E1           MOV      R2,SP
   \   000001B0   0710A0E1           MOV      R1,R7
   \   000001B4   0500A0E1           MOV      R0,R5
   \   000001B8   ........           BL       _GetVisibility
   \   000001BC   000050E3           CMP      R0,#+0
   \   000001C0   01005013           CMPNE    R0,#+1
   \   000001C4   0200001A           BNE      ??_MoveSel_13
   \   000001C8   0D10A0E1           MOV      R1,SP
   \   000001CC   0500A0E1           MOV      R0,R5
   \   000001D0   ........           BL       WM_InvalidateRect
   \                     ??_MoveSel_13:
   \   000001D4   0D20A0E1           MOV      R2,SP
   \   000001D8   0410A0E1           MOV      R1,R4
   \   000001DC   0500A0E1           MOV      R0,R5
   \   000001E0   ........           BL       _GetVisibility
   \   000001E4   000050E3           CMP      R0,#+0
   \   000001E8   01005013           CMPNE    R0,#+1
   \   000001EC   0200001A           BNE      ??_MoveSel_12
   \   000001F0   0D10A0E1           MOV      R1,SP
   \   000001F4   0500A0E1           MOV      R0,R5
   \   000001F8   ........           BL       WM_InvalidateRect
   \                     ??_MoveSel_12:
   \   000001FC   0410A0E3           MOV      R1,#+4
   \   00000200   0500A0E1           MOV      R0,R5
   \   00000204   ........           BL       WM_NotifyParent
   1817                  }
   1818                } while (--Off);
   \                     ??_MoveSel_10:
   \   00000208   016056E2           SUBS     R6,R6,#+1
   \   0000020C   CDFFFF1A           BNE      ??_MoveSel_1
   1819              }
   1820              WM_UNLOCK();
   \                     ??_MoveSel_9:
   \   00000210   ........           BL       GUI_Unlock
   1821            }
   1822          }
   \                     ??_MoveSel_0:
   \   00000214   0CD08DE2           ADD      SP,SP,#+12       ;; stack cleaning
   \   00000218   F083BDE8           POP      {R4-R9,PC}       ;; return
   1823          
   1824          /*********************************************************************
   1825          *
   1826          *       Exported routines, common
   1827          *
   1828          **********************************************************************
   1829          */
   1830          /*********************************************************************
   1831          *
   1832          *       TREEVIEW_Callback
   1833          */

   \                                 In section .text, align 4, keep-with-next
   1834          void TREEVIEW_Callback(WM_MESSAGE * pMsg) {
   \                     TREEVIEW_Callback:
   \   00000000   F0402DE9           PUSH     {R4-R7,LR}
   \   00000004   0050A0E1           MOV      R5,R0
   1835            TREEVIEW_Handle hObj;
   1836            TREEVIEW_OBJ * pObj;
   1837            WM_SCROLL_STATE ScrollState;
   1838            GUI_TIMER_HANDLE hTimer;
   1839            hObj = pMsg->hWin;
   \   00000008   044095E5           LDR      R4,[R5, #+4]
   \   0000000C   0CD04DE2           SUB      SP,SP,#+12
   1840            /* Let widget handle the standard messages */
   1841            if (WIDGET_HandleActive(hObj, pMsg) == 0) {
   \   00000010   0510A0E1           MOV      R1,R5
   \   00000014   0400A0E1           MOV      R0,R4
   \   00000018   ........           BL       WIDGET_HandleActive
   \   0000001C   000050E3           CMP      R0,#+0
   \   00000020   6700000A           BEQ      ??TREEVIEW_Callback_0
   1842              return;
   1843            }
   1844            switch (pMsg->MsgId) {
   \   00000024   000095E5           LDR      R0,[R5, #+0]
   \   00000028   0B0050E2           SUBS     R0,R0,#+11
   \   0000002C   0A00000A           BEQ      ??TREEVIEW_Callback_1
   \   00000030   010050E2           SUBS     R0,R0,#+1
   \   00000034   2A00000A           BEQ      ??TREEVIEW_Callback_2
   \   00000038   020050E2           SUBS     R0,R0,#+2
   \   0000003C   2C00000A           BEQ      ??TREEVIEW_Callback_3
   \   00000040   010050E2           SUBS     R0,R0,#+1
   \   00000044   2200000A           BEQ      ??TREEVIEW_Callback_4
   \   00000048   170050E2           SUBS     R0,R0,#+23
   \   0000004C   3200000A           BEQ      ??TREEVIEW_Callback_5
   \   00000050   ED0050E2           SUBS     R0,R0,#+237
   \   00000054   1500000A           BEQ      ??TREEVIEW_Callback_6
   \   00000058   590000EA           B        ??TREEVIEW_Callback_0
   1845            case WM_DELETE:
   1846              _OnDelete(hObj);
   \                     ??TREEVIEW_Callback_1:
   \   0000005C   0400A0E1           MOV      R0,R4
   \   00000060   ........           BL       GUI_ALLOC_LockH
   \   00000064   A04090E5           LDR      R4,[R0, #+160]
   \   00000068   ........           BL       GUI_ALLOC_UnlockH
   \   0000006C   000054E3           CMP      R4,#+0
   \   00000070   5300000A           BEQ      ??TREEVIEW_Callback_0
   \                     ??TREEVIEW_Callback_7:
   \   00000074   0450A0E1           MOV      R5,R4
   \   00000078   0400A0E1           MOV      R0,R4
   \   0000007C   ........           BL       GUI_ALLOC_LockH
   \   00000080   0040A0E1           MOV      R4,R0
   \   00000084   100094E5           LDR      R0,[R4, #+16]
   \   00000088   000050E3           CMP      R0,#+0
   \   0000008C   0000000A           BEQ      ??TREEVIEW_Callback_8
   \   00000090   ........           BL       GUI_ALLOC_Free
   \                     ??TREEVIEW_Callback_8:
   \   00000094   044094E5           LDR      R4,[R4, #+4]
   \   00000098   ........           BL       GUI_ALLOC_UnlockH
   \   0000009C   0500A0E1           MOV      R0,R5
   \   000000A0   ........           BL       GUI_ALLOC_Free
   \   000000A4   000054E3           CMP      R4,#+0
   \   000000A8   F1FFFF1A           BNE      ??TREEVIEW_Callback_7
   \   000000AC   440000EA           B        ??TREEVIEW_Callback_0
   1847              break;
   1848            case WM_TIMER:
   1849              pObj = TREEVIEW_LOCK_H(hObj);
   \                     ??TREEVIEW_Callback_6:
   \   000000B0   0400A0E1           MOV      R0,R4
   \   000000B4   ........           BL       GUI_ALLOC_LockH
   \   000000B8   0040A0E1           MOV      R4,R0
   1850              WM_DeleteTimer(pObj->hTimer);
   \   000000BC   AC0094E5           LDR      R0,[R4, #+172]
   \   000000C0   ........           BL       WM_DeleteTimer
   1851              pObj->hTimer = 0;
   \   000000C4   0060A0E3           MOV      R6,#+0
   \   000000C8   AC6084E5           STR      R6,[R4, #+172]
   1852              GUI_UNLOCK_H(pObj);
   \   000000CC   ........           BL       GUI_ALLOC_UnlockH
   1853              break;
   \   000000D0   3B0000EA           B        ??TREEVIEW_Callback_0
   1854            case WM_PAINT:
   1855              _OnPaint(hObj, pMsg);
   \                     ??TREEVIEW_Callback_4:
   \   000000D4   0510A0E1           MOV      R1,R5
   \   000000D8   0400A0E1           MOV      R0,R4
   \   000000DC   ........           BL       _OnPaint
   1856              break;
   \   000000E0   370000EA           B        ??TREEVIEW_Callback_0
   1857            case WM_TOUCH:
   1858              _OnTouch(hObj, pMsg);
   \                     ??TREEVIEW_Callback_2:
   \   000000E4   0510A0E1           MOV      R1,R5
   \   000000E8   0400A0E1           MOV      R0,R4
   \   000000EC   ........           BL       _OnTouch
   1859              break;
   \   000000F0   330000EA           B        ??TREEVIEW_Callback_0
   1860            case WM_KEY:
   1861              pObj = TREEVIEW_LOCK_H(hObj);
   1862              hTimer = pObj->hTimer;
   \                     ??TREEVIEW_Callback_3:
   \   000000F4   0400A0E1           MOV      R0,R4
   \   000000F8   ........           BL       GUI_ALLOC_LockH
   \   000000FC   AC7090E5           LDR      R7,[R0, #+172]
   1863              GUI_UNLOCK_H(pObj);
   \   00000100   ........           BL       GUI_ALLOC_UnlockH
   1864              if (hTimer == 0) {
   \   00000104   000057E3           CMP      R7,#+0
   \   00000108   2D00001A           BNE      ??TREEVIEW_Callback_0
   1865                _OnKey(hObj, pMsg);
   \   0000010C   0510A0E1           MOV      R1,R5
   \   00000110   0400A0E1           MOV      R0,R4
   \   00000114   ........           BL       _OnKey
   \   00000118   290000EA           B        ??TREEVIEW_Callback_0
   1866              }
   1867              break;
   1868            case WM_NOTIFY_PARENT:
   1869              switch (pMsg->Data.v) {
   \                     ??TREEVIEW_Callback_5:
   \   0000011C   0C0095E5           LDR      R0,[R5, #+12]
   \   00000120   050050E3           CMP      R0,#+5
   \   00000124   0300000A           BEQ      ??TREEVIEW_Callback_9
   \   00000128   2500003A           BCC      ??TREEVIEW_Callback_0
   \   0000012C   060050E3           CMP      R0,#+6
   \   00000130   1F00000A           BEQ      ??TREEVIEW_Callback_10
   \   00000134   220000EA           B        ??TREEVIEW_Callback_0
   1870              case WM_NOTIFICATION_VALUE_CHANGED:
   1871                pObj = TREEVIEW_LOCK_H(hObj);
   \                     ??TREEVIEW_Callback_9:
   \   00000138   0400A0E1           MOV      R0,R4
   \   0000013C   ........           BL       GUI_ALLOC_LockH
   \   00000140   0060A0E1           MOV      R6,R0
   1872                if (pMsg->hWinSrc  == WM_GetScrollbarV(hObj)) {
   \   00000144   0400A0E1           MOV      R0,R4
   \   00000148   ........           BL       WM_GetScrollbarV
   \   0000014C   0010A0E1           MOV      R1,R0
   \   00000150   080095E5           LDR      R0,[R5, #+8]
   \   00000154   010050E1           CMP      R0,R1
   \   00000158   0400001A           BNE      ??TREEVIEW_Callback_11
   1873                  WM_GetScrollState(pMsg->hWinSrc, &ScrollState);
   \   0000015C   0D10A0E1           MOV      R1,SP
   \   00000160   ........           BL       WM_GetScrollState
   1874                  pObj->ScrollStateV.v = ScrollState.v;
   \   00000164   04009DE5           LDR      R0,[SP, #+4]
   \   00000168   3C0086E5           STR      R0,[R6, #+60]
   \   0000016C   090000EA           B        ??TREEVIEW_Callback_12
   1875                } else if (pMsg->hWinSrc == WM_GetScrollbarH(hObj)) {
   \                     ??TREEVIEW_Callback_11:
   \   00000170   0400A0E1           MOV      R0,R4
   \   00000174   ........           BL       WM_GetScrollbarH
   \   00000178   0010A0E1           MOV      R1,R0
   \   0000017C   080095E5           LDR      R0,[R5, #+8]
   \   00000180   010050E1           CMP      R0,R1
   \   00000184   0300001A           BNE      ??TREEVIEW_Callback_12
   1876                  WM_GetScrollState(pMsg->hWinSrc, &ScrollState);
   \   00000188   0D10A0E1           MOV      R1,SP
   \   0000018C   ........           BL       WM_GetScrollState
   1877                  pObj->ScrollStateH.v = ScrollState.v;
   \   00000190   04009DE5           LDR      R0,[SP, #+4]
   \   00000194   480086E5           STR      R0,[R6, #+72]
   1878                }
   1879                GUI_UNLOCK_H(pObj);
   \                     ??TREEVIEW_Callback_12:
   \   00000198   ........           BL       GUI_ALLOC_UnlockH
   1880                WM_InvalidateWindow(hObj);
   \   0000019C   0400A0E1           MOV      R0,R4
   \   000001A0   ........           BL       WM_InvalidateWindow
   1881                WM_NotifyParent(hObj, WM_NOTIFICATION_SCROLL_CHANGED);
   \   000001A4   0A10A0E3           MOV      R1,#+10
   \   000001A8   0400A0E1           MOV      R0,R4
   \   000001AC   ........           BL       WM_NotifyParent
   1882                break;
   \   000001B0   030000EA           B        ??TREEVIEW_Callback_0
   1883              case WM_NOTIFICATION_SCROLLBAR_ADDED:
   1884                #if WIDGET_USE_PARENT_EFFECT
   1885                  pObj = TREEVIEW_LOCK_H(hObj);
   1886                  WIDGET_SetEffect(pMsg->hWinSrc, pObj->Widget.pEffect);
   1887                  GUI_UNLOCK_H(pObj);
   1888                #endif
   1889                _CalcParams(hObj);
   \                     ??TREEVIEW_Callback_10:
   \   000001B4   0400A0E1           MOV      R0,R4
   \   000001B8   ........           BL       _CalcParams
   1890                _ManageAutoScroll(hObj);
   \   000001BC   0400A0E1           MOV      R0,R4
   \   000001C0   ........           BL       _ManageAutoScroll
   1891                break;
   \                     ??TREEVIEW_Callback_0:
   \   000001C4   0CD08DE2           ADD      SP,SP,#+12       ;; stack cleaning
   \   000001C8   F080BDE8           POP      {R4-R7,PC}       ;; return
   1892              }
   1893              break;
   1894            }
   1895          }
   1896          
   1897          /*********************************************************************
   1898          *
   1899          *       TREEVIEW_OwnerDraw
   1900          */

   \                                 In section .text, align 4, keep-with-next
   1901          int TREEVIEW_OwnerDraw(const WIDGET_ITEM_DRAW_INFO * pDrawItemInfo) {
   \                     TREEVIEW_OwnerDraw:
   \   00000000   10402DE9           PUSH     {R4,LR}
   1902            switch (pDrawItemInfo->Cmd) {
   \   00000004   041090E5           LDR      R1,[R0, #+4]
   \   00000008   011051E2           SUBS     R1,R1,#+1
   \   0000000C   0D00000A           BEQ      ??TREEVIEW_OwnerDraw_0
   \   00000010   171051E2           SUBS     R1,R1,#+23
   \   00000014   0200000A           BEQ      ??TREEVIEW_OwnerDraw_1
   \   00000018   011051E2           SUBS     R1,R1,#+1
   \   0000001C   0700000A           BEQ      ??TREEVIEW_OwnerDraw_2
   \   00000020   0A0000EA           B        ??TREEVIEW_OwnerDraw_3
   1903            case WIDGET_ITEM_GET_XSIZE:
   1904              return _OnOwnerdraw_GetXSize(pDrawItemInfo);
   \                     ??TREEVIEW_OwnerDraw_1:
   \   00000024   1C0090E5           LDR      R0,[R0, #+28]
   \   00000028   000090E5           LDR      R0,[R0, #+0]
   \   0000002C   ........           BL       GUI_ALLOC_LockH
   \   00000030   B441D0E1           LDRH     R4,[R0, #+20]
   \   00000034   ........           BL       GUI_ALLOC_UnlockH
   \   00000038   0400A0E1           MOV      R0,R4
   \   0000003C   1080BDE8           POP      {R4,PC}
   1905            case WIDGET_ITEM_GET_YSIZE:
   1906              return _OnOwnerdraw_GetYSize(pDrawItemInfo);
   \                     ??TREEVIEW_OwnerDraw_2:
   \   00000040   1040BDE8           POP      {R4,LR}
   \   00000044   ........           B        _OnOwnerdraw_GetYSize  ;; tailcall
   1907            case WIDGET_ITEM_DRAW:
   1908              return _OnOwnerdraw_Paint(pDrawItemInfo);
   \                     ??TREEVIEW_OwnerDraw_0:
   \   00000048   1040BDE8           POP      {R4,LR}
   \   0000004C   ........           B        _OnOwnerdraw_Paint  ;; tailcall
   1909            }
   1910            return 0;
   \                     ??TREEVIEW_OwnerDraw_3:
   \   00000050   0000A0E3           MOV      R0,#+0
   \   00000054   1080BDE8           POP      {R4,PC}          ;; return
   1911          }
   1912          
   1913          /*********************************************************************
   1914          *
   1915          *       TREEVIEW_CreateEx
   1916          */

   \                                 In section .text, align 4, keep-with-next
   1917          TREEVIEW_Handle TREEVIEW_CreateEx(int x0, int y0, int xsize, int ysize, WM_HWIN hParent, int WinFlags, int ExFlags, int Id) {
   \                     TREEVIEW_CreateEx:
   \   00000000   F04F2DE9           PUSH     {R4-R11,LR}
   \   00000004   14D04DE2           SUB      SP,SP,#+20
   \   00000008   0060A0E1           MOV      R6,R0
   \   0000000C   0170A0E1           MOV      R7,R1
   \   00000010   0280A0E1           MOV      R8,R2
   \   00000014   0390A0E1           MOV      R9,R3
   \   00000018   38A09DE5           LDR      R10,[SP, #+56]
   \   0000001C   3CB09DE5           LDR      R11,[SP, #+60]
   \   00000020   40409DE5           LDR      R4,[SP, #+64]
   \   00000024   44509DE5           LDR      R5,[SP, #+68]
   1918            TREEVIEW_Handle hObj;
   1919            WM_LOCK();
   \   00000028   ........           BL       GUI_Lock
   1920            hObj = WM_CreateWindowAsChild(x0, y0, xsize, ysize, hParent, WinFlags, TREEVIEW_Callback,
   1921                                          sizeof(TREEVIEW_OBJ) - sizeof(WM_Obj));
   \   0000002C   9400A0E3           MOV      R0,#+148
   \   00000030   0C008DE5           STR      R0,[SP, #+12]
   \   00000034   ........           LDR      R0,??DataTable2
   \   00000038   04B08DE5           STR      R11,[SP, #+4]
   \   0000003C   08008DE5           STR      R0,[SP, #+8]
   \   00000040   00A08DE5           STR      R10,[SP, #+0]
   \   00000044   0930A0E1           MOV      R3,R9
   \   00000048   0820A0E1           MOV      R2,R8
   \   0000004C   0710A0E1           MOV      R1,R7
   \   00000050   0600A0E1           MOV      R0,R6
   \   00000054   ........           BL       WM_CreateWindowAsChild
   \   00000058   0060B0E1           MOVS     R6,R0
   1922            if (hObj) {
   \   0000005C   0C00000A           BEQ      ??TREEVIEW_CreateEx_0
   1923              TREEVIEW_OBJ * pObj = (TREEVIEW_OBJ *)GUI_LOCK_H(hObj);
   \   00000060   ........           BL       GUI_ALLOC_LockH
   \   00000064   0070A0E1           MOV      R7,R0
   1924              /* init widget specific variables */
   1925              WIDGET__Init(&pObj->Widget, Id, WIDGET_STATE_FOCUSSABLE);
   \   00000068   1020A0E3           MOV      R2,#+16
   \   0000006C   0510A0E1           MOV      R1,R5
   \   00000070   ........           BL       WIDGET__Init
   1926              /* init member variables */
   1927              TREEVIEW_INIT_ID(pObj);
   1928              pObj->Props      = TREEVIEW__DefaultProps;
   \   00000074   500087E2           ADD      R0,R7,#+80
   \   00000078   ........           LDR      R1,??DataTable2_1
   \   0000007C   4C20A0E3           MOV      R2,#+76
   \   00000080   ........           BL       __aeabi_memcpy4
   1929              pObj->pfDrawItem = TREEVIEW_OwnerDraw;
   \   00000084   ........           LDR      R0,??DataTable2_2
   \   00000088   340087E5           STR      R0,[R7, #+52]
   1930              pObj->Flags      = ExFlags;
   \   0000008C   BC49C7E1           STRH     R4,[R7, #+156]
   1931              GUI_UNLOCK_H(pObj);
   \   00000090   ........           BL       GUI_ALLOC_UnlockH
   1932            }
   1933            WM_UNLOCK();
   \                     ??TREEVIEW_CreateEx_0:
   \   00000094   ........           BL       GUI_Unlock
   1934            return hObj;
   \   00000098   0600A0E1           MOV      R0,R6
   \   0000009C   14D08DE2           ADD      SP,SP,#+20
   \   000000A0   F08FBDE8           POP      {R4-R11,PC}      ;; return
   1935          }
   1936          
   1937          /*********************************************************************
   1938          *
   1939          *       TREEVIEW_ITEM_Create
   1940          */

   \                                 In section .text, align 4, keep-with-next
   1941          TREEVIEW_ITEM_Handle TREEVIEW_ITEM_Create(int IsNode, const char * s, U32 UserData) {
   \                     TREEVIEW_ITEM_Create:
   \   00000000   F0412DE9           PUSH     {R4-R8,LR}
   \   00000004   0040A0E1           MOV      R4,R0
   \   00000008   0150A0E1           MOV      R5,R1
   \   0000000C   0260A0E1           MOV      R6,R2
   1942            TREEVIEW_ITEM_OBJ  * pItem;
   1943            TREEVIEW_ITEM_Handle hItem;
   1944            hItem = GUI_ALLOC_AllocZero(sizeof(TREEVIEW_ITEM_OBJ) + strlen(s));
   \   00000010   0500A0E1           MOV      R0,R5
   \   00000014   ........           BL       strlen
   \   00000018   200080E2           ADD      R0,R0,#+32
   \   0000001C   ........           BL       GUI_ALLOC_AllocZero
   \   00000020   0070B0E1           MOVS     R7,R0
   1945            if (hItem) {
   \   00000024   0A00000A           BEQ      ??TREEVIEW_ITEM_Create_0
   1946              pItem = (TREEVIEW_ITEM_OBJ *)GUI_LOCK_H(hItem);
   \   00000028   ........           BL       GUI_ALLOC_LockH
   \   0000002C   0080A0E1           MOV      R8,R0
   1947              pItem->UserData = UserData;
   \   00000030   0C6088E5           STR      R6,[R8, #+12]
   1948              strcpy(pItem->acText, s);
   \   00000034   0510A0E1           MOV      R1,R5
   \   00000038   1D0088E2           ADD      R0,R8,#+29
   \   0000003C   ........           BL       strcpy
   1949              if (IsNode) {
   \   00000040   000054E3           CMP      R4,#+0
   1950                pItem->Flags |= TREEVIEW_ITEM_TYPE_NODE;
   \   00000044   B801D811           LDRHNE   R0,[R8, #+24]
   \   00000048   01008013           ORRNE    R0,R0,#0x1
   \   0000004C   B801C811           STRHNE   R0,[R8, #+24]
   1951              }
   1952              GUI_UNLOCK_H(pItem);
   \   00000050   ........           BL       GUI_ALLOC_UnlockH
   1953            }
   1954            return hItem;
   \                     ??TREEVIEW_ITEM_Create_0:
   \   00000054   0700A0E1           MOV      R0,R7
   \   00000058   F081BDE8           POP      {R4-R8,PC}       ;; return
   1955          }
   1956          
   1957          /*********************************************************************
   1958          *
   1959          *       TREEVIEW_AttachItem
   1960          */

   \                                 In section .text, align 4, keep-with-next
   1961          int TREEVIEW_AttachItem(TREEVIEW_Handle hObj, TREEVIEW_ITEM_Handle hItem, TREEVIEW_ITEM_Handle hItemAt, int Position) {
   \                     TREEVIEW_AttachItem:
   \   00000000   F44F2DE9           PUSH     {R2,R4-R11,LR}
   \   00000004   0040A0E1           MOV      R4,R0
   \   00000008   0190A0E1           MOV      R9,R1
   1962            TREEVIEW_OBJ       * pObj;
   1963            TREEVIEW_ITEM_OBJ  * pItem;
   1964            TREEVIEW_ITEM_Handle hItemNext;
   1965            TREEVIEW_ITEM_OBJ  * pItemNext;
   1966            TREEVIEW_ITEM_Handle hItemLast;
   1967            TREEVIEW_ITEM_OBJ  * pItemLast;
   1968            TREEVIEW_ITEM_Handle hItemTemp;
   1969            int LevelOld, LevelNew;
   1970            int r = 0;
   1971            if (hObj && hItem) {
   \   0000000C   000054E3           CMP      R4,#+0
   \   00000010   10D04DE2           SUB      SP,SP,#+16
   \   00000014   0370A0E1           MOV      R7,R3
   \   00000018   0060A0E3           MOV      R6,#+0
   \   0000001C   00005913           CMPNE    R9,#+0
   \   00000020   7100000A           BEQ      ??TREEVIEW_AttachItem_0
   1972              WM_LOCK();
   \   00000024   ........           BL       GUI_Lock
   1973              pItem = (TREEVIEW_ITEM_OBJ *)GUI_LOCK_H(hItem);
   \   00000028   0900A0E1           MOV      R0,R9
   \   0000002C   ........           BL       GUI_ALLOC_LockH
   \   00000030   0080A0E1           MOV      R8,R0
   1974              hItemTemp = pItem->hNext;     /* Backup next pointer */
   \   00000034   041098E5           LDR      R1,[R8, #+4]
   \   00000038   00108DE5           STR      R1,[SP, #+0]
   1975              if (hItemTemp) {
   \   0000003C   000051E3           CMP      R1,#+0
   \   00000040   1C00000A           BEQ      ??TREEVIEW_AttachItem_1
   1976                hItemLast = _GetLastNodeItem(hItem);
   \   00000044   0900A0E1           MOV      R0,R9
   \   00000048   ........           BL       GUI_ALLOC_LockH
   \   0000004C   1810D0E5           LDRB     R1,[R0, #+24]
   \   00000050   1CA0D0E5           LDRB     R10,[R0, #+28]
   \   00000054   0950A0E1           MOV      R5,R9
   \   00000058   010011E3           TST      R1,#0x1
   \   0000005C   04B09015           LDRNE    R11,[R0, #+4]
   \   00000060   00005B13           CMPNE    R11,#+0
   \   00000064   1000000A           BEQ      ??TREEVIEW_AttachItem_2
   \   00000068   0B00A0E1           MOV      R0,R11
   \   0000006C   ........           BL       GUI_ALLOC_LockH
   \   00000070   050000EA           B        ??TREEVIEW_AttachItem_3
   \                     ??TREEVIEW_AttachItem_4:
   \   00000074   ........           BL       GUI_ALLOC_UnlockH
   \   00000078   0B00A0E1           MOV      R0,R11
   \   0000007C   ........           BL       GUI_ALLOC_LockH
   \   00000080   1C10D0E5           LDRB     R1,[R0, #+28]
   \   00000084   01005AE1           CMP      R10,R1
   \   00000088   0B50A0B1           MOVLT    R5,R11
   \                     ??TREEVIEW_AttachItem_3:
   \   0000008C   1C10D0E5           LDRB     R1,[R0, #+28]
   \   00000090   01005AE1           CMP      R10,R1
   \   00000094   030000AA           BGE      ??TREEVIEW_AttachItem_5
   \   00000098   0B50A0E1           MOV      R5,R11
   \   0000009C   04B090E5           LDR      R11,[R0, #+4]
   \   000000A0   00005BE3           CMP      R11,#+0
   \   000000A4   F2FFFF1A           BNE      ??TREEVIEW_AttachItem_4
   \                     ??TREEVIEW_AttachItem_5:
   \   000000A8   ........           BL       GUI_ALLOC_UnlockH
   \                     ??TREEVIEW_AttachItem_2:
   \   000000AC   ........           BL       GUI_ALLOC_UnlockH
   1977                LevelOld  = pItem->Level;
   \   000000B0   1C10D8E5           LDRB     R1,[R8, #+28]
   \   000000B4   04108DE5           STR      R1,[SP, #+4]
   1978              }
   1979              if (pItem->hPrev == 0) {
   \                     ??TREEVIEW_AttachItem_1:
   \   000000B8   080098E5           LDR      R0,[R8, #+8]
   \   000000BC   000050E3           CMP      R0,#+0
   \   000000C0   4700001A           BNE      ??TREEVIEW_AttachItem_6
   1980                GUI_UNLOCK_H(pItem);
   \   000000C4   ........           BL       GUI_ALLOC_UnlockH
   1981                r = _LinkItem(hObj, hItem, hItemAt, Position);
   \   000000C8   0730A0E1           MOV      R3,R7
   \   000000CC   10209DE5           LDR      R2,[SP, #+16]
   \   000000D0   0910A0E1           MOV      R1,R9
   \   000000D4   0400A0E1           MOV      R0,R4
   \   000000D8   ........           BL       _LinkItem
   \   000000DC   0060A0E1           MOV      R6,R0
   1982                pItem = (TREEVIEW_ITEM_OBJ *)GUI_LOCK_H(hItem);
   \   000000E0   0900A0E1           MOV      R0,R9
   \   000000E4   ........           BL       GUI_ALLOC_LockH
   \   000000E8   00A0A0E1           MOV      R10,R0
   1983                pObj  = TREEVIEW_LOCK_H(hObj);
   \   000000EC   0400A0E1           MOV      R0,R4
   \   000000F0   ........           BL       GUI_ALLOC_LockH
   1984                LevelNew = pItem->Level;
   \   000000F4   1C10DAE5           LDRB     R1,[R10, #+28]
   \   000000F8   0070A0E1           MOV      R7,R0
   \   000000FC   08108DE5           STR      R1,[SP, #+8]
   1985                GUI_SetFont(pObj->Props.pFont);
   \   00000100   500097E5           LDR      R0,[R7, #+80]
   \   00000104   ........           BL       GUI_SetFont
   1986                pItem->xSize = (pItem->Level + 1) * pObj->Props.Indent 
   1987                             + pObj->Props.TextIndent
   1988                             + GUI_GetStringDistX(pItem->acText);
   \   00000108   1D008AE2           ADD      R0,R10,#+29
   \   0000010C   ........           BL       GUI_GetStringDistX
   \   00000110   1C10DAE5           LDRB     R1,[R10, #+28]
   \   00000114   902097E5           LDR      R2,[R7, #+144]
   \   00000118   943097E5           LDR      R3,[R7, #+148]
   \   0000011C   011081E2           ADD      R1,R1,#+1
   \   00000120   813201E1           SMLABB   R1,R1,R2,R3
   \   00000124   010080E0           ADD      R0,R0,R1
   \   00000128   B401CAE1           STRH     R0,[R10, #+20]
   1989                if (hItemTemp && (r == 0)) {
   \   0000012C   00009DE5           LDR      R0,[SP, #+0]
   \   00000130   000050E3           CMP      R0,#+0
   \   00000134   2100000A           BEQ      ??TREEVIEW_AttachItem_7
   \   00000138   000056E3           CMP      R6,#+0
   \   0000013C   1F00001A           BNE      ??TREEVIEW_AttachItem_7
   1990                  hItemNext = pItem->hNext;
   \   00000140   04809AE5           LDR      R8,[R10, #+4]
   1991                  pItem->hNext = hItemTemp; /* Restore next pointer */
   \   00000144   04008AE5           STR      R0,[R10, #+4]
   1992                  pItem->hParent = hObj;
   \   00000148   00408AE5           STR      R4,[R10, #+0]
   1993                  do {
   1994                    pObj->NumItems++;
   \                     ??TREEVIEW_AttachItem_8:
   \   0000014C   B00097E5           LDR      R0,[R7, #+176]
   \   00000150   010080E2           ADD      R0,R0,#+1
   \   00000154   B00087E5           STR      R0,[R7, #+176]
   1995                    hItem = pItem->hNext;
   \   00000158   04909AE5           LDR      R9,[R10, #+4]
   1996                    if (hItem) {
   \   0000015C   000059E3           CMP      R9,#+0
   \   00000160   0A00000A           BEQ      ??TREEVIEW_AttachItem_9
   1997                      GUI_UNLOCK_H(pItem);
   \   00000164   ........           BL       GUI_ALLOC_UnlockH
   1998                      pItem = (TREEVIEW_ITEM_OBJ *)GUI_LOCK_H(hItem);
   \   00000168   0900A0E1           MOV      R0,R9
   \   0000016C   ........           BL       GUI_ALLOC_LockH
   \   00000170   00A0A0E1           MOV      R10,R0
   1999                      pItem->Level += (LevelNew - LevelOld);
   \   00000174   1C00DAE5           LDRB     R0,[R10, #+28]
   \   00000178   08109DE5           LDR      R1,[SP, #+8]
   \   0000017C   000081E0           ADD      R0,R1,R0
   \   00000180   04109DE5           LDR      R1,[SP, #+4]
   \   00000184   010040E0           SUB      R0,R0,R1
   \   00000188   1C00CAE5           STRB     R0,[R10, #+28]
   2000                      pItem->hParent = hObj;
   \   0000018C   00408AE5           STR      R4,[R10, #+0]
   2001                    }
   2002                  } while (hItem != hItemLast);
   \                     ??TREEVIEW_AttachItem_9:
   \   00000190   050059E1           CMP      R9,R5
   \   00000194   ECFFFF1A           BNE      ??TREEVIEW_AttachItem_8
   2003                  pItemLast = (TREEVIEW_ITEM_OBJ *)GUI_LOCK_H(hItemLast);
   2004                  pItemLast->hNext = hItemNext;
   \   00000198   0500A0E1           MOV      R0,R5
   \   0000019C   ........           BL       GUI_ALLOC_LockH
   \   000001A0   048080E5           STR      R8,[R0, #+4]
   2005                  GUI_UNLOCK_H(pItemLast);
   \   000001A4   ........           BL       GUI_ALLOC_UnlockH
   2006                  if (hItemNext) {
   \   000001A8   000058E3           CMP      R8,#+0
   \   000001AC   0300000A           BEQ      ??TREEVIEW_AttachItem_7
   2007                    pItemNext = (TREEVIEW_ITEM_OBJ *)GUI_LOCK_H(hItemNext);
   2008                    pItemNext->hPrev = hItemLast;
   \   000001B0   0800A0E1           MOV      R0,R8
   \   000001B4   ........           BL       GUI_ALLOC_LockH
   \   000001B8   085080E5           STR      R5,[R0, #+8]
   2009                    GUI_UNLOCK_H(pItemNext);
   \   000001BC   ........           BL       GUI_ALLOC_UnlockH
   2010                  }
   2011                }
   2012                GUI_UNLOCK_H(pObj);
   \                     ??TREEVIEW_AttachItem_7:
   \   000001C0   ........           BL       GUI_ALLOC_UnlockH
   2013                GUI_UNLOCK_H(pItem);
   \   000001C4   ........           BL       GUI_ALLOC_UnlockH
   2014                _CalcParams(hObj);
   \   000001C8   0400A0E1           MOV      R0,R4
   \   000001CC   ........           BL       _CalcParams
   2015                _ManageAutoScroll(hObj);
   \   000001D0   0400A0E1           MOV      R0,R4
   \   000001D4   ........           BL       _ManageAutoScroll
   2016                WM_InvalidateWindow(hObj);
   \   000001D8   0400A0E1           MOV      R0,R4
   \   000001DC   ........           BL       WM_InvalidateWindow
   \   000001E0   000000EA           B        ??TREEVIEW_AttachItem_10
   2017              } else {
   2018                GUI_UNLOCK_H(pItem);
   \                     ??TREEVIEW_AttachItem_6:
   \   000001E4   ........           BL       GUI_ALLOC_UnlockH
   2019                GUI_DEBUG_ERROROUT("TREEVIEW_AttachItem: Item is not allowed to have previous items!");
   2020              }
   2021              WM_UNLOCK();
   \                     ??TREEVIEW_AttachItem_10:
   \   000001E8   ........           BL       GUI_Unlock
   2022            }
   2023            return r;
   \                     ??TREEVIEW_AttachItem_0:
   \   000001EC   0600A0E1           MOV      R0,R6
   \   000001F0   14D08DE2           ADD      SP,SP,#+20
   \   000001F4   F08FBDE8           POP      {R4-R11,PC}      ;; return
   2024          }
   2025          
   2026          /*********************************************************************
   2027          *
   2028          *       TREEVIEW_InsertItem
   2029          */

   \                                 In section .text, align 4, keep-with-next
   2030          TREEVIEW_ITEM_Handle TREEVIEW_InsertItem(TREEVIEW_Handle hObj, int IsNode, TREEVIEW_ITEM_Handle hItemPrev, int Position, const char * s) {
   \                     TREEVIEW_InsertItem:
   \   00000000   F04F2DE9           PUSH     {R4-R11,LR}
   \   00000004   04D04DE2           SUB      SP,SP,#+4
   \   00000008   0040A0E1           MOV      R4,R0
   \   0000000C   0150A0E1           MOV      R5,R1
   \   00000010   0260A0E1           MOV      R6,R2
   \   00000014   0370A0E1           MOV      R7,R3
   \   00000018   28B09DE5           LDR      R11,[SP, #+40]
   2031            TREEVIEW_ITEM_Handle hItemNew;
   2032            WM_LOCK();
   \   0000001C   ........           BL       GUI_Lock
   2033            hItemNew = TREEVIEW_ITEM_Create(IsNode, s, 0);
   \   00000020   0B00A0E1           MOV      R0,R11
   \   00000024   ........           BL       strlen
   \   00000028   200080E2           ADD      R0,R0,#+32
   \   0000002C   ........           BL       GUI_ALLOC_AllocZero
   \   00000030   0080B0E1           MOVS     R8,R0
   \   00000034   1400000A           BEQ      ??TREEVIEW_InsertItem_0
   \   00000038   ........           BL       GUI_ALLOC_LockH
   \   0000003C   0090A0E1           MOV      R9,R0
   \   00000040   00A0A0E3           MOV      R10,#+0
   \   00000044   0CA089E5           STR      R10,[R9, #+12]
   \   00000048   0B10A0E1           MOV      R1,R11
   \   0000004C   1D0089E2           ADD      R0,R9,#+29
   \   00000050   ........           BL       strcpy
   \   00000054   000055E3           CMP      R5,#+0
   \   00000058   B801D911           LDRHNE   R0,[R9, #+24]
   \   0000005C   01008013           ORRNE    R0,R0,#0x1
   \   00000060   B801C911           STRHNE   R0,[R9, #+24]
   \   00000064   ........           BL       GUI_ALLOC_UnlockH
   2034            if (hItemNew) {
   2035              if (TREEVIEW_AttachItem(hObj, hItemNew, hItemPrev, Position)) {
   \   00000068   0730A0E1           MOV      R3,R7
   \   0000006C   0620A0E1           MOV      R2,R6
   \   00000070   0810A0E1           MOV      R1,R8
   \   00000074   0400A0E1           MOV      R0,R4
   \   00000078   ........           BL       TREEVIEW_AttachItem
   \   0000007C   000050E3           CMP      R0,#+0
   \   00000080   0100000A           BEQ      ??TREEVIEW_InsertItem_0
   2036                GUI_ALLOC_Free(hItemNew);
   \   00000084   0800A0E1           MOV      R0,R8
   \   00000088   ........           BL       GUI_ALLOC_Free
   2037              }
   2038            } else {
   2039              GUI_DEBUG_ERROROUT("TREEVIEW_InsertItem: Allocation failed!");
   2040            }
   2041            WM_UNLOCK();
   \                     ??TREEVIEW_InsertItem_0:
   \   0000008C   ........           BL       GUI_Unlock
   2042            return hItemNew;
   \   00000090   0800A0E1           MOV      R0,R8
   \   00000094   04D08DE2           ADD      SP,SP,#+4
   \   00000098   F08FBDE8           POP      {R4-R11,PC}      ;; return
   2043          }
   2044          
   2045          /*********************************************************************
   2046          *
   2047          *       TREEVIEW_SetAutoScrollH
   2048          */

   \                                 In section .text, align 4, keep-with-next
   2049          void TREEVIEW_SetAutoScrollH(TREEVIEW_Handle hObj, int State) {
   \                     TREEVIEW_SetAutoScrollH:
   \   00000000   F0402DE9           PUSH     {R4-R7,LR}
   \   00000004   0040A0E1           MOV      R4,R0
   \   00000008   04D04DE2           SUB      SP,SP,#+4
   \   0000000C   0150A0E1           MOV      R5,R1
   2050            if (hObj) {
   \   00000010   000054E3           CMP      R4,#+0
   \   00000014   1800000A           BEQ      ??TREEVIEW_SetAutoScrollH_0
   2051              WM_LOCK();
   \   00000018   ........           BL       GUI_Lock
   2052              _SetAutoScroll(hObj, State, TREEVIEW_SF_AUTOSCROLLBAR_H);
   \   0000001C   0400A0E1           MOV      R0,R4
   \   00000020   ........           BL       GUI_ALLOC_LockH
   \   00000024   BC69D0E1           LDRH     R6,[R0, #+156]
   \   00000028   FF6006E2           AND      R6,R6,#0xFF
   \   0000002C   FB7006E2           AND      R7,R6,#0xFB
   \   00000030   ........           BL       GUI_ALLOC_UnlockH
   \   00000034   000055E3           CMP      R5,#+0
   \   00000038   04708713           ORRNE    R7,R7,#0x4
   \   0000003C   0010A003           MOVEQ    R1,#+0
   \   00000040   0400A001           MOVEQ    R0,R4
   \   00000044   ........           BLEQ     WM_SetScrollbarH
   \   00000048   070056E1           CMP      R6,R7
   \   0000004C   0900000A           BEQ      ??TREEVIEW_SetAutoScrollH_1
   \   00000050   0400A0E1           MOV      R0,R4
   \   00000054   ........           BL       GUI_ALLOC_LockH
   \   00000058   BC79C0E1           STRH     R7,[R0, #+156]
   \   0000005C   ........           BL       GUI_ALLOC_UnlockH
   \   00000060   0400A0E1           MOV      R0,R4
   \   00000064   ........           BL       _CalcParams
   \   00000068   0400A0E1           MOV      R0,R4
   \   0000006C   ........           BL       _ManageAutoScroll
   \   00000070   0400A0E1           MOV      R0,R4
   \   00000074   ........           BL       WM_InvalidateWindow
   2053              WM_UNLOCK();
   \                     ??TREEVIEW_SetAutoScrollH_1:
   \   00000078   ........           BL       GUI_Unlock
   2054            }
   2055          }
   \                     ??TREEVIEW_SetAutoScrollH_0:
   \   0000007C   04D08DE2           ADD      SP,SP,#+4        ;; stack cleaning
   \   00000080   F080BDE8           POP      {R4-R7,PC}       ;; return
   2056          
   2057          /*********************************************************************
   2058          *
   2059          *       TREEVIEW_SetAutoScrollV
   2060          */

   \                                 In section .text, align 4, keep-with-next
   2061          void TREEVIEW_SetAutoScrollV(TREEVIEW_Handle hObj, int State) {
   \                     TREEVIEW_SetAutoScrollV:
   \   00000000   F0402DE9           PUSH     {R4-R7,LR}
   \   00000004   0040A0E1           MOV      R4,R0
   \   00000008   04D04DE2           SUB      SP,SP,#+4
   \   0000000C   0150A0E1           MOV      R5,R1
   2062            if (hObj) {
   \   00000010   000054E3           CMP      R4,#+0
   \   00000014   1800000A           BEQ      ??TREEVIEW_SetAutoScrollV_0
   2063              WM_LOCK();
   \   00000018   ........           BL       GUI_Lock
   2064              _SetAutoScroll(hObj, State, TREEVIEW_SF_AUTOSCROLLBAR_V);
   \   0000001C   0400A0E1           MOV      R0,R4
   \   00000020   ........           BL       GUI_ALLOC_LockH
   \   00000024   BC69D0E1           LDRH     R6,[R0, #+156]
   \   00000028   FF6006E2           AND      R6,R6,#0xFF
   \   0000002C   F77006E2           AND      R7,R6,#0xF7
   \   00000030   ........           BL       GUI_ALLOC_UnlockH
   \   00000034   000055E3           CMP      R5,#+0
   \   00000038   08708713           ORRNE    R7,R7,#0x8
   \   0000003C   0010A003           MOVEQ    R1,#+0
   \   00000040   0400A001           MOVEQ    R0,R4
   \   00000044   ........           BLEQ     WM_SetScrollbarH
   \   00000048   070056E1           CMP      R6,R7
   \   0000004C   0900000A           BEQ      ??TREEVIEW_SetAutoScrollV_1
   \   00000050   0400A0E1           MOV      R0,R4
   \   00000054   ........           BL       GUI_ALLOC_LockH
   \   00000058   BC79C0E1           STRH     R7,[R0, #+156]
   \   0000005C   ........           BL       GUI_ALLOC_UnlockH
   \   00000060   0400A0E1           MOV      R0,R4
   \   00000064   ........           BL       _CalcParams
   \   00000068   0400A0E1           MOV      R0,R4
   \   0000006C   ........           BL       _ManageAutoScroll
   \   00000070   0400A0E1           MOV      R0,R4
   \   00000074   ........           BL       WM_InvalidateWindow
   2065              WM_UNLOCK();
   \                     ??TREEVIEW_SetAutoScrollV_1:
   \   00000078   ........           BL       GUI_Unlock
   2066            }
   2067          }
   \                     ??TREEVIEW_SetAutoScrollV_0:
   \   0000007C   04D08DE2           ADD      SP,SP,#+4        ;; stack cleaning
   \   00000080   F080BDE8           POP      {R4-R7,PC}       ;; return
   2068          
   2069          /*********************************************************************
   2070          *
   2071          *       TREEVIEW_SetHasLines
   2072          */

   \                                 In section .text, align 4, keep-with-next
   2073          void TREEVIEW_SetHasLines(TREEVIEW_Handle hObj, int State) {
   \                     TREEVIEW_SetHasLines:
   \   00000000   30402DE9           PUSH     {R4,R5,LR}
   \   00000004   0040A0E1           MOV      R4,R0
   \   00000008   04D04DE2           SUB      SP,SP,#+4
   \   0000000C   0150A0E1           MOV      R5,R1
   2074            if (hObj) {
   \   00000010   000054E3           CMP      R4,#+0
   \   00000014   1100000A           BEQ      ??TREEVIEW_SetHasLines_0
   2075              TREEVIEW_OBJ * pObj;
   2076              WM_LOCK();
   \   00000018   ........           BL       GUI_Lock
   2077              pObj = TREEVIEW_LOCK_H(hObj);
   \   0000001C   0400A0E1           MOV      R0,R4
   \   00000020   ........           BL       GUI_ALLOC_LockH
   2078              if (State) {
   \   00000024   BC19D0E1           LDRH     R1,[R0, #+156]
   \   00000028   000055E3           CMP      R5,#+0
   \   0000002C   0300000A           BEQ      ??TREEVIEW_SetHasLines_1
   2079                if (pObj->Flags & TREEVIEW_SF_HIDELINES) {
   \   00000030   010011E3           TST      R1,#0x1
   \   00000034   0700000A           BEQ      ??TREEVIEW_SetHasLines_2
   2080                  pObj->Flags &= ~TREEVIEW_SF_HIDELINES;
   \   00000038   0110C1E3           BIC      R1,R1,#0x1
   \   0000003C   020000EA           B        ??TREEVIEW_SetHasLines_3
   2081                  WM_InvalidateWindow(hObj);
   2082                }
   2083              } else {
   2084                if ((pObj->Flags & TREEVIEW_SF_HIDELINES) == 0) {
   \                     ??TREEVIEW_SetHasLines_1:
   \   00000040   010011E3           TST      R1,#0x1
   \   00000044   0300001A           BNE      ??TREEVIEW_SetHasLines_2
   2085                  pObj->Flags |= TREEVIEW_SF_HIDELINES;
   \   00000048   011081E3           ORR      R1,R1,#0x1
   \                     ??TREEVIEW_SetHasLines_3:
   \   0000004C   BC19C0E1           STRH     R1,[R0, #+156]
   2086                  WM_InvalidateWindow(hObj);
   \   00000050   0400A0E1           MOV      R0,R4
   \   00000054   ........           BL       WM_InvalidateWindow
   2087                }
   2088              }
   2089              GUI_UNLOCK_H(pObj);
   \                     ??TREEVIEW_SetHasLines_2:
   \   00000058   ........           BL       GUI_ALLOC_UnlockH
   2090              WM_UNLOCK();
   \   0000005C   ........           BL       GUI_Unlock
   2091            }
   2092          }
   \                     ??TREEVIEW_SetHasLines_0:
   \   00000060   04D08DE2           ADD      SP,SP,#+4        ;; stack cleaning
   \   00000064   3080BDE8           POP      {R4,R5,PC}       ;; return
   2093          
   2094          /*********************************************************************
   2095          *
   2096          *       TREEVIEW_GetItem
   2097          */

   \                                 In section .text, align 4, keep-with-next
   2098          TREEVIEW_ITEM_Handle TREEVIEW_GetItem(TREEVIEW_Handle hObj, TREEVIEW_ITEM_Handle hItem, int Flags) {
   \                     TREEVIEW_GetItem:
   \   00000000   E0432DE9           PUSH     {R5-R9,LR}
   \   00000004   0160A0E1           MOV      R6,R1
   \   00000008   0080A0E1           MOV      R8,R0
   \   0000000C   0290A0E1           MOV      R9,R2
   2099            TREEVIEW_OBJ * pObj;
   2100            TREEVIEW_ITEM_Handle hItemNext;
   2101            TREEVIEW_ITEM_OBJ  * pItem = NULL;
   \   00000010   0070A0E3           MOV      R7,#+0
   2102            TREEVIEW_ITEM_Handle hItemTemp;
   2103            TREEVIEW_ITEM_OBJ  * pItemTemp;
   2104            hItemNext = 0;
   \   00000014   0050A0E3           MOV      R5,#+0
   2105            if (hItem == 0) {
   \   00000018   000056E3           CMP      R6,#+0
   \   0000001C   0200001A           BNE      ??TREEVIEW_GetItem_1
   2106              if ((Flags != TREEVIEW_GET_FIRST) && (Flags != TREEVIEW_GET_LAST)) {
   \   00000020   000059E3           CMP      R9,#+0
   \   00000024   01005913           CMPNE    R9,#+1
   \   00000028   1900001A           BNE      ??TREEVIEW_GetItem_2
   2107                GUI_DEBUG_ERROROUT("TREEVIEW_GetItem: Zero handle not allowed!");
   2108                return 0;
   2109              }
   2110            }
   2111            if (hObj) {
   \                     ??TREEVIEW_GetItem_1:
   \   0000002C   000058E3           CMP      R8,#+0
   \   00000030   1700000A           BEQ      ??TREEVIEW_GetItem_2
   2112              WM_LOCK();
   \   00000034   ........           BL       GUI_Lock
   2113              pObj = TREEVIEW_LOCK_H(hObj);
   \   00000038   0800A0E1           MOV      R0,R8
   \   0000003C   ........           BL       GUI_ALLOC_LockH
   \   00000040   0080A0E1           MOV      R8,R0
   2114              if (hItem) {
   \   00000044   000056E3           CMP      R6,#+0
   \   00000048   0200000A           BEQ      ??TREEVIEW_GetItem_3
   2115                pItem = (TREEVIEW_ITEM_OBJ *)GUI_LOCK_H(hItem);
   \   0000004C   0600A0E1           MOV      R0,R6
   \   00000050   ........           BL       GUI_ALLOC_LockH
   \   00000054   0070A0E1           MOV      R7,R0
   2116              }
   2117              switch (Flags) {
   \                     ??TREEVIEW_GetItem_3:
   \   00000058   050059E3           CMP      R9,#+5
   \   0000005C   09F18F90           ADDLS    PC,PC,R9, LSL #+2
   \                     ??TREEVIEW_GetItem_0:
   \   00000060   0600008A           BHI      ??TREEVIEW_GetItem_4
   \   00000064   040000EA           B        ??TREEVIEW_GetItem_5
   \   00000068   0B0000EA           B        ??TREEVIEW_GetItem_6
   \   0000006C   0C0000EA           B        ??TREEVIEW_GetItem_7
   \   00000070   370000EA           B        ??TREEVIEW_GetItem_8
   \   00000074   4E0000EA           B        ??TREEVIEW_GetItem_9
   \   00000078   540000EA           B        ??TREEVIEW_GetItem_10
   2118              case TREEVIEW_GET_FIRST:
   2119                hItemNext = pObj->hFirst;
   \                     ??TREEVIEW_GetItem_5:
   \   0000007C   A05098E5           LDR      R5,[R8, #+160]
   2120                break;
   2121              case TREEVIEW_GET_LAST:
   2122                hItemNext = pObj->hLast;
   2123                break;
   2124              case TREEVIEW_GET_NEXT_SIBLING:
   2125                if (pItem) {
   2126                  hItemTemp = _GetLastNodeItem(hItem);
   2127                  if (hItemTemp) {
   2128                    pItemTemp = (TREEVIEW_ITEM_OBJ *)GUI_LOCK_H(hItemTemp);
   2129                    hItemTemp = pItemTemp->hNext;
   2130                    if (hItemTemp) {
   2131                      GUI_UNLOCK_H(pItemTemp);
   2132                      pItemTemp = (TREEVIEW_ITEM_OBJ *)GUI_LOCK_H(hItemTemp);
   2133                      if (pItemTemp->Level == pItem->Level) {
   2134                        hItemNext = hItemTemp;
   2135                      }
   2136                    }
   2137                    GUI_UNLOCK_H(pItemTemp);
   2138                  }
   2139                }
   2140                break;
   2141              case TREEVIEW_GET_PREV_SIBLING:
   2142                if (pItem) {
   2143                  hItemNext = _GetPrevItem(hItem, pItem->Level);
   2144                }
   2145                break;
   2146              case TREEVIEW_GET_FIRST_CHILD:
   2147                if (pItem) {
   2148                  if (pItem->Flags & TREEVIEW_ITEM_TYPE_NODE) {
   2149                    hItemNext = pItem->hNext;
   2150                  } else {
   2151                    GUI_DEBUG_WARN("TREEVIEW_GetItem: Item is not a node!");
   2152                  }
   2153                }
   2154                break;
   2155              case TREEVIEW_GET_PARENT:
   2156                if (pItem) {
   2157                  if (pItem->Level) {
   2158                    hItemNext = _GetPrevItem(hItem, pItem->Level - 1);
   2159                  } else {
   2160                    GUI_DEBUG_WARN("TREEVIEW_GetItem: Illegal level!");
   2161                  }
   2162                }
   2163                break;
   2164              }
   2165              if (pItem) {
   \                     ??TREEVIEW_GetItem_4:
   \   00000080   000057E3           CMP      R7,#+0
   \   00000084   0000000A           BEQ      ??TREEVIEW_GetItem_11
   2166                GUI_UNLOCK_H(pItem);
   \                     ??TREEVIEW_GetItem_12:
   \   00000088   ........           BL       GUI_ALLOC_UnlockH
   2167              }
   2168              GUI_UNLOCK_H(pObj);
   \                     ??TREEVIEW_GetItem_11:
   \   0000008C   ........           BL       GUI_ALLOC_UnlockH
   2169              WM_UNLOCK();
   \   00000090   ........           BL       GUI_Unlock
   2170            }
   2171            return hItemNext;
   \                     ??TREEVIEW_GetItem_2:
   \   00000094   0500A0E1           MOV      R0,R5
   \   00000098   E083BDE8           POP      {R5-R9,PC}       ;; return
   \                     ??TREEVIEW_GetItem_6:
   \   0000009C   A45098E5           LDR      R5,[R8, #+164]
   \   000000A0   F6FFFFEA           B        ??TREEVIEW_GetItem_4
   \                     ??TREEVIEW_GetItem_7:
   \   000000A4   000057E3           CMP      R7,#+0
   \   000000A8   F7FFFF0A           BEQ      ??TREEVIEW_GetItem_11
   \   000000AC   0600A0E1           MOV      R0,R6
   \   000000B0   ........           BL       GUI_ALLOC_LockH
   \   000000B4   1810D0E5           LDRB     R1,[R0, #+24]
   \   000000B8   1C80D0E5           LDRB     R8,[R0, #+28]
   \   000000BC   010011E3           TST      R1,#0x1
   \   000000C0   04909015           LDRNE    R9,[R0, #+4]
   \   000000C4   00005913           CMPNE    R9,#+0
   \   000000C8   1000000A           BEQ      ??TREEVIEW_GetItem_13
   \   000000CC   0900A0E1           MOV      R0,R9
   \   000000D0   ........           BL       GUI_ALLOC_LockH
   \   000000D4   050000EA           B        ??TREEVIEW_GetItem_14
   \                     ??TREEVIEW_GetItem_15:
   \   000000D8   ........           BL       GUI_ALLOC_UnlockH
   \   000000DC   0900A0E1           MOV      R0,R9
   \   000000E0   ........           BL       GUI_ALLOC_LockH
   \   000000E4   1C10D0E5           LDRB     R1,[R0, #+28]
   \   000000E8   010058E1           CMP      R8,R1
   \   000000EC   0960A0B1           MOVLT    R6,R9
   \                     ??TREEVIEW_GetItem_14:
   \   000000F0   1C10D0E5           LDRB     R1,[R0, #+28]
   \   000000F4   010058E1           CMP      R8,R1
   \   000000F8   030000AA           BGE      ??TREEVIEW_GetItem_16
   \   000000FC   0960A0E1           MOV      R6,R9
   \   00000100   049090E5           LDR      R9,[R0, #+4]
   \   00000104   000059E3           CMP      R9,#+0
   \   00000108   F2FFFF1A           BNE      ??TREEVIEW_GetItem_15
   \                     ??TREEVIEW_GetItem_16:
   \   0000010C   ........           BL       GUI_ALLOC_UnlockH
   \                     ??TREEVIEW_GetItem_13:
   \   00000110   ........           BL       GUI_ALLOC_UnlockH
   \   00000114   000056E3           CMP      R6,#+0
   \   00000118   DAFFFF0A           BEQ      ??TREEVIEW_GetItem_12
   \   0000011C   0600A0E1           MOV      R0,R6
   \   00000120   ........           BL       GUI_ALLOC_LockH
   \   00000124   046090E5           LDR      R6,[R0, #+4]
   \   00000128   000056E3           CMP      R6,#+0
   \   0000012C   0600000A           BEQ      ??TREEVIEW_GetItem_17
   \   00000130   ........           BL       GUI_ALLOC_UnlockH
   \   00000134   0600A0E1           MOV      R0,R6
   \   00000138   ........           BL       GUI_ALLOC_LockH
   \   0000013C   1C00D0E5           LDRB     R0,[R0, #+28]
   \   00000140   1C10D7E5           LDRB     R1,[R7, #+28]
   \   00000144   010050E1           CMP      R0,R1
   \   00000148   0650A001           MOVEQ    R5,R6
   \                     ??TREEVIEW_GetItem_17:
   \   0000014C   ........           BL       GUI_ALLOC_UnlockH
   \   00000150   CCFFFFEA           B        ??TREEVIEW_GetItem_12
   \                     ??TREEVIEW_GetItem_8:
   \   00000154   000057E3           CMP      R7,#+0
   \   00000158   CBFFFF0A           BEQ      ??TREEVIEW_GetItem_11
   \   0000015C   1C70D7E5           LDRB     R7,[R7, #+28]
   \                     ??TREEVIEW_GetItem_18:
   \   00000160   0600A0E1           MOV      R0,R6
   \   00000164   ........           BL       GUI_ALLOC_LockH
   \   00000168   086090E5           LDR      R6,[R0, #+8]
   \   0000016C   1800D0E5           LDRB     R0,[R0, #+24]
   \   00000170   010000E2           AND      R0,R0,#0x1
   \   00000174   018020E2           EOR      R8,R0,#0x1
   \   00000178   030000EA           B        ??TREEVIEW_GetItem_19
   \                     ??TREEVIEW_GetItem_20:
   \   0000017C   010000AA           BGE      ??TREEVIEW_GetItem_21
   \   00000180   000058E3           CMP      R8,#+0
   \   00000184   F0FFFF1A           BNE      ??TREEVIEW_GetItem_17
   \                     ??TREEVIEW_GetItem_21:
   \   00000188   086090E5           LDR      R6,[R0, #+8]
   \                     ??TREEVIEW_GetItem_19:
   \   0000018C   000056E3           CMP      R6,#+0
   \   00000190   EDFFFF0A           BEQ      ??TREEVIEW_GetItem_17
   \   00000194   ........           BL       GUI_ALLOC_UnlockH
   \   00000198   0600A0E1           MOV      R0,R6
   \   0000019C   ........           BL       GUI_ALLOC_LockH
   \   000001A0   1C10D0E5           LDRB     R1,[R0, #+28]
   \   000001A4   070051E1           CMP      R1,R7
   \   000001A8   F3FFFF1A           BNE      ??TREEVIEW_GetItem_20
   \   000001AC   0650A0E1           MOV      R5,R6
   \   000001B0   E5FFFFEA           B        ??TREEVIEW_GetItem_17
   \                     ??TREEVIEW_GetItem_9:
   \   000001B4   000057E3           CMP      R7,#+0
   \   000001B8   B3FFFF0A           BEQ      ??TREEVIEW_GetItem_11
   \   000001BC   1800D7E5           LDRB     R0,[R7, #+24]
   \   000001C0   010010E3           TST      R0,#0x1
   \   000001C4   AFFFFF0A           BEQ      ??TREEVIEW_GetItem_12
   \   000001C8   045097E5           LDR      R5,[R7, #+4]
   \   000001CC   ADFFFFEA           B        ??TREEVIEW_GetItem_12
   \                     ??TREEVIEW_GetItem_10:
   \   000001D0   000057E3           CMP      R7,#+0
   \   000001D4   ACFFFF0A           BEQ      ??TREEVIEW_GetItem_11
   \   000001D8   1C00D7E5           LDRB     R0,[R7, #+28]
   \   000001DC   000050E3           CMP      R0,#+0
   \   000001E0   A8FFFF0A           BEQ      ??TREEVIEW_GetItem_12
   \   000001E4   017040E2           SUB      R7,R0,#+1
   \   000001E8   DCFFFFEA           B        ??TREEVIEW_GetItem_18
   2172          }
   2173          
   2174          /*********************************************************************
   2175          *
   2176          *       TREEVIEW_GetSel
   2177          */

   \                                 In section .text, align 4, keep-with-next
   2178          TREEVIEW_ITEM_Handle TREEVIEW_GetSel(TREEVIEW_Handle hObj) {
   \                     TREEVIEW_GetSel:
   \   00000000   30402DE9           PUSH     {R4,R5,LR}
   \   00000004   04D04DE2           SUB      SP,SP,#+4
   \   00000008   0040B0E1           MOVS     R4,R0
   2179            TREEVIEW_ITEM_Handle hItem = 0;
   \   0000000C   0050A0E3           MOV      R5,#+0
   2180            TREEVIEW_OBJ       * pObj;
   2181            if (hObj) {
   \   00000010   0500000A           BEQ      ??TREEVIEW_GetSel_0
   2182              WM_LOCK();
   \   00000014   ........           BL       GUI_Lock
   2183              pObj = TREEVIEW_LOCK_H(hObj);
   2184              hItem = pObj->hSel;
   \   00000018   0400A0E1           MOV      R0,R4
   \   0000001C   ........           BL       GUI_ALLOC_LockH
   \   00000020   A85090E5           LDR      R5,[R0, #+168]
   2185              GUI_UNLOCK_H(pObj);
   \   00000024   ........           BL       GUI_ALLOC_UnlockH
   2186              WM_UNLOCK();
   \   00000028   ........           BL       GUI_Unlock
   2187            }
   2188            return hItem;
   \                     ??TREEVIEW_GetSel_0:
   \   0000002C   0500A0E1           MOV      R0,R5
   \   00000030   04D08DE2           ADD      SP,SP,#+4
   \   00000034   3080BDE8           POP      {R4,R5,PC}       ;; return
   2189          }
   2190          
   2191          /*********************************************************************
   2192          *
   2193          *       TREEVIEW_SetImage
   2194          */

   \                                 In section .text, align 4, keep-with-next
   2195          void TREEVIEW_SetImage(TREEVIEW_Handle hObj, int Index, const GUI_BITMAP * pBitmap) {
   \                     TREEVIEW_SetImage:
   \   00000000   70402DE9           PUSH     {R4-R6,LR}
   \   00000004   0040A0E1           MOV      R4,R0
   \   00000008   0150A0E1           MOV      R5,R1
   \   0000000C   0260A0E1           MOV      R6,R2
   2196            TREEVIEW_OBJ * pObj;
   2197            if (hObj) {
   \   00000010   000054E3           CMP      R4,#+0
   \   00000014   0A00000A           BEQ      ??TREEVIEW_SetImage_0
   2198              WM_LOCK();
   \   00000018   ........           BL       GUI_Lock
   2199              pObj = TREEVIEW_LOCK_H(hObj);
   \   0000001C   0400A0E1           MOV      R0,R4
   \   00000020   ........           BL       GUI_ALLOC_LockH
   2200              if (Index < GUI_COUNTOF(pObj->Props.apBm)) {
   \   00000024   050055E3           CMP      R5,#+5
   \   00000028   0300002A           BCS      ??TREEVIEW_SetImage_1
   2201                pObj->Props.apBm[Index] = pBitmap;
   \   0000002C   050180E0           ADD      R0,R0,R5, LSL #+2
   \   00000030   7C6080E5           STR      R6,[R0, #+124]
   2202                WM_InvalidateWindow(hObj);
   \   00000034   0400A0E1           MOV      R0,R4
   \   00000038   ........           BL       WM_InvalidateWindow
   2203              }
   2204              GUI_UNLOCK_H(pObj);
   \                     ??TREEVIEW_SetImage_1:
   \   0000003C   ........           BL       GUI_ALLOC_UnlockH
   2205              WM_UNLOCK();
   \   00000040   ........           BL       GUI_Unlock
   2206            }
   2207          }
   \                     ??TREEVIEW_SetImage_0:
   \   00000044   7080BDE8           POP      {R4-R6,PC}       ;; return
   2208          
   2209          /*********************************************************************
   2210          *
   2211          *       TREEVIEW_SetSelMode
   2212          */

   \                                 In section .text, align 4, keep-with-next
   2213          void TREEVIEW_SetSelMode(TREEVIEW_Handle hObj, int Mode) {
   \                     TREEVIEW_SetSelMode:
   \   00000000   30402DE9           PUSH     {R4,R5,LR}
   \   00000004   0040A0E1           MOV      R4,R0
   \   00000008   04D04DE2           SUB      SP,SP,#+4
   \   0000000C   0150A0E1           MOV      R5,R1
   2214            TREEVIEW_OBJ * pObj;
   2215            if (hObj) {
   \   00000010   000054E3           CMP      R4,#+0
   \   00000014   1500000A           BEQ      ??TREEVIEW_SetSelMode_0
   2216              WM_LOCK();
   \   00000018   ........           BL       GUI_Lock
   2217              pObj = TREEVIEW_LOCK_H(hObj);
   \   0000001C   0400A0E1           MOV      R0,R4
   \   00000020   ........           BL       GUI_ALLOC_LockH
   2218              if        (Mode == TREEVIEW_SELMODE_ROW) {
   \   00000024   010055E3           CMP      R5,#+1
   \   00000028   0400001A           BNE      ??TREEVIEW_SetSelMode_1
   2219                if ((pObj->Flags & TREEVIEW_CF_ROWSELECT) == 0) {
   \   0000002C   BC19D0E1           LDRH     R1,[R0, #+156]
   \   00000030   020011E3           TST      R1,#0x2
   \   00000034   0B00001A           BNE      ??TREEVIEW_SetSelMode_2
   2220                  pObj->Flags |= TREEVIEW_CF_ROWSELECT;
   \   00000038   021081E3           ORR      R1,R1,#0x2
   \   0000003C   060000EA           B        ??TREEVIEW_SetSelMode_3
   2221                  WM_InvalidateWindow(hObj);
   2222                }
   2223              } else if (Mode == TREEVIEW_SELMODE_TEXT) {
   \                     ??TREEVIEW_SetSelMode_1:
   \   00000040   000055E3           CMP      R5,#+0
   \   00000044   0700001A           BNE      ??TREEVIEW_SetSelMode_2
   2224                if (pObj->Flags & TREEVIEW_CF_ROWSELECT) {
   \   00000048   9C10D0E5           LDRB     R1,[R0, #+156]
   \   0000004C   020011E3           TST      R1,#0x2
   \   00000050   0400000A           BEQ      ??TREEVIEW_SetSelMode_2
   2225                  pObj->Flags &= ~TREEVIEW_CF_ROWSELECT;
   \   00000054   BC19D0E1           LDRH     R1,[R0, #+156]
   \   00000058   0210C1E3           BIC      R1,R1,#0x2
   \                     ??TREEVIEW_SetSelMode_3:
   \   0000005C   BC19C0E1           STRH     R1,[R0, #+156]
   2226                  WM_InvalidateWindow(hObj);
   \   00000060   0400A0E1           MOV      R0,R4
   \   00000064   ........           BL       WM_InvalidateWindow
   2227                }
   2228              }
   2229              GUI_UNLOCK_H(pObj);
   \                     ??TREEVIEW_SetSelMode_2:
   \   00000068   ........           BL       GUI_ALLOC_UnlockH
   2230              WM_UNLOCK();
   \   0000006C   ........           BL       GUI_Unlock
   2231            }
   2232          }
   \                     ??TREEVIEW_SetSelMode_0:
   \   00000070   04D08DE2           ADD      SP,SP,#+4        ;; stack cleaning
   \   00000074   3080BDE8           POP      {R4,R5,PC}       ;; return
   2233          
   2234          /*********************************************************************
   2235          *
   2236          *       TREEVIEW_SetBkColor
   2237          */

   \                                 In section .text, align 4, keep-with-next
   2238          void TREEVIEW_SetBkColor(TREEVIEW_Handle hObj, int Index, GUI_COLOR Color) {
   \                     TREEVIEW_SetBkColor:
   \   00000000   70402DE9           PUSH     {R4-R6,LR}
   \   00000004   0040A0E1           MOV      R4,R0
   \   00000008   0150A0E1           MOV      R5,R1
   \   0000000C   0260A0E1           MOV      R6,R2
   2239            _SetColor(hObj, Index, Color, TREEVIEW_COLORS_BK);
   \   00000010   000054E3           CMP      R4,#+0
   \   00000014   0700000A           BEQ      ??TREEVIEW_SetBkColor_0
   \   00000018   ........           BL       GUI_Lock
   \   0000001C   0400A0E1           MOV      R0,R4
   \   00000020   ........           BL       GUI_ALLOC_LockH
   \   00000024   030055E3           CMP      R5,#+3
   \   00000028   05018030           ADDCC    R0,R0,R5, LSL #+2
   \   0000002C   54608035           STRCC    R6,[R0, #+84]
   \   00000030   ........           BL       GUI_ALLOC_UnlockH
   \   00000034   ........           BL       GUI_Unlock
   2240          }
   \                     ??TREEVIEW_SetBkColor_0:
   \   00000038   7080BDE8           POP      {R4-R6,PC}       ;; return
   2241          
   2242          /*********************************************************************
   2243          *
   2244          *       TREEVIEW_SetTextColor
   2245          */

   \                                 In section .text, align 4, keep-with-next
   2246          void TREEVIEW_SetTextColor(TREEVIEW_Handle hObj, int Index, GUI_COLOR Color) {
   \                     TREEVIEW_SetTextColor:
   \   00000000   70402DE9           PUSH     {R4-R6,LR}
   \   00000004   0040A0E1           MOV      R4,R0
   \   00000008   0150A0E1           MOV      R5,R1
   \   0000000C   0260A0E1           MOV      R6,R2
   2247            _SetColor(hObj, Index, Color, TREEVIEW_COLORS_TEXT);
   \   00000010   000054E3           CMP      R4,#+0
   \   00000014   0700000A           BEQ      ??TREEVIEW_SetTextColor_0
   \   00000018   ........           BL       GUI_Lock
   \   0000001C   0400A0E1           MOV      R0,R4
   \   00000020   ........           BL       GUI_ALLOC_LockH
   \   00000024   030055E3           CMP      R5,#+3
   \   00000028   05018030           ADDCC    R0,R0,R5, LSL #+2
   \   0000002C   60608035           STRCC    R6,[R0, #+96]
   \   00000030   ........           BL       GUI_ALLOC_UnlockH
   \   00000034   ........           BL       GUI_Unlock
   2248          }
   \                     ??TREEVIEW_SetTextColor_0:
   \   00000038   7080BDE8           POP      {R4-R6,PC}       ;; return
   2249          
   2250          /*********************************************************************
   2251          *
   2252          *       TREEVIEW_SetLineColor
   2253          */

   \                                 In section .text, align 4, keep-with-next
   2254          void TREEVIEW_SetLineColor(TREEVIEW_Handle hObj, int Index, GUI_COLOR Color) {
   \                     TREEVIEW_SetLineColor:
   \   00000000   70402DE9           PUSH     {R4-R6,LR}
   \   00000004   0040A0E1           MOV      R4,R0
   \   00000008   0150A0E1           MOV      R5,R1
   \   0000000C   0260A0E1           MOV      R6,R2
   2255            _SetColor(hObj, Index, Color, TREEVIEW_COLORS_LINE);
   \   00000010   000054E3           CMP      R4,#+0
   \   00000014   0700000A           BEQ      ??TREEVIEW_SetLineColor_0
   \   00000018   ........           BL       GUI_Lock
   \   0000001C   0400A0E1           MOV      R0,R4
   \   00000020   ........           BL       GUI_ALLOC_LockH
   \   00000024   030055E3           CMP      R5,#+3
   \   00000028   05018030           ADDCC    R0,R0,R5, LSL #+2
   \   0000002C   6C608035           STRCC    R6,[R0, #+108]
   \   00000030   ........           BL       GUI_ALLOC_UnlockH
   \   00000034   ........           BL       GUI_Unlock
   2256          }
   \                     ??TREEVIEW_SetLineColor_0:
   \   00000038   7080BDE8           POP      {R4-R6,PC}       ;; return
   2257          
   2258          /*********************************************************************
   2259          *
   2260          *       TREEVIEW_SetFont
   2261          */

   \                                 In section .text, align 4, keep-with-next
   2262          void TREEVIEW_SetFont(TREEVIEW_Handle hObj, const GUI_FONT GUI_UNI_PTR * pFont) {
   \                     TREEVIEW_SetFont:
   \   00000000   70402DE9           PUSH     {R4-R6,LR}
   \   00000004   0040A0E1           MOV      R4,R0
   \   00000008   0160A0E1           MOV      R6,R1
   2263            TREEVIEW_OBJ * pObj;
   2264            TREEVIEW_ITEM_Handle hItem;
   2265            TREEVIEW_ITEM_OBJ  * pItem;
   2266            if (hObj && pFont) {
   \   0000000C   000054E3           CMP      R4,#+0
   \   00000010   00005613           CMPNE    R6,#+0
   \   00000014   2600000A           BEQ      ??TREEVIEW_SetFont_0
   2267              WM_LOCK();
   \   00000018   ........           BL       GUI_Lock
   2268              pObj = TREEVIEW_LOCK_H(hObj);
   \   0000001C   0400A0E1           MOV      R0,R4
   \   00000020   ........           BL       GUI_ALLOC_LockH
   \   00000024   0050A0E1           MOV      R5,R0
   2269              if (pObj->Props.pFont != pFont) {
   \   00000028   500095E5           LDR      R0,[R5, #+80]
   \   0000002C   060050E1           CMP      R0,R6
   \   00000030   1D00000A           BEQ      ??TREEVIEW_SetFont_1
   2270                pObj->Props.pFont = pFont;
   \   00000034   506085E5           STR      R6,[R5, #+80]
   2271                GUI_SetFont(pObj->Props.pFont);
   \   00000038   0600A0E1           MOV      R0,R6
   \   0000003C   ........           BL       GUI_SetFont
   2272                hItem = pObj->hFirst;
   \   00000040   A06095E5           LDR      R6,[R5, #+160]
   2273                while (hItem) {
   \   00000044   000056E3           CMP      R6,#+0
   \   00000048   0F00000A           BEQ      ??TREEVIEW_SetFont_2
   2274                  pItem = (TREEVIEW_ITEM_OBJ *)GUI_LOCK_H(hItem);
   \                     ??TREEVIEW_SetFont_3:
   \   0000004C   0600A0E1           MOV      R0,R6
   \   00000050   ........           BL       GUI_ALLOC_LockH
   \   00000054   0060A0E1           MOV      R6,R0
   2275                  pItem->xSize = (pItem->Level + 1) * pObj->Props.Indent 
   2276                               + pObj->Props.TextIndent
   2277                               + GUI_GetStringDistX(pItem->acText);
   \   00000058   1D0086E2           ADD      R0,R6,#+29
   \   0000005C   ........           BL       GUI_GetStringDistX
   \   00000060   1C10D6E5           LDRB     R1,[R6, #+28]
   \   00000064   902095E5           LDR      R2,[R5, #+144]
   \   00000068   943095E5           LDR      R3,[R5, #+148]
   \   0000006C   011081E2           ADD      R1,R1,#+1
   \   00000070   813201E1           SMLABB   R1,R1,R2,R3
   \   00000074   010080E0           ADD      R0,R0,R1
   \   00000078   B401C6E1           STRH     R0,[R6, #+20]
   2278                  hItem = pItem->hNext;
   \   0000007C   046096E5           LDR      R6,[R6, #+4]
   2279                  GUI_UNLOCK_H(pItem);
   \   00000080   ........           BL       GUI_ALLOC_UnlockH
   \   00000084   000056E3           CMP      R6,#+0
   \   00000088   EFFFFF1A           BNE      ??TREEVIEW_SetFont_3
   2280                }
   2281                GUI_UNLOCK_H(pObj);
   \                     ??TREEVIEW_SetFont_2:
   \   0000008C   ........           BL       GUI_ALLOC_UnlockH
   2282                _CalcParams(hObj);
   \   00000090   0400A0E1           MOV      R0,R4
   \   00000094   ........           BL       _CalcParams
   2283                _ManageAutoScroll(hObj);
   \   00000098   0400A0E1           MOV      R0,R4
   \   0000009C   ........           BL       _ManageAutoScroll
   2284                WM_InvalidateWindow(hObj);
   \   000000A0   0400A0E1           MOV      R0,R4
   \   000000A4   ........           BL       WM_InvalidateWindow
   \   000000A8   000000EA           B        ??TREEVIEW_SetFont_4
   2285              } else {
   2286                GUI_UNLOCK_H(pObj);
   \                     ??TREEVIEW_SetFont_1:
   \   000000AC   ........           BL       GUI_ALLOC_UnlockH
   2287              }
   2288              WM_UNLOCK();
   \                     ??TREEVIEW_SetFont_4:
   \   000000B0   ........           BL       GUI_Unlock
   2289            }
   2290          }
   \                     ??TREEVIEW_SetFont_0:
   \   000000B4   7080BDE8           POP      {R4-R6,PC}       ;; return
   2291          
   2292          /*********************************************************************
   2293          *
   2294          *       TREEVIEW_IncSel
   2295          */

   \                                 In section .text, align 4, keep-with-next
   2296          void TREEVIEW_IncSel(TREEVIEW_Handle hObj) {
   2297            _MoveSel(hObj, 1);
   \                     TREEVIEW_IncSel:
   \   00000000   0110A0E3           MOV      R1,#+1
   \   00000004   ........           B        _MoveSel         ;; tailcall
   2298          }
   2299          
   2300          /*********************************************************************
   2301          *
   2302          *       TREEVIEW_DecSel
   2303          */

   \                                 In section .text, align 4, keep-with-next
   2304          void TREEVIEW_DecSel(TREEVIEW_Handle hObj) {
   2305            _MoveSel(hObj, -1);
   \                     TREEVIEW_DecSel:
   \   00000000   0010E0E3           MVN      R1,#+0
   \   00000004   ........           B        _MoveSel         ;; tailcall
   2306          }
   2307          
   2308          /*********************************************************************
   2309          *
   2310          *       TREEVIEW_SetSel
   2311          */

   \                                 In section .text, align 4, keep-with-next
   2312          void TREEVIEW_SetSel(TREEVIEW_Handle hObj, TREEVIEW_ITEM_Handle hItem) {
   \                     TREEVIEW_SetSel:
   \   00000000   70402DE9           PUSH     {R4-R6,LR}
   \   00000004   0040A0E1           MOV      R4,R0
   \   00000008   08D04DE2           SUB      SP,SP,#+8
   \   0000000C   0150A0E1           MOV      R5,R1
   2313            if (hObj) {
   \   00000010   000054E3           CMP      R4,#+0
   \   00000014   2400000A           BEQ      ??TREEVIEW_SetSel_0
   2314              WM_LOCK();
   \   00000018   ........           BL       GUI_Lock
   2315              _SetSel(hObj, hItem);
   \   0000001C   0400A0E1           MOV      R0,R4
   \   00000020   ........           BL       GUI_ALLOC_LockH
   \   00000024   A86090E5           LDR      R6,[R0, #+168]
   \   00000028   A85080E5           STR      R5,[R0, #+168]
   \   0000002C   ........           BL       GUI_ALLOC_UnlockH
   \   00000030   0400A0E1           MOV      R0,R4
   \   00000034   ........           BL       _UpdateScrollPos
   \   00000038   000050E3           CMP      R0,#+0
   \   0000003C   0200000A           BEQ      ??TREEVIEW_SetSel_1
   \   00000040   0400A0E1           MOV      R0,R4
   \   00000044   ........           BL       WM_InvalidateWindow
   \   00000048   130000EA           B        ??TREEVIEW_SetSel_2
   \                     ??TREEVIEW_SetSel_1:
   \   0000004C   0D20A0E1           MOV      R2,SP
   \   00000050   0610A0E1           MOV      R1,R6
   \   00000054   0400A0E1           MOV      R0,R4
   \   00000058   ........           BL       _GetVisibility
   \   0000005C   000050E3           CMP      R0,#+0
   \   00000060   01005013           CMPNE    R0,#+1
   \   00000064   0200001A           BNE      ??TREEVIEW_SetSel_3
   \   00000068   0D10A0E1           MOV      R1,SP
   \   0000006C   0400A0E1           MOV      R0,R4
   \   00000070   ........           BL       WM_InvalidateRect
   \                     ??TREEVIEW_SetSel_3:
   \   00000074   0D20A0E1           MOV      R2,SP
   \   00000078   0510A0E1           MOV      R1,R5
   \   0000007C   0400A0E1           MOV      R0,R4
   \   00000080   ........           BL       _GetVisibility
   \   00000084   000050E3           CMP      R0,#+0
   \   00000088   01005013           CMPNE    R0,#+1
   \   0000008C   0200001A           BNE      ??TREEVIEW_SetSel_2
   \   00000090   0D10A0E1           MOV      R1,SP
   \   00000094   0400A0E1           MOV      R0,R4
   \   00000098   ........           BL       WM_InvalidateRect
   \                     ??TREEVIEW_SetSel_2:
   \   0000009C   0410A0E3           MOV      R1,#+4
   \   000000A0   0400A0E1           MOV      R0,R4
   \   000000A4   ........           BL       WM_NotifyParent
   2316              WM_UNLOCK();
   \   000000A8   ........           BL       GUI_Unlock
   2317            }
   2318          }
   \                     ??TREEVIEW_SetSel_0:
   \   000000AC   08D08DE2           ADD      SP,SP,#+8        ;; stack cleaning
   \   000000B0   7080BDE8           POP      {R4-R6,PC}       ;; return
   2319          
   2320          /*********************************************************************
   2321          *
   2322          *       Exported routines, item related
   2323          *
   2324          **********************************************************************
   2325          */
   2326          /*********************************************************************
   2327          *
   2328          *       TREEVIEW_ITEM_Detach
   2329          */

   \                                 In section .text, align 4, keep-with-next
   2330          void TREEVIEW_ITEM_Detach(TREEVIEW_ITEM_Handle hItem) {
   \                     TREEVIEW_ITEM_Detach:
   \   00000000   F04F2DE9           PUSH     {R4-R11,LR}
   \   00000004   04D04DE2           SUB      SP,SP,#+4
   \   00000008   0040B0E1           MOVS     R4,R0
   2331            TREEVIEW_Handle      hObj;
   2332            TREEVIEW_OBJ       * pObj;
   2333            TREEVIEW_ITEM_OBJ  * pItem;
   2334            TREEVIEW_ITEM_Handle hItemPrev;
   2335            TREEVIEW_ITEM_OBJ  * pItemPrev;
   2336            TREEVIEW_ITEM_Handle hItemNext;
   2337            TREEVIEW_ITEM_OBJ  * pItemNext;
   2338            TREEVIEW_ITEM_Handle hItemLast;
   2339            TREEVIEW_ITEM_OBJ  * pItemLast;
   2340            TREEVIEW_ITEM_Handle hItemNewSel;
   2341            int Level;
   2342          
   2343            if (hItem) {
   \   0000000C   9600000A           BEQ      ??TREEVIEW_ITEM_Detach_0
   2344              WM_LOCK();
   \   00000010   ........           BL       GUI_Lock
   2345              pItem = (TREEVIEW_ITEM_OBJ *)GUI_LOCK_H(hItem);
   \   00000014   0400A0E1           MOV      R0,R4
   \   00000018   ........           BL       GUI_ALLOC_LockH
   \   0000001C   0050A0E1           MOV      R5,R0
   2346              if (pItem->hParent) {
   \   00000020   006095E5           LDR      R6,[R5, #+0]
   \   00000024   000056E3           CMP      R6,#+0
   \   00000028   8D00000A           BEQ      ??TREEVIEW_ITEM_Detach_1
   2347                hObj      = pItem->hParent;
   2348                pObj      = TREEVIEW_LOCK_H(hObj);
   \   0000002C   0600A0E1           MOV      R0,R6
   \   00000030   ........           BL       GUI_ALLOC_LockH
   \   00000034   0070A0E1           MOV      R7,R0
   2349                hItemLast = _GetLastNodeItem(hItem);
   \   00000038   0400A0E1           MOV      R0,R4
   \   0000003C   ........           BL       GUI_ALLOC_LockH
   \   00000040   1810D0E5           LDRB     R1,[R0, #+24]
   \   00000044   1C80D0E5           LDRB     R8,[R0, #+28]
   \   00000048   0490A0E1           MOV      R9,R4
   \   0000004C   010011E3           TST      R1,#0x1
   \   00000050   04A09015           LDRNE    R10,[R0, #+4]
   \   00000054   00005A13           CMPNE    R10,#+0
   \   00000058   1000000A           BEQ      ??TREEVIEW_ITEM_Detach_2
   \   0000005C   0A00A0E1           MOV      R0,R10
   \   00000060   ........           BL       GUI_ALLOC_LockH
   \   00000064   050000EA           B        ??TREEVIEW_ITEM_Detach_3
   \                     ??TREEVIEW_ITEM_Detach_4:
   \   00000068   ........           BL       GUI_ALLOC_UnlockH
   \   0000006C   0A00A0E1           MOV      R0,R10
   \   00000070   ........           BL       GUI_ALLOC_LockH
   \   00000074   1C10D0E5           LDRB     R1,[R0, #+28]
   \   00000078   010058E1           CMP      R8,R1
   \   0000007C   0A90A0B1           MOVLT    R9,R10
   \                     ??TREEVIEW_ITEM_Detach_3:
   \   00000080   1C10D0E5           LDRB     R1,[R0, #+28]
   \   00000084   010058E1           CMP      R8,R1
   \   00000088   030000AA           BGE      ??TREEVIEW_ITEM_Detach_5
   \   0000008C   0A90A0E1           MOV      R9,R10
   \   00000090   04A090E5           LDR      R10,[R0, #+4]
   \   00000094   00005AE3           CMP      R10,#+0
   \   00000098   F2FFFF1A           BNE      ??TREEVIEW_ITEM_Detach_4
   \                     ??TREEVIEW_ITEM_Detach_5:
   \   0000009C   ........           BL       GUI_ALLOC_UnlockH
   \                     ??TREEVIEW_ITEM_Detach_2:
   \   000000A0   ........           BL       GUI_ALLOC_UnlockH
   2350                if (hItemLast) {
   \   000000A4   000059E3           CMP      R9,#+0
   \   000000A8   0400000A           BEQ      ??TREEVIEW_ITEM_Detach_6
   2351                  pItemLast = (TREEVIEW_ITEM_OBJ *)GUI_LOCK_H(hItemLast);
   \   000000AC   0900A0E1           MOV      R0,R9
   \   000000B0   ........           BL       GUI_ALLOC_LockH
   \   000000B4   0080A0E1           MOV      R8,R0
   2352                  hItemNext = pItemLast->hNext;
   \   000000B8   04A098E5           LDR      R10,[R8, #+4]
   \   000000BC   010000EA           B        ??TREEVIEW_ITEM_Detach_7
   2353                } else {
   2354                  pItemLast = NULL;
   \                     ??TREEVIEW_ITEM_Detach_6:
   \   000000C0   0080A0E3           MOV      R8,#+0
   2355                  hItemNext = pItem->hNext;
   \   000000C4   04A095E5           LDR      R10,[R5, #+4]
   2356                }
   2357                hItemPrev = pItem->hPrev;
   2358                Level     = pItem->Level;
   \                     ??TREEVIEW_ITEM_Detach_7:
   \   000000C8   1C20D5E5           LDRB     R2,[R5, #+28]
   \   000000CC   080095E5           LDR      R0,[R5, #+8]
   \   000000D0   00208DE5           STR      R2,[SP, #+0]
   2359                if (hItem == pObj->hLast) {
   \   000000D4   A41097E5           LDR      R1,[R7, #+164]
   \   000000D8   00B0A0E1           MOV      R11,R0
   \   000000DC   010054E1           CMP      R4,R1
   2360                  pObj->hLast = pItem->hPrev;
   \   000000E0   A4008705           STREQ    R0,[R7, #+164]
   2361                }
   2362                if (hItemPrev) {
   \   000000E4   00005BE3           CMP      R11,#+0
   \   000000E8   0300000A           BEQ      ??TREEVIEW_ITEM_Detach_8
   2363                  pItemPrev = (TREEVIEW_ITEM_OBJ *)GUI_LOCK_H(hItemPrev);
   2364                  pItemPrev->hNext = hItemNext;
   \   000000EC   ........           BL       GUI_ALLOC_LockH
   \   000000F0   04A080E5           STR      R10,[R0, #+4]
   2365                  GUI_UNLOCK_H(pItemPrev);
   \   000000F4   ........           BL       GUI_ALLOC_UnlockH
   \   000000F8   020000EA           B        ??TREEVIEW_ITEM_Detach_9
   2366                } else {
   2367                  if (pObj->hFirst == hItem) {
   \                     ??TREEVIEW_ITEM_Detach_8:
   \   000000FC   A00097E5           LDR      R0,[R7, #+160]
   \   00000100   040050E1           CMP      R0,R4
   2368                    pObj->hFirst = hItemNext;
   \   00000104   A0A08705           STREQ    R10,[R7, #+160]
   2369                  } else {
   2370                    GUI_DEBUG_ERROROUT("TREEVIEW_ITEM_Detach: Illegal handle!");
   2371                  }
   2372                }
   2373                if (hItemNext) {
   \                     ??TREEVIEW_ITEM_Detach_9:
   \   00000108   00005AE3           CMP      R10,#+0
   \   0000010C   0300000A           BEQ      ??TREEVIEW_ITEM_Detach_10
   2374                  pItemNext = (TREEVIEW_ITEM_OBJ *)GUI_LOCK_H(hItemNext);
   2375                  pItemNext->hPrev = hItemPrev;
   \   00000110   0A00A0E1           MOV      R0,R10
   \   00000114   ........           BL       GUI_ALLOC_LockH
   \   00000118   08B080E5           STR      R11,[R0, #+8]
   2376                  GUI_UNLOCK_H(pItemNext);
   \   0000011C   ........           BL       GUI_ALLOC_UnlockH
   2377                }
   2378                //
   2379                // Manage selection
   2380                //
   2381                if (pObj->hSel == hItem) {
   \                     ??TREEVIEW_ITEM_Detach_10:
   \   00000120   A80097E5           LDR      R0,[R7, #+168]
   \   00000124   040050E1           CMP      R0,R4
   \   00000128   2B00001A           BNE      ??TREEVIEW_ITEM_Detach_11
   2382                  if (hItemLast) {
   \   0000012C   000059E3           CMP      R9,#+0
   \   00000130   2300000A           BEQ      ??TREEVIEW_ITEM_Detach_12
   2383                    hItemNewSel = _GetNextVisibleItem(hItemLast);
   \   00000134   0900A0E1           MOV      R0,R9
   \   00000138   ........           BL       _GetNextVisibleItem
   2384                    if (hItemNewSel == hItemLast) {
   \   0000013C   090050E1           CMP      R0,R9
   \   00000140   1C00001A           BNE      ??TREEVIEW_ITEM_Detach_13
   2385                      hItemNewSel = _GetPrevVisibleItem(hItem);
   \   00000144   0090A0E3           MOV      R9,#+0
   \   00000148   0400A0E1           MOV      R0,R4
   \   0000014C   ........           BL       GUI_ALLOC_LockH
   \   00000150   1CA0D0E5           LDRB     R10,[R0, #+28]
   \   00000154   0E0000EA           B        ??TREEVIEW_ITEM_Detach_14
   \                     ??TREEVIEW_ITEM_Detach_15:
   \   00000158   ........           BL       GUI_ALLOC_UnlockH
   \   0000015C   0B00A0E1           MOV      R0,R11
   \   00000160   ........           BL       GUI_ALLOC_LockH
   \   00000164   B811D0E1           LDRH     R1,[R0, #+24]
   \   00000168   000059E3           CMP      R9,#+0
   \   0000016C   0B90A001           MOVEQ    R9,R11
   \   00000170   1CA0D005           LDRBEQ   R10,[R0, #+28]
   \   00000174   010011E3           TST      R1,#0x1
   \   00000178   0500000A           BEQ      ??TREEVIEW_ITEM_Detach_14
   \   0000017C   1C20D0E5           LDRB     R2,[R0, #+28]
   \   00000180   0A0052E1           CMP      R2,R10
   \   00000184   020000AA           BGE      ??TREEVIEW_ITEM_Detach_14
   \   00000188   020011E3           TST      R1,#0x2
   \   0000018C   0B90A001           MOVEQ    R9,R11
   \   00000190   02A0A0E1           MOV      R10,R2
   \                     ??TREEVIEW_ITEM_Detach_14:
   \   00000194   08B090E5           LDR      R11,[R0, #+8]
   \   00000198   00005BE3           CMP      R11,#+0
   \   0000019C   EDFFFF1A           BNE      ??TREEVIEW_ITEM_Detach_15
   \   000001A0   ........           BL       GUI_ALLOC_UnlockH
   \   000001A4   000059E3           CMP      R9,#+0
   \   000001A8   0900A011           MOVNE    R0,R9
   \   000001AC   0400A001           MOVEQ    R0,R4
   2386                      if (hItemNewSel == hItem) {
   \   000001B0   040050E1           CMP      R0,R4
   2387                        pObj->hSel = 0;
   \   000001B4   0000A003           MOVEQ    R0,#+0
   \                     ??TREEVIEW_ITEM_Detach_13:
   \   000001B8   A80087E5           STR      R0,[R7, #+168]
   \   000001BC   060000EA           B        ??TREEVIEW_ITEM_Detach_11
   2388                      } else {
   2389                        pObj->hSel = hItemNewSel;
   2390                      }
   2391                    } else {
   2392                      pObj->hSel = hItemNewSel;
   2393                    }
   2394                  } else {
   2395                    hItemNewSel = _GetPrevVisibleItem(hItem);
   2396                  }
   2397                }
   \                     ??TREEVIEW_ITEM_Detach_16:
   \   000001C0   ........           BL       GUI_ALLOC_UnlockH
   \                     ??TREEVIEW_ITEM_Detach_12:
   \   000001C4   0400A0E1           MOV      R0,R4
   \   000001C8   ........           BL       GUI_ALLOC_LockH
   \   000001CC   084090E5           LDR      R4,[R0, #+8]
   \   000001D0   000054E3           CMP      R4,#+0
   \   000001D4   F9FFFF1A           BNE      ??TREEVIEW_ITEM_Detach_16
   \   000001D8   ........           BL       GUI_ALLOC_UnlockH
   2398                //
   2399                // Remove items
   2400                //
   2401                if (pItemLast) {
   \                     ??TREEVIEW_ITEM_Detach_11:
   \   000001DC   0090A0E3           MOV      R9,#+0
   \   000001E0   000058E3           CMP      R8,#+0
   2402                  pItemLast->hNext = 0;
   \   000001E4   04908815           STRNE    R9,[R8, #+4]
   2403                }
   2404                pItem->hPrev     = 0;
   \   000001E8   089085E5           STR      R9,[R5, #+8]
   2405                pItem->Level     = 0;
   \   000001EC   1C90C5E5           STRB     R9,[R5, #+28]
   2406                pItem->hParent   = 0;
   \   000001F0   009085E5           STR      R9,[R5, #+0]
   \   000001F4   080000EA           B        ??TREEVIEW_ITEM_Detach_17
   2407                do {
   2408                  pObj->NumItems--;
   2409                  hItem = pItem->hNext;
   2410                  if (hItem) {
   2411                    GUI_UNLOCK_H(pItem);
   \                     ??TREEVIEW_ITEM_Detach_18:
   \   000001F8   ........           BL       GUI_ALLOC_UnlockH
   2412                    pItem = (TREEVIEW_ITEM_OBJ *)GUI_LOCK_H(hItem);
   \   000001FC   0400A0E1           MOV      R0,R4
   \   00000200   ........           BL       GUI_ALLOC_LockH
   \   00000204   0050A0E1           MOV      R5,R0
   2413                    pItem->hParent = 0;
   \   00000208   009085E5           STR      R9,[R5, #+0]
   2414                    pItem->Level  -= Level;
   \   0000020C   1C00D5E5           LDRB     R0,[R5, #+28]
   \   00000210   00109DE5           LDR      R1,[SP, #+0]
   \   00000214   010040E0           SUB      R0,R0,R1
   \   00000218   1C00C5E5           STRB     R0,[R5, #+28]
   2415                  }
   \                     ??TREEVIEW_ITEM_Detach_17:
   \   0000021C   B00097E5           LDR      R0,[R7, #+176]
   \   00000220   010040E2           SUB      R0,R0,#+1
   \   00000224   B00087E5           STR      R0,[R7, #+176]
   \   00000228   044095E5           LDR      R4,[R5, #+4]
   \   0000022C   000054E3           CMP      R4,#+0
   \   00000230   F0FFFF1A           BNE      ??TREEVIEW_ITEM_Detach_18
   2416                } while (hItem);
   2417                if (pItemLast) {
   \   00000234   000058E3           CMP      R8,#+0
   \   00000238   0000000A           BEQ      ??TREEVIEW_ITEM_Detach_19
   2418                  GUI_UNLOCK_H(pItemLast);
   \   0000023C   ........           BL       GUI_ALLOC_UnlockH
   2419                }
   2420                GUI_UNLOCK_H(pItem);
   \                     ??TREEVIEW_ITEM_Detach_19:
   \   00000240   ........           BL       GUI_ALLOC_UnlockH
   2421                GUI_UNLOCK_H(pObj);
   \   00000244   ........           BL       GUI_ALLOC_UnlockH
   2422                _CalcParams(hObj);
   \   00000248   0600A0E1           MOV      R0,R6
   \   0000024C   ........           BL       _CalcParams
   2423                _ManageAutoScroll(hObj);
   \   00000250   0600A0E1           MOV      R0,R6
   \   00000254   ........           BL       _ManageAutoScroll
   2424                WM_InvalidateWindow(hObj);
   \   00000258   0600A0E1           MOV      R0,R6
   \   0000025C   ........           BL       WM_InvalidateWindow
   \   00000260   000000EA           B        ??TREEVIEW_ITEM_Detach_20
   2425              } else {
   2426                GUI_UNLOCK_H(pItem);
   \                     ??TREEVIEW_ITEM_Detach_1:
   \   00000264   ........           BL       GUI_ALLOC_UnlockH
   2427              }
   2428              WM_UNLOCK();
   \                     ??TREEVIEW_ITEM_Detach_20:
   \   00000268   ........           BL       GUI_Unlock
   2429            }
   2430          }
   \                     ??TREEVIEW_ITEM_Detach_0:
   \   0000026C   04D08DE2           ADD      SP,SP,#+4        ;; stack cleaning
   \   00000270   F08FBDE8           POP      {R4-R11,PC}      ;; return
   2431          
   2432          /*********************************************************************
   2433          *
   2434          *       TREEVIEW_ITEM_Delete
   2435          *
   2436          * Purpose:
   2437          *   Deletes the given item. If the item is a node, it also deletes all children of the node
   2438          */

   \                                 In section .text, align 4, keep-with-next
   2439          void TREEVIEW_ITEM_Delete(TREEVIEW_ITEM_Handle hItem) {
   \                     TREEVIEW_ITEM_Delete:
   \   00000000   70402DE9           PUSH     {R4-R6,LR}
   \   00000004   0040B0E1           MOVS     R4,R0
   2440            TREEVIEW_Handle      hObj;
   2441            TREEVIEW_ITEM_OBJ  * pItem;
   2442            TREEVIEW_ITEM_Handle hItemFree;
   2443            if (hItem) {
   \   00000008   1B00000A           BEQ      ??TREEVIEW_ITEM_Delete_0
   2444              TREEVIEW_ITEM_Detach(hItem);
   \   0000000C   ........           BL       TREEVIEW_ITEM_Detach
   2445              WM_LOCK();
   \   00000010   ........           BL       GUI_Lock
   2446              pItem = (TREEVIEW_ITEM_OBJ *)GUI_LOCK_H(hItem);
   2447              hObj  = pItem->hParent;
   \   00000014   0400A0E1           MOV      R0,R4
   \   00000018   ........           BL       GUI_ALLOC_LockH
   \   0000001C   005090E5           LDR      R5,[R0, #+0]
   2448              while (hItem) {
   2449                hItemFree = hItem;
   \                     ??TREEVIEW_ITEM_Delete_1:
   \   00000020   0460A0E1           MOV      R6,R4
   2450                GUI_UNLOCK_H(pItem);
   \   00000024   ........           BL       GUI_ALLOC_UnlockH
   2451                pItem     = (TREEVIEW_ITEM_OBJ *)GUI_LOCK_H(hItem);
   \   00000028   0400A0E1           MOV      R0,R4
   \   0000002C   ........           BL       GUI_ALLOC_LockH
   2452                hItem     = pItem->hNext;
   \   00000030   044090E5           LDR      R4,[R0, #+4]
   2453                if (pItem->hData) {
   \   00000034   100090E5           LDR      R0,[R0, #+16]
   \   00000038   000050E3           CMP      R0,#+0
   \   0000003C   0000000A           BEQ      ??TREEVIEW_ITEM_Delete_2
   2454                  GUI_ALLOC_Free(pItem->hData);
   \   00000040   ........           BL       GUI_ALLOC_Free
   2455                }
   2456                GUI_ALLOC_Free(hItemFree);
   \                     ??TREEVIEW_ITEM_Delete_2:
   \   00000044   0600A0E1           MOV      R0,R6
   \   00000048   ........           BL       GUI_ALLOC_Free
   \   0000004C   000054E3           CMP      R4,#+0
   \   00000050   F2FFFF1A           BNE      ??TREEVIEW_ITEM_Delete_1
   2457              }
   2458              GUI_UNLOCK_H(pItem);
   \   00000054   ........           BL       GUI_ALLOC_UnlockH
   2459              if (hObj) {
   \   00000058   000055E3           CMP      R5,#+0
   \   0000005C   0500000A           BEQ      ??TREEVIEW_ITEM_Delete_3
   2460                _CalcParams(hObj);
   \   00000060   0500A0E1           MOV      R0,R5
   \   00000064   ........           BL       _CalcParams
   2461                _ManageAutoScroll(hObj);
   \   00000068   0500A0E1           MOV      R0,R5
   \   0000006C   ........           BL       _ManageAutoScroll
   2462                WM_InvalidateWindow(hObj);
   \   00000070   0500A0E1           MOV      R0,R5
   \   00000074   ........           BL       WM_InvalidateWindow
   2463              }
   2464              WM_UNLOCK();
   \                     ??TREEVIEW_ITEM_Delete_3:
   \   00000078   ........           BL       GUI_Unlock
   2465            }
   2466          }
   \                     ??TREEVIEW_ITEM_Delete_0:
   \   0000007C   7080BDE8           POP      {R4-R6,PC}       ;; return
   2467          
   2468          /*********************************************************************
   2469          *
   2470          *       TREEVIEW_ITEM_Expand
   2471          */

   \                                 In section .text, align 4, keep-with-next
   2472          void TREEVIEW_ITEM_Expand(TREEVIEW_ITEM_Handle hItem) {
   \                     TREEVIEW_ITEM_Expand:
   \   00000000   10402DE9           PUSH     {R4,LR}
   \   00000004   0040B0E1           MOVS     R4,R0
   2473            if (hItem) {
   \   00000008   1500000A           BEQ      ??TREEVIEW_ITEM_Expand_0
   2474              WM_LOCK();
   \   0000000C   ........           BL       GUI_Lock
   2475              _ExpandItem(hItem);
   \   00000010   0400A0E1           MOV      R0,R4
   \   00000014   ........           BL       GUI_ALLOC_LockH
   \   00000018   B811D0E1           LDRH     R1,[R0, #+24]
   \   0000001C   004090E5           LDR      R4,[R0, #+0]
   \   00000020   032001E2           AND      R2,R1,#0x3
   \   00000024   010052E3           CMP      R2,#+1
   \   00000028   0100000A           BEQ      ??TREEVIEW_ITEM_Expand_1
   \   0000002C   ........           BL       GUI_ALLOC_UnlockH
   \   00000030   0A0000EA           B        ??TREEVIEW_ITEM_Expand_2
   \                     ??TREEVIEW_ITEM_Expand_1:
   \   00000034   021081E3           ORR      R1,R1,#0x2
   \   00000038   B811C0E1           STRH     R1,[R0, #+24]
   \   0000003C   ........           BL       GUI_ALLOC_UnlockH
   \   00000040   000054E3           CMP      R4,#+0
   \   00000044   0500000A           BEQ      ??TREEVIEW_ITEM_Expand_2
   \   00000048   0400A0E1           MOV      R0,R4
   \   0000004C   ........           BL       _CalcParams
   \   00000050   0400A0E1           MOV      R0,R4
   \   00000054   ........           BL       _ManageAutoScroll
   \   00000058   0400A0E1           MOV      R0,R4
   \   0000005C   ........           BL       WM_InvalidateWindow
   2476              WM_UNLOCK();
   \                     ??TREEVIEW_ITEM_Expand_2:
   \   00000060   ........           BL       GUI_Unlock
   2477            }
   2478          }
   \                     ??TREEVIEW_ITEM_Expand_0:
   \   00000064   1080BDE8           POP      {R4,PC}          ;; return
   2479          
   2480          /*********************************************************************
   2481          *
   2482          *       TREEVIEW_ITEM_Collapse
   2483          */

   \                                 In section .text, align 4, keep-with-next
   2484          void TREEVIEW_ITEM_Collapse(TREEVIEW_ITEM_Handle hItem) {
   \                     TREEVIEW_ITEM_Collapse:
   \   00000000   10402DE9           PUSH     {R4,LR}
   \   00000004   0040B0E1           MOVS     R4,R0
   2485            if (hItem) {
   \   00000008   1600000A           BEQ      ??TREEVIEW_ITEM_Collapse_0
   2486              WM_LOCK();
   \   0000000C   ........           BL       GUI_Lock
   2487              _CollapseItem(hItem);
   \   00000010   0400A0E1           MOV      R0,R4
   \   00000014   ........           BL       GUI_ALLOC_LockH
   \   00000018   1810D0E5           LDRB     R1,[R0, #+24]
   \   0000001C   004090E5           LDR      R4,[R0, #+0]
   \   00000020   031001E2           AND      R1,R1,#0x3
   \   00000024   030051E3           CMP      R1,#+3
   \   00000028   0100000A           BEQ      ??TREEVIEW_ITEM_Collapse_1
   \   0000002C   ........           BL       GUI_ALLOC_UnlockH
   \   00000030   0B0000EA           B        ??TREEVIEW_ITEM_Collapse_2
   \                     ??TREEVIEW_ITEM_Collapse_1:
   \   00000034   B811D0E1           LDRH     R1,[R0, #+24]
   \   00000038   0210C1E3           BIC      R1,R1,#0x2
   \   0000003C   B811C0E1           STRH     R1,[R0, #+24]
   \   00000040   ........           BL       GUI_ALLOC_UnlockH
   \   00000044   000054E3           CMP      R4,#+0
   \   00000048   0500000A           BEQ      ??TREEVIEW_ITEM_Collapse_2
   \   0000004C   0400A0E1           MOV      R0,R4
   \   00000050   ........           BL       _CalcParams
   \   00000054   0400A0E1           MOV      R0,R4
   \   00000058   ........           BL       _ManageAutoScroll
   \   0000005C   0400A0E1           MOV      R0,R4
   \   00000060   ........           BL       WM_InvalidateWindow
   2488              WM_UNLOCK();
   \                     ??TREEVIEW_ITEM_Collapse_2:
   \   00000064   ........           BL       GUI_Unlock
   2489            }
   2490          }
   \                     ??TREEVIEW_ITEM_Collapse_0:
   \   00000068   1080BDE8           POP      {R4,PC}          ;; return
   2491          
   2492          /*********************************************************************
   2493          *
   2494          *       TREEVIEW_ITEM_SetImage
   2495          */

   \                                 In section .text, align 4, keep-with-next
   2496          void TREEVIEW_ITEM_SetImage(TREEVIEW_ITEM_Handle hItem, int Index, const GUI_BITMAP * pBitmap) {
   \                     TREEVIEW_ITEM_SetImage:
   \   00000000   F0422DE9           PUSH     {R4-R7,R9,LR}
   \   00000004   0150A0E1           MOV      R5,R1
   \   00000008   0040A0E1           MOV      R4,R0
   \   0000000C   0260A0E1           MOV      R6,R2
   2497            TREEVIEW_ITEM_OBJ  * pItem;
   2498            TREEVIEW_ITEM_DATA * pData;
   2499            WM_HMEM              hData;
   2500            if (Index < GUI_COUNTOF(pData->apBm)) {
   \   00000010   030055E3           CMP      R5,#+3
   \   00000014   1A00002A           BCS      ??TREEVIEW_ITEM_SetImage_0
   2501              WM_LOCK();
   \   00000018   ........           BL       GUI_Lock
   2502              pItem = (TREEVIEW_ITEM_OBJ *)GUI_LOCK_H(hItem);
   \   0000001C   0400A0E1           MOV      R0,R4
   \   00000020   ........           BL       GUI_ALLOC_LockH
   \   00000024   0070A0E1           MOV      R7,R0
   2503              if (pItem->hData == 0) {
   \   00000028   100097E5           LDR      R0,[R7, #+16]
   \   0000002C   000050E3           CMP      R0,#+0
   \   00000030   0700001A           BNE      ??TREEVIEW_ITEM_SetImage_1
   2504                GUI_UNLOCK_H(pItem);
   \   00000034   ........           BL       GUI_ALLOC_UnlockH
   2505                hData = GUI_ALLOC_AllocZero(sizeof(TREEVIEW_ITEM_DATA));
   \   00000038   0C00A0E3           MOV      R0,#+12
   \   0000003C   ........           BL       GUI_ALLOC_AllocZero
   \   00000040   0090A0E1           MOV      R9,R0
   2506                pItem = (TREEVIEW_ITEM_OBJ *)GUI_LOCK_H(hItem);
   \   00000044   0400A0E1           MOV      R0,R4
   \   00000048   ........           BL       GUI_ALLOC_LockH
   \   0000004C   0070A0E1           MOV      R7,R0
   2507                pItem->hData = hData;
   \   00000050   109087E5           STR      R9,[R7, #+16]
   2508              }
   2509              if (pItem->hData) {
   \                     ??TREEVIEW_ITEM_SetImage_1:
   \   00000054   100097E5           LDR      R0,[R7, #+16]
   \   00000058   000050E3           CMP      R0,#+0
   \   0000005C   0600000A           BEQ      ??TREEVIEW_ITEM_SetImage_2
   2510                pData = (TREEVIEW_ITEM_DATA *)GUI_LOCK_H(pItem->hData);
   2511                pData->apBm[Index] = pBitmap;
   \   00000060   ........           BL       GUI_ALLOC_LockH
   \   00000064   056180E7           STR      R6,[R0, +R5, LSL #+2]
   2512                GUI_UNLOCK_H(pData);
   \   00000068   ........           BL       GUI_ALLOC_UnlockH
   2513                if (pItem->hParent) {
   \   0000006C   000097E5           LDR      R0,[R7, #+0]
   \   00000070   000050E3           CMP      R0,#+0
   \   00000074   0000000A           BEQ      ??TREEVIEW_ITEM_SetImage_2
   2514                  WM_InvalidateWindow(pItem->hParent);
   \   00000078   ........           BL       WM_InvalidateWindow
   2515                }
   2516              } else {
   2517                GUI_DEBUG_ERROROUT("TREEVIEW_ITEM_SetImage: Allocation failed!");
   2518              }
   2519              GUI_UNLOCK_H(pItem);
   \                     ??TREEVIEW_ITEM_SetImage_2:
   \   0000007C   ........           BL       GUI_ALLOC_UnlockH
   2520              WM_UNLOCK();
   \   00000080   ........           BL       GUI_Unlock
   2521            }
   2522          }
   \                     ??TREEVIEW_ITEM_SetImage_0:
   \   00000084   F082BDE8           POP      {R4-R7,R9,PC}    ;; return
   2523          
   2524          /*********************************************************************
   2525          *
   2526          *       TREEVIEW_ITEM_SetText
   2527          */

   \                                 In section .text, align 4, keep-with-next
   2528          TREEVIEW_ITEM_Handle TREEVIEW_ITEM_SetText(TREEVIEW_ITEM_Handle hItem, const char * s) {
   \                     TREEVIEW_ITEM_SetText:
   \   00000000   F0402DE9           PUSH     {R4-R7,LR}
   \   00000004   04D04DE2           SUB      SP,SP,#+4
   \   00000008   0040A0E1           MOV      R4,R0
   \   0000000C   0160B0E1           MOVS     R6,R1
   2529            TREEVIEW_ITEM_OBJ  * pItem;
   2530            TREEVIEW_ITEM_Handle hItemNew = 0;
   \   00000010   0050A0E3           MOV      R5,#+0
   2531            TREEVIEW_ITEM_OBJ  * pItemNew;
   2532            TREEVIEW_ITEM_OBJ  * pItemPrev;
   2533            TREEVIEW_ITEM_OBJ  * pItemNext;
   2534            WM_HMEM              hParent;
   2535            if (s) {
   \   00000014   3D00000A           BEQ      ??TREEVIEW_ITEM_SetText_0
   2536              WM_LOCK();
   \   00000018   ........           BL       GUI_Lock
   2537              hItemNew = TREEVIEW_ITEM_Create(0, s, 0);
   \   0000001C   0600A0E1           MOV      R0,R6
   \   00000020   ........           BL       strlen
   \   00000024   200080E2           ADD      R0,R0,#+32
   \   00000028   ........           BL       GUI_ALLOC_AllocZero
   \   0000002C   0050B0E1           MOVS     R5,R0
   \   00000030   0600000A           BEQ      ??TREEVIEW_ITEM_SetText_1
   \   00000034   ........           BL       GUI_ALLOC_LockH
   \   00000038   0070A0E3           MOV      R7,#+0
   \   0000003C   0C7080E5           STR      R7,[R0, #+12]
   \   00000040   0610A0E1           MOV      R1,R6
   \   00000044   1D0080E2           ADD      R0,R0,#+29
   \   00000048   ........           BL       strcpy
   \   0000004C   ........           BL       GUI_ALLOC_UnlockH
   2538              if (hItemNew) {
   \                     ??TREEVIEW_ITEM_SetText_1:
   \   00000050   000055E3           CMP      R5,#+0
   \   00000054   2C00000A           BEQ      ??TREEVIEW_ITEM_SetText_2
   2539                pItem     = (TREEVIEW_ITEM_OBJ *)GUI_LOCK_H(hItem);
   \   00000058   0400A0E1           MOV      R0,R4
   \   0000005C   ........           BL       GUI_ALLOC_LockH
   \   00000060   0070A0E1           MOV      R7,R0
   2540                pItemNew  = (TREEVIEW_ITEM_OBJ *)GUI_LOCK_H(hItemNew);
   \   00000064   0500A0E1           MOV      R0,R5
   \   00000068   ........           BL       GUI_ALLOC_LockH
   \   0000006C   0060A0E1           MOV      R6,R0
   2541                pItemNew->UserData= pItem->UserData;
   \   00000070   0C0097E5           LDR      R0,[R7, #+12]
   \   00000074   0C0086E5           STR      R0,[R6, #+12]
   2542                pItemNew->hNext   = pItem->hNext;
   \   00000078   040097E5           LDR      R0,[R7, #+4]
   \   0000007C   040086E5           STR      R0,[R6, #+4]
   2543                pItemNew->hPrev   = pItem->hPrev;
   \   00000080   080097E5           LDR      R0,[R7, #+8]
   \   00000084   080086E5           STR      R0,[R6, #+8]
   2544                pItemNew->Flags   = pItem->Flags;
   \   00000088   B801D7E1           LDRH     R0,[R7, #+24]
   \   0000008C   B801C6E1           STRH     R0,[R6, #+24]
   2545                pItemNew->hData   = pItem->hData;
   \   00000090   100097E5           LDR      R0,[R7, #+16]
   \   00000094   100086E5           STR      R0,[R6, #+16]
   2546                pItemNew->Level   = pItem->Level;
   \   00000098   1C00D7E5           LDRB     R0,[R7, #+28]
   \   0000009C   1C00C6E5           STRB     R0,[R6, #+28]
   2547                pItemNew->hParent = pItem->hParent;
   \   000000A0   000097E5           LDR      R0,[R7, #+0]
   \   000000A4   000086E5           STR      R0,[R6, #+0]
   2548                if (pItemNew->hPrev) {
   \   000000A8   080096E5           LDR      R0,[R6, #+8]
   \   000000AC   000050E3           CMP      R0,#+0
   \   000000B0   0200000A           BEQ      ??TREEVIEW_ITEM_SetText_3
   2549                  pItemPrev = (TREEVIEW_ITEM_OBJ *)GUI_LOCK_H(pItemNew->hPrev);
   2550                  pItemPrev->hNext = hItemNew;
   \   000000B4   ........           BL       GUI_ALLOC_LockH
   \   000000B8   045080E5           STR      R5,[R0, #+4]
   2551                  GUI_UNLOCK_H(pItemPrev);
   \   000000BC   ........           BL       GUI_ALLOC_UnlockH
   2552                }
   2553                if (pItemNew->hNext) {
   \                     ??TREEVIEW_ITEM_SetText_3:
   \   000000C0   040096E5           LDR      R0,[R6, #+4]
   \   000000C4   000050E3           CMP      R0,#+0
   \   000000C8   0200000A           BEQ      ??TREEVIEW_ITEM_SetText_4
   2554                  pItemNext = (TREEVIEW_ITEM_OBJ *)GUI_LOCK_H(pItemNew->hNext);
   2555                  pItemNext->hPrev = hItemNew;
   \   000000CC   ........           BL       GUI_ALLOC_LockH
   \   000000D0   085080E5           STR      R5,[R0, #+8]
   2556                  GUI_UNLOCK_H(pItemNext);
   \   000000D4   ........           BL       GUI_ALLOC_UnlockH
   2557                }
   2558                GUI_ALLOC_Free(hItem);
   \                     ??TREEVIEW_ITEM_SetText_4:
   \   000000D8   0400A0E1           MOV      R0,R4
   \   000000DC   ........           BL       GUI_ALLOC_Free
   2559                hParent = pItemNew->hParent;
   \   000000E0   004096E5           LDR      R4,[R6, #+0]
   2560                GUI_UNLOCK_H(pItem);
   \   000000E4   ........           BL       GUI_ALLOC_UnlockH
   2561                GUI_UNLOCK_H(pItemNew);
   \   000000E8   ........           BL       GUI_ALLOC_UnlockH
   2562                if (hParent) {
   \   000000EC   000054E3           CMP      R4,#+0
   \   000000F0   0500000A           BEQ      ??TREEVIEW_ITEM_SetText_2
   2563                  _CalcParams(hParent);
   \   000000F4   0400A0E1           MOV      R0,R4
   \   000000F8   ........           BL       _CalcParams
   2564                  _ManageAutoScroll(hParent);
   \   000000FC   0400A0E1           MOV      R0,R4
   \   00000100   ........           BL       _ManageAutoScroll
   2565                  WM_InvalidateWindow(hParent);
   \   00000104   0400A0E1           MOV      R0,R4
   \   00000108   ........           BL       WM_InvalidateWindow
   2566                }
   2567              } else {
   2568                GUI_DEBUG_ERROROUT("TREEVIEW_ITEM_SetText: Allocation failed!");
   2569              }
   2570              WM_UNLOCK();
   \                     ??TREEVIEW_ITEM_SetText_2:
   \   0000010C   ........           BL       GUI_Unlock
   2571            }
   2572            return hItemNew;
   \                     ??TREEVIEW_ITEM_SetText_0:
   \   00000110   0500A0E1           MOV      R0,R5
   \   00000114   04D08DE2           ADD      SP,SP,#+4
   \   00000118   F080BDE8           POP      {R4-R7,PC}       ;; return
   2573          }
   2574          
   2575          /*********************************************************************
   2576          *
   2577          *       TREEVIEW_ITEM_GetText
   2578          */

   \                                 In section .text, align 4, keep-with-next
   2579          void TREEVIEW_ITEM_GetText(TREEVIEW_ITEM_Handle hItem, U8 * pBuffer, int MaxNumBytes) {
   \                     TREEVIEW_ITEM_GetText:
   \   00000000   70402DE9           PUSH     {R4-R6,LR}
   \   00000004   0040A0E1           MOV      R4,R0
   \   00000008   0150A0E1           MOV      R5,R1
   2580            TREEVIEW_ITEM_OBJ  * pItem;
   2581            int NumBytes;
   2582            if (hItem && pBuffer && MaxNumBytes) {
   \   0000000C   000054E3           CMP      R4,#+0
   \   00000010   0260A0E1           MOV      R6,R2
   \   00000014   00005513           CMPNE    R5,#+0
   \   00000018   00005613           CMPNE    R6,#+0
   \   0000001C   1100000A           BEQ      ??TREEVIEW_ITEM_GetText_0
   2583              WM_LOCK();
   \   00000020   ........           BL       GUI_Lock
   2584              pItem = (TREEVIEW_ITEM_OBJ *)GUI_LOCK_H(hItem);
   \   00000024   0400A0E1           MOV      R0,R4
   \   00000028   ........           BL       GUI_ALLOC_LockH
   \   0000002C   0040A0E1           MOV      R4,R0
   2585              NumBytes = strlen(pItem->acText) + 1;
   \   00000030   1D0084E2           ADD      R0,R4,#+29
   \   00000034   ........           BL       strlen
   \   00000038   010080E2           ADD      R0,R0,#+1
   2586              if (NumBytes > MaxNumBytes) {
   \   0000003C   000056E1           CMP      R6,R0
   \   00000040   0060A0C1           MOVGT    R6,R0
   2587                NumBytes = MaxNumBytes;
   2588              }
   2589              GUI_MEMCPY(pBuffer, pItem->acText, NumBytes);
   \   00000044   0620A0E1           MOV      R2,R6
   \   00000048   1D1084E2           ADD      R1,R4,#+29
   \   0000004C   0500A0E1           MOV      R0,R5
   \   00000050   ........           BL       __aeabi_memcpy
   2590              *(pBuffer + NumBytes - 1) = 0;
   \   00000054   050086E0           ADD      R0,R6,R5
   \   00000058   0010A0E3           MOV      R1,#+0
   \   0000005C   011040E5           STRB     R1,[R0, #-1]
   2591              GUI_UNLOCK_H(pItem);
   \   00000060   ........           BL       GUI_ALLOC_UnlockH
   2592              WM_UNLOCK();
   \   00000064   ........           BL       GUI_Unlock
   2593            }
   2594          }
   \                     ??TREEVIEW_ITEM_GetText_0:
   \   00000068   7080BDE8           POP      {R4-R6,PC}       ;; return
   2595          
   2596          /*********************************************************************
   2597          *
   2598          *       TREEVIEW_ITEM_GetInfo
   2599          */

   \                                 In section .text, align 4, keep-with-next
   2600          void TREEVIEW_ITEM_GetInfo(TREEVIEW_ITEM_Handle hItem, TREEVIEW_ITEM_INFO * pInfo) {
   \                     TREEVIEW_ITEM_GetInfo:
   \   00000000   30402DE9           PUSH     {R4,R5,LR}
   \   00000004   0050A0E1           MOV      R5,R0
   \   00000008   04D04DE2           SUB      SP,SP,#+4
   \   0000000C   0140A0E1           MOV      R4,R1
   2601            TREEVIEW_ITEM_OBJ  * pItem;
   2602            if (hItem) {
   \   00000010   000055E3           CMP      R5,#+0
   \   00000014   1100000A           BEQ      ??TREEVIEW_ITEM_GetInfo_0
   2603              WM_LOCK();
   \   00000018   ........           BL       GUI_Lock
   2604              pItem = (TREEVIEW_ITEM_OBJ *)GUI_LOCK_H(hItem);
   \   0000001C   0500A0E1           MOV      R0,R5
   \   00000020   ........           BL       GUI_ALLOC_LockH
   2605              pInfo->IsNode       = (pItem->Flags & TREEVIEW_ITEM_TYPE_NODE)      ? 1 : 0;
   \   00000024   B811D0E1           LDRH     R1,[R0, #+24]
   2606              pInfo->IsExpanded   = (pItem->Flags & TREEVIEW_ITEM_STATE_EXPANDED) ? 1 : 0;
   \   00000028   0130A0E3           MOV      R3,#+1
   \   0000002C   012001E2           AND      R2,R1,#0x1
   \   00000030   002084E5           STR      R2,[R4, #+0]
   \   00000034   FF2001E2           AND      R2,R1,#0xFF
   \   00000038   A22003E0           AND      R2,R3,R2, LSR #+1
   2607              pInfo->HasLines     = (pItem->Flags & TREEVIEW_SF_HIDELINES)        ? 0 : 1;
   \   0000003C   011001E2           AND      R1,R1,#0x1
   \   00000040   042084E5           STR      R2,[R4, #+4]
   \   00000044   011021E2           EOR      R1,R1,#0x1
   \   00000048   081084E5           STR      R1,[R4, #+8]
   2608              pInfo->HasRowSelect = (pItem->Flags & TREEVIEW_CF_ROWSELECT)        ? 1 : 0;
   \   0000004C   0C2084E5           STR      R2,[R4, #+12]
   2609              pInfo->Level        = pItem->Level;
   \   00000050   1C00D0E5           LDRB     R0,[R0, #+28]
   \   00000054   100084E5           STR      R0,[R4, #+16]
   2610              GUI_UNLOCK_H(pItem);
   \   00000058   ........           BL       GUI_ALLOC_UnlockH
   2611              WM_UNLOCK();
   \   0000005C   ........           BL       GUI_Unlock
   2612            }
   2613          }
   \                     ??TREEVIEW_ITEM_GetInfo_0:
   \   00000060   04D08DE2           ADD      SP,SP,#+4        ;; stack cleaning
   \   00000064   3080BDE8           POP      {R4,R5,PC}       ;; return
   2614          
   2615          /*********************************************************************
   2616          *
   2617          *       TREEVIEW_ITEM_SetUserData
   2618          */

   \                                 In section .text, align 4, keep-with-next
   2619          void TREEVIEW_ITEM_SetUserData(TREEVIEW_ITEM_Handle hItem, U32 UserData) {
   \                     TREEVIEW_ITEM_SetUserData:
   \   00000000   30402DE9           PUSH     {R4,R5,LR}
   \   00000004   0040A0E1           MOV      R4,R0
   \   00000008   04D04DE2           SUB      SP,SP,#+4
   \   0000000C   0150A0E1           MOV      R5,R1
   2620            TREEVIEW_ITEM_OBJ * pItem;
   2621            if (hItem) {
   \   00000010   000054E3           CMP      R4,#+0
   \   00000014   0500000A           BEQ      ??TREEVIEW_ITEM_SetUserData_0
   2622              WM_LOCK();
   \   00000018   ........           BL       GUI_Lock
   2623              pItem = (TREEVIEW_ITEM_OBJ *)GUI_LOCK_H(hItem);
   2624              pItem->UserData = UserData;
   \   0000001C   0400A0E1           MOV      R0,R4
   \   00000020   ........           BL       GUI_ALLOC_LockH
   \   00000024   0C5080E5           STR      R5,[R0, #+12]
   2625              GUI_UNLOCK_H(pItem);
   \   00000028   ........           BL       GUI_ALLOC_UnlockH
   2626              WM_UNLOCK();
   \   0000002C   ........           BL       GUI_Unlock
   2627            }
   2628          }
   \                     ??TREEVIEW_ITEM_SetUserData_0:
   \   00000030   04D08DE2           ADD      SP,SP,#+4        ;; stack cleaning
   \   00000034   3080BDE8           POP      {R4,R5,PC}       ;; return
   2629          
   2630          /*********************************************************************
   2631          *
   2632          *       TREEVIEW_ITEM_GetUserData
   2633          */

   \                                 In section .text, align 4, keep-with-next
   2634          U32 TREEVIEW_ITEM_GetUserData(TREEVIEW_ITEM_Handle hItem) {
   \                     TREEVIEW_ITEM_GetUserData:
   \   00000000   30402DE9           PUSH     {R4,R5,LR}
   \   00000004   04D04DE2           SUB      SP,SP,#+4
   \   00000008   0040B0E1           MOVS     R4,R0
   2635            U32 UserData;
   2636            TREEVIEW_ITEM_OBJ * pItem;
   2637            UserData = 0;
   \   0000000C   0050A0E3           MOV      R5,#+0
   2638            if (hItem) {
   \   00000010   0500000A           BEQ      ??TREEVIEW_ITEM_GetUserData_0
   2639              WM_LOCK();
   \   00000014   ........           BL       GUI_Lock
   2640              pItem = (TREEVIEW_ITEM_OBJ *)GUI_LOCK_H(hItem);
   2641              UserData = pItem->UserData;
   \   00000018   0400A0E1           MOV      R0,R4
   \   0000001C   ........           BL       GUI_ALLOC_LockH
   \   00000020   0C5090E5           LDR      R5,[R0, #+12]
   2642              GUI_UNLOCK_H(pItem);
   \   00000024   ........           BL       GUI_ALLOC_UnlockH
   2643              WM_UNLOCK();
   \   00000028   ........           BL       GUI_Unlock
   2644            }
   2645            return UserData;
   \                     ??TREEVIEW_ITEM_GetUserData_0:
   \   0000002C   0500A0E1           MOV      R0,R5
   \   00000030   04D08DE2           ADD      SP,SP,#+4
   \   00000034   3080BDE8           POP      {R4,R5,PC}       ;; return
   2646          }

   \                                 In section .text, align 4, keep-with-next
   \                     ??DataTable1:
   \   00000000   ........           DC32     ??IsActive

   \                                 In section .text, align 4, keep-with-next
   \                     ??DataTable2:
   \   00000000   ........           DC32     TREEVIEW_Callback

   \                                 In section .text, align 4, keep-with-next
   \                     ??DataTable2_1:
   \   00000000   ........           DC32     TREEVIEW__DefaultProps

   \                                 In section .text, align 4, keep-with-next
   \                     ??DataTable2_2:
   \   00000000   ........           DC32     TREEVIEW_OwnerDraw

   \                                 In section .rodata, align 4, keep-with-next
   \                     `?<Constant {0L}>`:
   \   00000000                      ; Initializer data, 64 bytes
   \   00000000   00000000           DC32 0
   \   00000004   000000000000       DC8 0, 0, 0, 0, 0, 0, 0, 0, 0, 0
   \              00000000    
   \   0000000E   000000000000       DC8 0, 0, 0, 0, 0, 0, 0, 0, 0, 0
   \              00000000    
   \   00000018   000000000000       DC8 0, 0, 0, 0, 0, 0, 0, 0, 0, 0
   \              00000000    
   \   00000022   000000000000       DC8 0, 0, 0, 0, 0, 0, 0, 0, 0, 0
   \              00000000    
   \   0000002C   000000000000       DC8 0, 0, 0, 0, 0, 0, 0, 0, 0, 0
   \              00000000    
   \   00000036   000000000000       DC8 0, 0, 0, 0, 0, 0, 0, 0, 0, 0
   \              00000000    
   2647          
   2648          #else                            /* Avoid problems with empty object modules */
   2649            void TREEVIEW_C(void);
   2650            void TREEVIEW_C(void) {}
   2651          #endif /* GUI_WINSUPPORT */
   2652          
   2653          /*************************** End of file ****************************/
   2654          

   Maximum stack usage in bytes:

     Function                  .cstack
     --------                  -------
     TREEVIEW_AttachItem           56
     TREEVIEW_Callback             32
     TREEVIEW_CreateEx             56
     TREEVIEW_DecSel                8
     TREEVIEW_GetItem              32
     TREEVIEW_GetSel               16
     TREEVIEW_ITEM_Collapse        16
     TREEVIEW_ITEM_Create          24
     TREEVIEW_ITEM_Delete          24
     TREEVIEW_ITEM_Detach          40
     TREEVIEW_ITEM_Expand          16
     TREEVIEW_ITEM_GetInfo         16
     TREEVIEW_ITEM_GetText         16
     TREEVIEW_ITEM_GetUserData     16
     TREEVIEW_ITEM_SetImage        32
     TREEVIEW_ITEM_SetText         24
     TREEVIEW_ITEM_SetUserData     16
     TREEVIEW_IncSel                8
     TREEVIEW_InsertItem           40
     TREEVIEW_OwnerDraw             8
     TREEVIEW_SetAutoScrollH       24
     TREEVIEW_SetAutoScrollV       24
     TREEVIEW_SetBkColor           16
     TREEVIEW_SetFont              16
     TREEVIEW_SetHasLines          16
     TREEVIEW_SetImage             16
     TREEVIEW_SetLineColor         16
     TREEVIEW_SetSel               32
     TREEVIEW_SetSelMode           16
     TREEVIEW_SetTextColor         16
     _CalcParams                  144
     _GetItemFromPos               72
     _GetNextVisibleItem           40
     _GetNumVisItems               80
     _GetPrevVisibleNode           32
     _GetVisibility                88
     _LinkItem                     48
     _ManageAutoScroll             64
     _MoveSel                      40
     _OnKey                        32
     _OnOwnerdraw_GetYSize         24
     _OnOwnerdraw_Paint            48
     _OnPaint                     128
     _OnTouch                      40
     _UpdateScrollPos              64


   Section sizes:

     Function/Label            Bytes
     --------------            -----
     TREEVIEW__DefaultProps      76
     _CalcParams                648
     _GetNumVisItems            228
     _ManageAutoScroll          412
     IsActive                     4
     _OnPaint                   664
     _GetItemFromPos            308
     _OnTouch                   516
     _OnOwnerdraw_GetYSize      224
     _OnOwnerdraw_Paint        1328
     _GetPrevVisibleNode        160
     _GetNextVisibleItem        188
     _GetVisibility             428
     _UpdateScrollPos           276
     _OnKey                    1064
     _LinkItem                  620
     _MoveSel                   540
     TREEVIEW_Callback          460
     TREEVIEW_OwnerDraw          88
     TREEVIEW_CreateEx          164
     TREEVIEW_ITEM_Create        92
     TREEVIEW_AttachItem        504
     TREEVIEW_InsertItem        156
     TREEVIEW_SetAutoScrollH    132
     TREEVIEW_SetAutoScrollV    132
     TREEVIEW_SetHasLines       104
     TREEVIEW_GetItem           492
     TREEVIEW_GetSel             56
     TREEVIEW_SetImage           72
     TREEVIEW_SetSelMode        120
     TREEVIEW_SetBkColor         60
     TREEVIEW_SetTextColor       60
     TREEVIEW_SetLineColor       60
     TREEVIEW_SetFont           184
     TREEVIEW_IncSel              8
     TREEVIEW_DecSel              8
     TREEVIEW_SetSel            180
     TREEVIEW_ITEM_Detach       628
     TREEVIEW_ITEM_Delete       128
     TREEVIEW_ITEM_Expand       104
     TREEVIEW_ITEM_Collapse     108
     TREEVIEW_ITEM_SetImage     136
     TREEVIEW_ITEM_SetText      284
     TREEVIEW_ITEM_GetText      108
     TREEVIEW_ITEM_GetInfo      104
     TREEVIEW_ITEM_SetUserData   56
     TREEVIEW_ITEM_GetUserData   56
     ??DataTable1                 4
     ??DataTable2                 4
     ??DataTable2_1               4
     ??DataTable2_2               4
     ?<Constant {0L}>            64

 
      4 bytes in section .bss
     76 bytes in section .data
     64 bytes in section .rodata
 12 464 bytes in section .text
 
 12 464 bytes of CODE  memory
     64 bytes of CONST memory
     80 bytes of DATA  memory

Errors: none
Warnings: none
